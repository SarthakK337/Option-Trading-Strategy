"use strict";function _toArray(e){return _arrayWithHoles(e)||_iterableToArray(e)||_unsupportedIterableToArray(e)||_nonIterableRest()}function _createForOfIteratorHelper(e,t){var n,i,o,r,s="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(s)return i=!(n=!0),{s:function(){s=s.call(e)},n:function(){var e=s.next();return n=e.done,e},e:function(e){i=!0,o=e},f:function(){try{n||null==s.return||s.return()}finally{if(i)throw o}}};if(Array.isArray(e)||(s=_unsupportedIterableToArray(e))||t&&e&&"number"==typeof e.length)return s&&(e=s),r=0,{s:t=function(){},n:function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}},e:function(e){throw e},f:t};throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function _regeneratorRuntime(){_regeneratorRuntime=function(){return s};var s={},e=Object.prototype,l=e.hasOwnProperty,t="function"==typeof Symbol?Symbol:{},i=t.iterator||"@@iterator",n=t.asyncIterator||"@@asyncIterator",o=t.toStringTag||"@@toStringTag";function r(e,t,n){return Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}),e[t]}try{r({},"")}catch(e){r=function(e,t,n){return e[t]=n}}function a(e,t,n,i){var o,r,s,a,t=t&&t.prototype instanceof d?t:d,t=Object.create(t.prototype),i=new y(i||[]);return t._invoke=(o=e,r=n,s=i,a="suspendedStart",function(e,t){if("executing"===a)throw new Error("Generator is already running");if("completed"===a){if("throw"===e)throw t;return S()}for(s.method=e,s.arg=t;;){var n=s.delegate;if(n){n=function e(t,n){var i=t.iterator[n.method];if(void 0===i){if(n.delegate=null,"throw"===n.method){if(t.iterator.return&&(n.method="return",n.arg=void 0,e(t,n),"throw"===n.method))return c;n.method="throw",n.arg=new TypeError("The iterator does not provide a 'throw' method")}return c}i=u(i,t.iterator,n.arg);if("throw"===i.type)return n.method="throw",n.arg=i.arg,n.delegate=null,c;i=i.arg;return i?i.done?(n[t.resultName]=i.value,n.next=t.nextLoc,"return"!==n.method&&(n.method="next",n.arg=void 0),n.delegate=null,c):i:(n.method="throw",n.arg=new TypeError("iterator result is not an object"),n.delegate=null,c)}(n,s);if(n){if(n===c)continue;return n}}if("next"===s.method)s.sent=s._sent=s.arg;else if("throw"===s.method){if("suspendedStart"===a)throw a="completed",s.arg;s.dispatchException(s.arg)}else"return"===s.method&&s.abrupt("return",s.arg);a="executing";n=u(o,r,s);if("normal"===n.type){if(a=s.done?"completed":"suspendedYield",n.arg===c)continue;return{value:n.arg,done:s.done}}"throw"===n.type&&(a="completed",s.method="throw",s.arg=n.arg)}}),t}function u(e,t,n){try{return{type:"normal",arg:e.call(t,n)}}catch(e){return{type:"throw",arg:e}}}s.wrap=a;var c={};function d(){}function h(){}function p(){}var t={},f=(r(t,i,function(){return this}),Object.getPrototypeOf),f=f&&f(f(w([]))),m=(f&&f!==e&&l.call(f,i)&&(t=f),p.prototype=d.prototype=Object.create(t));function _(e){["next","throw","return"].forEach(function(t){r(e,t,function(e){return this._invoke(t,e)})})}function g(s,a){var t;this._invoke=function(n,i){function e(){return new a(function(e,t){!function t(e,n,i,o){var r,e=u(s[e],s,n);if("throw"!==e.type)return(n=(r=e.arg).value)&&"object"==_typeof(n)&&l.call(n,"__await")?a.resolve(n.__await).then(function(e){t("next",e,i,o)},function(e){t("throw",e,i,o)}):a.resolve(n).then(function(e){r.value=e,i(r)},function(e){return t("throw",e,i,o)});o(e.arg)}(n,i,e,t)})}return t=t?t.then(e,e):e()}}function v(e){var t={tryLoc:e[0]};1 in e&&(t.catchLoc=e[1]),2 in e&&(t.finallyLoc=e[2],t.afterLoc=e[3]),this.tryEntries.push(t)}function b(e){var t=e.completion||{};t.type="normal",delete t.arg,e.completion=t}function y(e){this.tryEntries=[{tryLoc:"root"}],e.forEach(v,this),this.reset(!0)}function w(t){if(t){var n,e=t[i];if(e)return e.call(t);if("function"==typeof t.next)return t;if(!isNaN(t.length))return n=-1,(e=function e(){for(;++n<t.length;)if(l.call(t,n))return e.value=t[n],e.done=!1,e;return e.value=void 0,e.done=!0,e}).next=e}return{next:S}}function S(){return{value:void 0,done:!0}}return r(m,"constructor",h.prototype=p),r(p,"constructor",h),h.displayName=r(p,o,"GeneratorFunction"),s.isGeneratorFunction=function(e){e="function"==typeof e&&e.constructor;return!!e&&(e===h||"GeneratorFunction"===(e.displayName||e.name))},s.mark=function(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,p):(e.__proto__=p,r(e,o,"GeneratorFunction")),e.prototype=Object.create(m),e},s.awrap=function(e){return{__await:e}},_(g.prototype),r(g.prototype,n,function(){return this}),s.AsyncIterator=g,s.async=function(e,t,n,i,o){void 0===o&&(o=Promise);var r=new g(a(e,t,n,i),o);return s.isGeneratorFunction(t)?r:r.next().then(function(e){return e.done?e.value:r.next()})},_(m),r(m,o,"Generator"),r(m,i,function(){return this}),r(m,"toString",function(){return"[object Generator]"}),s.keys=function(n){var e,i=[];for(e in n)i.push(e);return i.reverse(),function e(){for(;i.length;){var t=i.pop();if(t in n)return e.value=t,e.done=!1,e}return e.done=!0,e}},s.values=w,y.prototype={constructor:y,reset:function(e){if(this.prev=0,this.next=0,this.sent=this._sent=void 0,this.done=!1,this.delegate=null,this.method="next",this.arg=void 0,this.tryEntries.forEach(b),!e)for(var t in this)"t"===t.charAt(0)&&l.call(this,t)&&!isNaN(+t.slice(1))&&(this[t]=void 0)},stop:function(){this.done=!0;var e=this.tryEntries[0].completion;if("throw"===e.type)throw e.arg;return this.rval},dispatchException:function(n){if(this.done)throw n;var i=this;function e(e,t){return r.type="throw",r.arg=n,i.next=e,t&&(i.method="next",i.arg=void 0),!!t}for(var t=this.tryEntries.length-1;0<=t;--t){var o=this.tryEntries[t],r=o.completion;if("root"===o.tryLoc)return e("end");if(o.tryLoc<=this.prev){var s=l.call(o,"catchLoc"),a=l.call(o,"finallyLoc");if(s&&a){if(this.prev<o.catchLoc)return e(o.catchLoc,!0);if(this.prev<o.finallyLoc)return e(o.finallyLoc)}else if(s){if(this.prev<o.catchLoc)return e(o.catchLoc,!0)}else{if(!a)throw new Error("try statement without catch or finally");if(this.prev<o.finallyLoc)return e(o.finallyLoc)}}}},abrupt:function(e,t){for(var n=this.tryEntries.length-1;0<=n;--n){var i=this.tryEntries[n];if(i.tryLoc<=this.prev&&l.call(i,"finallyLoc")&&this.prev<i.finallyLoc){var o=i;break}}var r=(o=o&&("break"===e||"continue"===e)&&o.tryLoc<=t&&t<=o.finallyLoc?null:o)?o.completion:{};return r.type=e,r.arg=t,o?(this.method="next",this.next=o.finallyLoc,c):this.complete(r)},complete:function(e,t){if("throw"===e.type)throw e.arg;return"break"===e.type||"continue"===e.type?this.next=e.arg:"return"===e.type?(this.rval=this.arg=e.arg,this.method="return",this.next="end"):"normal"===e.type&&t&&(this.next=t),c},finish:function(e){for(var t=this.tryEntries.length-1;0<=t;--t){var n=this.tryEntries[t];if(n.finallyLoc===e)return this.complete(n.completion,n.afterLoc),b(n),c}},catch:function(e){for(var t=this.tryEntries.length-1;0<=t;--t){var n,i,o=this.tryEntries[t];if(o.tryLoc===e)return"throw"===(n=o.completion).type&&(i=n.arg,b(o)),i}throw new Error("illegal catch attempt")},delegateYield:function(e,t,n){return this.delegate={iterator:w(e),resultName:t,nextLoc:n},"next"===this.method&&(this.arg=void 0),c}},s}function _slicedToArray(e,t){return _arrayWithHoles(e)||_iterableToArrayLimit(e,t)||_unsupportedIterableToArray(e,t)||_nonIterableRest()}function _nonIterableRest(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function _iterableToArrayLimit(e,t){var n=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=n){var i,o,r=[],s=!0,a=!1;try{for(n=n.call(e);!(s=(i=n.next()).done)&&(r.push(i.value),!t||r.length!==t);s=!0);}catch(e){a=!0,o=e}finally{try{s||null==n.return||n.return()}finally{if(a)throw o}}return r}}function _arrayWithHoles(e){if(Array.isArray(e))return e}function _defineProperty(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function _typeof(e){return(_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function _toConsumableArray(e){return _arrayWithoutHoles(e)||_iterableToArray(e)||_unsupportedIterableToArray(e)||_nonIterableSpread()}function _nonIterableSpread(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function _unsupportedIterableToArray(e,t){var n;if(e)return"string"==typeof e?_arrayLikeToArray(e,t):"Map"===(n="Object"===(n=Object.prototype.toString.call(e).slice(8,-1))&&e.constructor?e.constructor.name:n)||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?_arrayLikeToArray(e,t):void 0}function _iterableToArray(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}function _arrayWithoutHoles(e){if(Array.isArray(e))return _arrayLikeToArray(e)}function _arrayLikeToArray(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,i=new Array(t);n<t;n++)i[n]=e[n];return i}define("underscore",[],function(){return window._}),define("jquery",[],function(){return window.$}),define("Backbone",[],function(){return window.Backbone}),define("External/sockjs-client",[],function(){return window.SockJS}),define("Highcharts",[],function(){return window.Highcharts}),requirejs.config({baseUrl:"/scripts",waitSeconds:200,paths:{Http:"app/modules/Http/Http",Server:"app/modules/Server/Server",Toolset:"app/modules/Toolset/Toolset",DataChest:"app/modules/DataChest/DataChest",EventBus:"app/modules/EventBus/EventBus",TemplateManager:"app/modules/TemplateManager/TemplateManager",ActionQueue:"app/modules/ActionQueue/ActionQueue",PopupsManager:"app/modules/PopupsManager/PopupsManager",MainSearch:"app/modules/MainSearch/MainSearch",Displayable:"app/modules/Displayable/Displayable",AlertActions:"app/modules/Alerts/AlertActions",PortfolioActions:"app/modules/Portfolios/PortfolioActions",UserActions:"app/modules/UserActions/UserActions",InstrumentChart:"app/modules/Charts/InstrumentChart",ChartPresets:"app/modules/Charts/ChartPresets",Modules:"app/modules",Inv:"app/Investing",Router:"app/Router",External:"ex-lib",Moment:"ex-lib/moment.min",Highcharts:"ex-lib/charts/highchartsCore.min",Socket:"app/modules/Socket/Socket"},shim:{backbone:{deps:["jquery","underscore"],exports:"Backbone"},underscore:{deps:[],exports:"_"}}}),define("app/require_config",function(){}),requirejs(["./app/require_config"],function(){requirejs(["app/main"])}),define("app_init",function(){}),define("Modules/Mutators/Mutator",["underscore","jquery","Backbone"],function(e,t,n){var o;return new(n.Model.extend({initialize:function(){},mutate:function(t,e,n){var i=this;o=n,e.forEach(function(e){return i._applyFunction.apply(i,[t].concat(_toConsumableArray(e)))})},_applyFunction:function(t,e,n){[].concat(e).forEach(function(e){e&&(t[e]?(window.throwError||console.error)("".concat(o," Mutation Exception"),"Function '".concat(e,"' already exists")):Object.defineProperty(t,e,{value:n}))})}}))}),define("Modules/Mutators/GeneralMutator",["jquery","underscore","./Mutator"],function(e,o,t){function n(s,a){return function(e){for(var t=arguments.length,n=new Array(1<t?t-1:0),i=1;i<t;i++)n[i-1]=arguments[i];var o=["__ Runtime ".concat(s,": ").concat(a?l[e].apply(l,n):e)].concat(a?[]:n),r=o.join(" | ");if("Error"===s){if(u)throw e.is("Required DOM element does not exist")&&console.log(n[0].substr(1)),e.is("Cache DOM (Markup Scheme) - Element Not Found")&&console.log(n[1].substr(1)),~e.indexOf("Template Manager Exception")&&console.log("".concat(n[0],"/").concat(n[1])),new Error(r);c("⌂ Client Exception ⌂"+r)}else d||(e=console).warn.apply(e,_toConsumableArray(o))}}var l={jidw7f93:function(e,t){var n=t.value,i=t.rowIndex,t=t.colName;return"Table Data parsing error, type mismatch: '".concat(n,"' mismatches '").concat(e,"' type (Col: ").concat(t,", Row: ").concat(i,")")},mkfrji2:function(e){return"GetRawValue Result: ".concat(e)}},u=!window.isProduction||"1"===localStorage.getItem("throwExceptions"),c=window.newrelic&&o.isFunction(window.newrelic.noticeError)?window.newrelic.noticeError:e.noop,d=!1,e=localStorage.getItem("skipWarningsTimer"),e=(e&&(e<Date.now()?(localStorage.removeItem("skipWarningsTimer"),console.warn("Skip warnings timer ended ".concat((Date.now()-e)/60/1e3," minutes ago"))):d=!0),[["throwError",n("Error")],["announceWarn",n("Warning")],["announceWarnCode",n("Warning",!0)]]),i=[["is",function(e,n){var i=this;return!o.isUn(o.find([].concat(e),function(e){return t=i,e=""+e,n?""+t==""+e:(""+t).toLowerCase()===(""+e).toLowerCase();var t}))}],["isnt",function(e,t){return!(""+this).is(e,t)}]],r=[["promise",function(e){return new Promise(function(t){return require(e,function(e){return t(o.array(e))})})}]];t.mutate(window,e,"Window"),t.mutate(String.prototype,i,"String.prototype"),t.mutate(Number.prototype,[["between",function(e,t){return e<=this&&this<=t||t<=this&&this<=e}]],"Number.prototype"),t.mutate(require,r,"Require"),window.throwError.silent=function(e){return c("FF4736FA",e)}}),define("Modules/Mutators/UnderscoreMutator",["underscore","jquery","Backbone","./Mutator"],function(r,o,e,t){function n(e){return e.trim().toLowerCase()}var i=[["isE",function(e){return r.isBoo(e)?!e:r.isEmpty(e)}],["halfAMinute",3e4],["oneMinute",6e4],["tenMinutes",6e5],["halfAnHour",18e5],["oneHour",36e5],["oneDay",864e5],["oneYear",31536e6],["rand",function(e){return Math.random()*e}],["percentOfTheTime",function(e){return Math.random()<e/100}],[["isntEmpty","isntE"],function(e){return!r.isE(e)}],["areE",function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return r.reduce(t,function(e,t){return e&&r.isE(t)},!0)}],["arentE",function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return r.reduce(t,function(e,t){return e&&r.isntE(t)},!0)}],["isUn",r.isUndefined],["isntUn",function(e){return!r.isUndefined(e)}],["isSt",r.isString],["isNu",r.isNumber],["isFu",r.isFunction],["isAr",r.isArray],["isBoo",r.isBoolean],["isOb",r.isObject],["isntEqual",function(e,t){return!r.isEqual(e,t)}],["isDefined",function(e){return!r.isUndefined(e)&&!r.isNull(e)}],["toBool",function(e){return!r.isUndefined(e)&&!r.isNull(e)}],["e",r.each],["ee",function(e,t,n){r.each(e,t),r.isE(e)&&n()}],["eFiltered",function(e,t,n){r.each(r.filter(e,t),n)}],["e$",function(e,n,i){r.e(e,function(e,t){n.call(i||this,o(e),t)})}],["eClean",function(e,t,n){r.e(r.clean(e),t,n)}],["reduce$",function(e,n,t){return r.reduce(e,function(e,t){return n(e,o(t))},t)}],["filter$",function(e,n){return o(r.filter(e,function(e,t){return n(o(e),t)}))}],["reduceObject",function(e,n,t){var i=t;return r.e(e,function(e,t){i=n(i,e,t)}),i}],["map$",function(e,n){return r.map(e,function(e,t){return n(o(e),t)})}],[["filterObject","keep"],r.pick],["clean",function(e,t,n){return r[r.isAr(e)?"filter":"filterObject"](e,function(e){return r.isNu(e)&&t||r.isSt(e)&&n||!!e})}],["cleanEmpty",function(e){return r.filterObject(e,r.isntE)}],["repeat",function(e,n){r.e(Array(e),function(e,t){return n(t)})}],["array",function(e){for(var t,n=arguments.length,i=new Array(1<n?n-1:0),o=1;o<n;o++)i[o-1]=arguments[o];return(t=[]).concat.apply(t,[e].concat(i))}],["allEmpty",function(e){return r.isEmpty(r.filter(e,function(e){return r.isntE(e)}))}],["tryRun",function(e){for(var t=arguments.length,n=new Array(1<t?t-1:0),i=1;i<t;i++)n[i-1]=arguments[i];return r.isFunction(e)&&e.apply(void 0,n)}],["tryRunProp",function(e,t){for(var t=e?e[t]:null,n=arguments.length,i=new Array(2<n?n-2:0),o=2;o<n;o++)i[o-2]=arguments[o];return t&&r.isFunction(t)&&t.call.apply(t,[e].concat(i))}],["runOr",function(e,t){for(var n=arguments.length,i=new Array(2<n?n-2:0),o=2;o<n;o++)i[o-2]=arguments[o];return r.isFunction(e)?e.apply(void 0,i):t}],["isArrOrObj",function(e){return r.isAr(e)||r.isObject(e)}],["roundBy",function(e,t){return e-e%t}],["bindSet",function(e,t){return e.map(function(e){return e.bind(t)})}],["toLowerCase",function(e){return r.isSt(e)?e.toLowerCase():""}],["toUpperCase",function(e){return r.isSt(e)?e.toUpperCase():""}],["join",function(e,t){return e.join(t)}],["cleanLineBrakes",function(e){return e.replace(/\n/gm,1<arguments.length&&void 0!==arguments[1]?arguments[1]:"")}],["cleanTabs",function(e){return e.replace(/\t+/g,1<arguments.length&&void 0!==arguments[1]?arguments[1]:"")}],["pluckName",function(e){return r.pluck(e,"name")}],["removeBeyondIndex",function(e,t){e.length=Math.min(e.length,t)}],["hasKeys",function(t,e){return r.isE(r.filter(e,function(e){return!r.has(t,e)}))}],["split",function(e,t,n){var i=[[],[]];return r.e(e,function(e){return i[+!t(e)].push(n?n(e):e)}),i}],["split$",function(e,t,n){var i=[o(),o()];return r.e(e,function(e){return i[+!t(o(e))].push(n?n(e):e)}),i}],["swap",function(e,t,n){var i=e[t];return e[t]=e[n],e[n]=i,e}],["relocate",function(e,t,n){return e.splice(n,0,e.splice(t,1)[0]),e}],["findFirst",function(e,t){return e[r.findIndex(e,t)]}],["injectByIndices",function(t,e,n){var i=0;return r.e(e,function(e){t.splice(e,0,n[i++])}),t}],["fhsiudy5",function(){return String.fromCharCode.apply(String,arguments)}],["getAllStrIndices",function(e,t){for(var n=[],i=0,o=!0;o;){var r=e.indexOf(t,i);-1<r?(n.push(r),i=r+1):o=!1}return n}],["extractByIndices",function(t,e){var n=[],i=0;return r.e(e,function(e){return n.push(t.splice(e-i++,1)[0])}),n}],["getByIndices",function(t,e){var n=[];return r.e(e,function(e){n.push(t.slice(+e,+e+1)[0])}),n}],["splitByIndices",function(t,e){var n=0,i=[];return e.forEach(function(e){i.push(t.substring(n,e)),n=e}),i.push(t.substring(n)),i}],["removeByPredicate",function(e,n){var i=[];return r.e(e,function(e,t){n(e)&&i.push(t)}),r.extractByIndices(e,i)}],["getIndicesByPredicate",function(e,n){var i=[];return r.e(e,function(e,t){n(e)&&i.push(t)}),i}],["deepCopy",function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return o.extend.apply(o,[!0,{}].concat(t))}],["minV",function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return r.isAr(t[0])?r.min(t[0]):r.min(t)}],["maxV",function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return r.isAr(t[0])?r.max(t[0]):r.max(t)}],["sP",function(e){e.stopPropagation()}],["pD",function(e){e&&e.preventDefault()}],["merge",function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return r.extend.apply(r,[{}].concat(t))}],["when",function(e,t,n,i){t(n,e)&&i()}],[["existsIn","isIn"],function(e,t){return r.isAr(e)?-1<r.indexOf(e,t):r.has(e,t)}],["isntIn",function(){return!r.isIn.apply(r,arguments)}],["containsText",function(e,t){return!!~n(e).indexOf(n(t))}],["valueOr",function(e,t){return r.isUn(e)?t:e}],["nonEmptyOr",function(e,t){return r.isE(e)?t:e}],["sameSize",function(e,t){return r.size(e)===r.size(t)}],["trimFromTargetString",function(e,t){return e.substring(0,e.indexOf(t))}],["sameKeys",function(e,n){var i=!0;return r.e(e,function(e,t){return i&=r.has(n,t)}),i&&r.sameSize(e,n)}],["getNumericKeys",function(e){return r.map(r.keys(e),function(e){return isNaN(+e)?throwError("Object contains non-numeric key",e):+e})}],[["sameValues","objectsAreEqual"],function(e,n,i){var o=!0;return r.e(e,function(e,t){o&&(i&&r.isObject(e)&&r.isObject(n[t])?o&=r.sameValues(e,n[t],!0):o&=n[t]===e)}),!!o&&r.sameSize(e,n)}],["objectsUnequal",function(e,t,n){return!r.objectsAreEqual(e,t,n)}],["escapeCommas",function(e){return r.isSt(e)?e.replace(",","\\,"):e}],["convertToArray",function(e){return _toConsumableArray(e)}],["isSize2",function(e){return 2===r.size(e)}],["seekInObj",function(e,t){return r.reduce(t.split("."),function(e,t){return e&&e[t]},e)}],["removeDuplicates",function(e){return _toConsumableArray(new Set(e))}],["isSetting",function(e,t){return r.isAr(e)?r.isIn(e,t):e[t]}],["isOne",function(e){return 1===e}],["isSizeOne",function(e){return 1===(e instanceof Set?e.size:r.size(e))}],["isSizeGreaterThanOne",function(e){return 1<(e instanceof Set?1<e.size:r.size(e))}],["trimFromStart",function(e,t){return e.splice(0,t)}],["trimFromEnd",function(e,t){return e.splice(e.length-t,t)}],["getReversed",function(e){return _toConsumableArray(e).reverse()}],["positive",function(e){return 0<=e}],["positiveNonZero",function(e){return 0<e}],["isNegative",function(e){return e<0}],["roundDecimal",function(e){return+e.toFixed(1<arguments.length&&void 0!==arguments[1]?arguments[1]:2)}],["capitalizeFirstChar",function(e){return e.substr(0,1).toUpperCase()+e.substr(1).toLowerCase()}],["StringAccumulator",function(){var t=[];return{concat:function(e){return t.push(e),this},get:function(){return t.join("")}}}],["copyToClipboard",function(e){var t=document.createElement("textarea"),n=o(t).css({width:"1px",height:"1px",padding:0,margin:0,border:0});document.body.appendChild(n[0]),t.value=e,t.select();try{document.execCommand("copy")}catch(e){console.log("Copy to clipboard failed",e)}n.remove()}],["openSocialPopup",function(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:"facebook",t=1<arguments.length?arguments[1]:void 0,n=2<arguments.length&&void 0!==arguments[2]?arguments[2]:"320",i=3<arguments.length&&void 0!==arguments[3]?arguments[3]:"725",t={facebook:"https://www.facebook.com/sharer/sharer.php?app_id=179222828858436&u=".concat(t,"&display=popup&ref=plugin"),twitter:"https://twitter.com/intent/tweet?text=".concat(t),whatsapp:"https://api.whatsapp.com/send?text=".concat(t),vk:"http://vk.com/share.php?url=".concat(t)};window.open(t[e],"","height=".concat(n,",width=").concat(i))}],["remapObject",function(n,e){var i={};return r.e(e,function(e,t){i[t]=n[e]}),i}],["interval",function(e,t,n){return n&&e(),setInterval(e,t)}],["findLast",function(e,t){return e[r.findLastIndex(e,t)]}],["startsWith",function(n,e){return r.isSt(e)?n.substr(0,e.length).toLowerCase()===e.toLowerCase():r.reduce(e,function(e,t){return e||r.startsWith(n,t)},!1)}],["safeString",function(e){return e}]];t.mutate(r,i,"Underscore"),r.isSet=r.isDefined}),define("Modules/Mutators/jQueryMutator",["jquery","underscore","./Mutator"],function(s,r,e){var n,t=0,o={},a=s(window),i=s(document.head),l=s(document.body),u=l.find(".js-main-header"),c=l.find(".js-grey-menu-wrapper"),d=s('<span class="only-mobile"/>'),h=/%(.+)%/,p="hide",f="mobile-hide",m="desktop-hide",_="is-marked",g="selected",v="marked",b="checked",y="pressed",w="open",S="last-child",T="www"===(T=(/^(m\.)?(\w+)\.investing\.com$/.exec(window.location.host)||[,,"www"])[2])?"com":T,C=window.navigator.platform&&/iPad|iPhone|iPod/.test(window.navigator.platform),k=[["noOp",r.noop],["f",s.fn.find],["aCl",s.fn.addClass],["rCl",s.fn.removeClass],["tCl",s.fn.toggleClass],["hCl",s.fn.hasClass],["rAttr",function(e){var t=this;return r.isAr(e)?(r.e(e,function(e){return t.removeAttr(e)}),this):this.removeAttr(e)}],["rClasses",function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return this.rCl(t.join(" "))}],["addRemoveClass",function(e,t){return this.rCl(t).aCl(e)}],["clearStyle",function(){return this.attr("style","")}],["clearClasses",function(){return this.attr("class","")}],["rClSelector",function(e){return this.rCl(e.substr(1))}],["exists",function(){return!!this[0]}],["contains",function(e){return this.f(e).exists()}],["textT",function(e){return r.isSt(e)?this.text(e.trim()):r.isNu(e)?this.text(e):this.text().trim()}],["visibleTextT",function(){return this.f(":hidden").aCl("marked-as-hidden"),this.clone().children().remove(".marked-as-hidden").end().textT()}],["printableValue",function(){return""+(this.f("[data-print-value]").data("print-value")||"")}],["fOne",function(e){return this.f("".concat(e,":first"))}],["thTitle",function(){return this.f("span:first").textT()}],["replaceDefine",function(e){var t=this.text().match(h);t&&this.text(t.input.replace(t[0],e))}],["valT",function(e){return r.isntUn(e)?this.val((""+e).trim()):this.val().trim()}],["numVal",function(){return+this.val()}],["isValue",function(e){return this.val()===e}],["textOptional",function(e){return e&&this.textT(e),this}],["mark",function(e){return this.toggleClass(v,r.valueOr(e,!0))}],["unmark",function(){return this.removeClass(v)}],["toggleMark",function(){return this.toggleClass(v)}],["isMarked",function(){return this.hasClass(v)}],["press",function(e){return this.toggleClass(y,r.valueOr(e,!0))}],["unpress",function(){return this.removeClass(y)}],["togglePress",function(){return this.toggleClass(y)}],["isPressed",function(){return this.hasClass(y)}],["check",function(e){return this.prop(b,r.valueOr(e,!0))}],["isChecked",function(){return this.prop(b)}],["areChecked",function(){return r.reduce$(this,function(e,t){return e&&t.isChecked()},!0)}],["uncheck",function(){return this.rAttr(b).prop(b,!1)}],["toggleCheck",function(e){return this.prop(b,!!e)}],["getChecked",function(){return this.filter(":checked")}],["getUnchecked",function(){return this.filter(":not(:checked)")}],["aOpen",function(){return this.aCl(w)}],["rOpen",function(){return this.rCl(w)}],[["tOpen","toggleOpen"],function(){return this.tCl(w)}],[["tIsOpen","toggleIsOpen"],function(){return this.tCl("is-open")}],["isOpen",function(){return this.hCl(w)}],["setLastChild",function(){return this.aCl(S)}],["unsetLastChild",function(){return this.rCl(S)}],["highlight",function(e){return this.blinkClass("u-highlight",e||3e3)}],["clean",function(){return this.text("")}],["disable",function(e){return this.prop("disabled",r.valueOr(e,!0))[r.isUn(e)||e?"addClass":"removeClass"]("disabled")}],["enable",function(){return this.prop("disabled",!1).removeClass("disabled")}],["href",function(e){return this.exists()&&this.isLink()?r.isntUn(e)?this.attr("href",e):this.attr("href"):this}],["title",function(e){return r.isntUn(e)?this.attr("title",e):this.attr("title")}],["seek",function(e,t){var n=this.filter(e);return n.exists()?n:this[t?"f":"mF"](e)}],["opacity1",function(){return this.css("opacity",1)}],["getButton",function(){return this.mF("button")}],["getInput",function(){return this.mF("input")}],["removeAddClass",function(e,t){return this.removeClass(e).addClass(t)}],["kickOffView",function(){return this.css({position:"absolute",top:"-9999999px"})}],["cloneToNewTag",function(e,t){var n=this,i=s("<".concat(e,"/>"));return r.e(this[0].attributes,function(e){return i.attr(e.name,n.attr(e.name))}),e.is("button")&&(i.attr("type","button"),i.removeAttr("href")),t&&i.html(this.html()),i}],["changeTagType",function(e,t){e=this.cloneToNewTag(e,t);return this.after(e).remove(),e}],["isActive",function(){return this[0]===document.activeElement}],["buildAndPopulate",function(e,t,n){var i=this,e=r.map(e,t);return n?r.e(e,function(e){return i.append(e)}):this.html(e),this}],["onEnter",function(t,n,e){return this.on("keypress.".concat(e),function(e){13===e.keyCode&&(t(e),n&&e.stopPropagation())})}],["onEsc",function(t,n){return this.on("keydown.".concat(2<arguments.length&&void 0!==arguments[2]?arguments[2]:"def"),function(e){27===e.keyCode&&(t(e),n&&e.stopPropagation())})}],["onKeyUp",function(e){for(var t=arguments.length,n=new Array(1<t?t-1:0),i=1;i<t;i++)n[i-1]=arguments[i];return this.on("keyup",function(){return e.apply(void 0,n)})}],["isEmpty",function(){return!this[0]}],["isVisible",function(){return!this.hasClass(p)&&this.is(":visible")}],[["_show","showEl"],function(){return this.removeClass(p)}],["showElMobile",function(){return this.removeClass(f)}],["showElDesktop",function(){return this.removeClass(m)}],[["_hide","hideEl"],function(){return this.addClass(p)}],["hideElMobile",function(){return this.addClass(f)}],["hideElDesktop",function(){return this.addClass(m)}],["number",function(){return+this.textT()}],[["_toggleShow","toggleEl"],function(e){return arguments.length?this[e?"_show":"_hide"]():this.toggleClass(p)}],["toggleVis",function(e){return arguments.length?this.css("visibility",e?"inherit":"hidden"):this.css("visibility",this.css("visibility").is("hidden")?"inherit":"hidden")}],["toggleCursorVisibility",function(e){return arguments.length?this.css("cursor",e?"default":"none"):this.css("visibility",this.css("cursor").is("none")?"default":"none")}],["selectText",function(){var e=window.getSelection(),t=document.createRange();t.selectNodeContents(this[0]),e.removeAllRanges(),e.addRange(t)}],["setSelected",function(){return this.addClass(g)}],["unselect",function(){return this.removeClass(g)}],["isSelected",function(){return this.hasClass(g)}],["getSelected",function(e){return this[e?"mustFilter":"filter"]("."+g)}],["toggleSelected",function(e){return this.toggleClass(g,!!e)}],["findSelected",function(){return this.f("."+g)}],["hasSelected",function(){return this.findSelected().exists()}],["filterWithSelected",function(){return r.filter$(this,function(e){return e.hasSelected()})}],["isParentOf",function(e){return s(e).isChildOf(this)}],["addToThis",function(e){return this.push.apply(this,_toConsumableArray(e)),this}],["removeFromThis",function(e){return s(this.splice(r.indexOf(this,e[0]),1))}],["hasAttr",function(e){return r.isntUn(this.attr(e))}],["hasData",function(e){return r.isntUn(this.data(e))}],[["rData"],function(e){return this.data(e,null),this.removeAttr("data-".concat(e))}],["isChildOf",function(e){e=r.isSt(e)?!!this.parents(e).length:s.contains(e[0],this[0]);return e}],["isOrChildOf",function(e){return this.isChildOf(e)||this.is(e)}],["toggleReadOnly",function(e){var t="is-readonly";return this[r.isUn(e)?this.hasClass(t)?"rCl":"aCl":e?"aCl":"rCl"](t)}],["isInView",function(e,t,n,i){var o=n?n.offset().top:a.scrollTop(),n=n?o+n.height():o+a.height(),r=this.offset().top,s=r+this.height(),e=e?r+(t||0)<n&&(!i||o<s):s<=n&&o<=r;return e}],["isWithinBoundsOf",function(e){var t=1<arguments.length&&void 0!==arguments[1]&&arguments[1],n=this.offset().left,i=e.offset().left;return i<n&&n+this.outerWidth(t)<i+e.outerWidth(t)}],["mostlyVisible",function(){var e=a.scrollTop(),t=a.height(),n=this.offset().top,i=this.height();return e<n+i-.25*i&&n<e+.5*t}],["onUnpropagatedEvent",function(e,t){var n=this;this.on(e,function(e){n[0]===e.target&&t(e)})}],["onTimeoutBlur",function(t){var n=1<arguments.length&&void 0!==arguments[1]?arguments[1]:256;return this.on("blur",function(e){return setTimeout(function(){return t(e)},n)})}],["initNavSelect",function(){var t=this;this.on("input",function(e){e=e.currentTarget;return t.outerNavigate(s(e).val())})}],["indexOf",function(n){var i=-1;return r.e$(this,function(e,t){return n(e)&&(i=t)}),i}],["isLocalNavigationLink",function(){return this.is("a[href]:not([data-outbound])")}],["isOrInALocalNavigationLink",function(){var e=!1,t=this;return r.repeat(3,function(){t.isLocalNavigationLink()?e=!0:t=t.parent()}),e}],["swapWith",function(e){s.swapElements(this,e)}],[["setup"],function(e){var n=this;return r.e(e,function(e,t){return n[t].apply(n,_toConsumableArray(r.array(e)))}),this}],["widthSum",function(){return Math.floor(r.reduce$(this,function(e,t){return e+t.totalWidth()},0))}],["totalWidth",function(){return this.outerWidth(!0)}],[["whileMousePressed"],function(t,n){function e(){return clearInterval(i)}var i;return this.on("mousedown",function(e){1===e.which&&(i=setInterval(t,n))}),this.on("mouseup",e),{stop:e}}],[["required","needed"],function(){if(!this.isEmpty())return this;throwError("Required DOM element does not exist")}],[["mustFind","mF"],function(e){var t=this.find(e);if(!t.isEmpty())return t;throwError("Required DOM element does not exist",e)}],[["mustFilter","mFilter"],function(e){var t=this.filter(e);if(!t.isEmpty())return t;throwError("Required filtered DOM element does not exist",e)}],[["tryFind","tF"],function(e){var t=this.find(e);return t.isEmpty()&&announceWarn("Searched DOM element does not exist",e),t}],[["blinkClass","addClassForTime"],function(e,t){var n=this;return this.aCl(e),setTimeout(function(){return n.rCl(e)},t),this}],["offsetFromVPTop",function(){var e=0;return u.hCl("is-scrolled")&&(e=u.height()),this.offset().top-a.scrollTop()-e}],["offsetTop",function(){return this[0].offsetTop}],["offsetLeft",function(){return this[0].offsetLeft}],["scrollTo",function(e){return this[0].scrollTop=+e}],["scrollToHorizontal",function(e){return this[0].scrollLeft=+e}],["scrollToTop",function(){return this.scrollTop(0)}],["scrollToBottom",function(){return this.scrollTop(this[0].scrollHeight)}],["scrollElementIntoView",function(e,t){var n,i,o;this.exists()&&e.exists()&&(n=t?e.offsetLeft():e.offsetTop(),e=t?e.outerWidth():e.outerHeight(),i=t?this.width():this.height(),(o=t?this.scrollLeft():this.scrollTop())+i<n+e?this[t?"scrollToHorizontal":"scrollTo"](n-i+e+1):n<o&&this[t?"scrollToHorizontal":"scrollTo"](n))}],[["inputMask"],function(e){var t=this;this.attr("type").isnt(["text","search"])&&throwError("Input Mask binding on non-input element",this),this.on("keyup change",function(){!t.val()||e.exec(t.val())?t.removeAttr("invalid"):t.attr("invalid","")})}],[["boldify"],function(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:"",t=1<arguments.length&&void 0!==arguments[1]?arguments[1]:"bold",n=2<arguments.length&&void 0!==arguments[2]?arguments[2]:0;return e?r.containsText(this.text(),e)&&e.length>n&&(n=this.html(),e=new RegExp("(".concat(e,")"),"gi"),this.html(n.replace(e,'<span class="'.concat(t,'">$1</span>')))):this.wrapInner('<span class="'.concat(t,'">')),this}],[["removeFlagClass"],function(){return this.rCl(this.attr("class").split(" ").filter(function(e){return e.match(/^flag-/)}).join(" "))}],[["removeFromSet"],function(n){var i=this;return r.find(n,function(e,t){if(i[0]===e)return n.splice(t,1)}),this}],[["injectIntoSet"],function(e,t){var n,i,o;this.removeFromSet(e),(r.isFu(t)||r.isUn(t))&&(n=e,o=(i=t||function(e){return e.textT().toLowerCase()})(this),t=r.findIndex(n,function(e){return!~o.localeCompare(i(s(e)))})),~t?t?e.eq(t-1).after(this):e.eq(0).before(this):e.last().after(this),e.splice(t,0,this[0])}],[["setCaretToEditablecontentEnd"],function(e){var t=this[0].childNodes.length,n=document.createRange();n.selectNodeContents(this[0]),n.collapse(!1),n.setEnd(this[0],e?t-1:t),(e=window.getSelection()).removeAllRanges(),e.addRange(n)}],["setCaretAfterNode",function(){var e=document.createRange(),t=(e.setStartAfter(this[0]),e.collapse(!0),window.getSelection());t.removeAllRanges(),t.addRange(e)}],[["collectValues"],function(){return r.reduce(this,function(e,t){return e.push(s(t).val()),e},[])}],[["tabIndex"],function(e){return this.attr("tabindex",e)}],[["isInDOM"],function(){return s.contains(document.documentElement,this.get(0))}],[["isLink"],function(){return"A"===this[0].nodeName}],[["onUndraggedClick"],function(t){var n,i,o,r;return this.on("mousedown",function(e){n=[e.clientX,e.clientY],r+500>Date.now()||s(e.target).isLink()||1!==e.which?(i=!0,clearTimeout(o)):i=!1}).on("mouseup",function(e){!i&&n&&e.clientX===n[0]&&e.clientY===n[1]?(r=Date.now(),o=setTimeout(t,500)):i=!1}),function(){return i=!0}}],["applyKeyboardNavigation",function(e){function t(e){var t=n.f(">li:visible");t.eq(i).rCl(_),n.mF("scrollller").scrollElementIntoView(t.eq(e).aCl(_)),i=e}var n=this,i=0;t(0)}]],C=[["dispatchGTM",function(e){var i,t;n=n||lcl.makeCustom("GTM"),i=e,t=["instrument_name","instrument_type"],r.e(t,function(n){r.isAr(i[n])&&(r.e(i[n],function(e,t){return i[n][t]=r.capitalizeFirstChar(e)}),i[n]=i[n].join("||"))}),delete(e=r.mapObject(e,function(e,t){return r.isNull(e)?"NA":"instrument_type"===t&&"NA"!==e?r.capitalizeFirstChar(e):e})).clientUpdatesFields,n(e),window.dataLayerGTMParams&&window.dataLayerGTMParams.push(e)}],["elementAcc",function(n){return function(e,t){t=n?n(t):t;return e?e.add(t):t}}],["swapElements",function(e,t){var n=s("<span/>");e.after(n),t.after(e),n.after(t).remove()}],["is$elem",function(e){return e instanceof s}],["injectCSS",function(e){i.append(s("<style>").html(e))}],["later",function(e,t){for(var n=arguments.length,i=new Array(2<n?n-2:0),o=2;o<n;o++)i[o-2]=arguments[o];s(function(){return setTimeout.apply(void 0,[e,t].concat(i))})}],["blur",function(){s(document.activeElement).blur()}],["isMobile",function(){return d.isVisible()}],["isntMobile",function(){return!s.isMobile()}],["isIOs",C],["edition",T],["bodyOverflow",function(e){return t+=e?1:-1,l.tCl("mask-no-scroll",!!t)}],["initDFPSlot",function(e,t,n){var i=window.googletag;e?o[t]?i.pubads().refresh([o[t]]):(i.cmd.push(function(){o[t]=i.defineSlot(e,n,t).addService(i.pubads()),i.enableServices()}),i.cmd.push(function(){i.display(t)})):window.announceWarn("Missing DFP Slot",t)}],["getPageBreakpoint",function(){var n,i=s("<span>"),o=["from-break5","from-break4","from-break3","from-break2"];return l.append(i),r.e(o,function(e,t){!n&&i.rCl(o.join(" ")).aCl(e).isVisible()&&(n=t+1)}),i.remove(),n||o.length+1}],["toggleMobileNoScroll",function(){return l.tCl("is-no-scroll-mobile",!(0<arguments.length&&void 0!==arguments[0])||arguments[0])}],["getWatermark",function(){return"http://i-invdn-com.investing.com/redesign/images/InvestingWatermark.png"}],["getLoginURL",function(){return'/members-admin/login?return_to=%7B"path"%3A"'.concat(window.location.pathname.split("/").join("%5C%2F"),'"%7D')}],["scrollToElement",function(e){var t=!(1<arguments.length&&void 0!==arguments[1])||arguments[1],n=a.scrollTop()>e.offset().top?c.height():0;return a.scrollTop(e.offset().top-(+t&&u.height()+n))}]];T=window.innerHeight,document.documentElement.style.setProperty("--full-height","".concat(T,"px")),window.addEventListener("resize",r.debounce(function(){var e=window.innerHeight;document.documentElement.style.setProperty("--full-height","".concat(e,"px"))},200)),e.mutate(s,C,"$"),e.mutate(s.fn,k,"$.fn"),l.append(d)}),define("Modules/Toolset/Tools/math",["underscore","jquery","Backbone"],function(e,t,n){return n.Model.extend({initialize:function(){},rand:function(e,t){var n=Math.random(),t=e&&t?parseInt((t-e)*n)+e:e?parseInt(e*n):n;return t}})}),function(e){"object"==("undefined"==typeof exports?"undefined":_typeof(exports))&&"undefined"!=typeof module?module.exports=e():"function"==typeof define&&define.amd?define("Moment",e):(void 0).moment=e()}(function(){var L;function p(){return L.apply(null,arguments)}function l(e){return e instanceof Array||"[object Array]"===Object.prototype.toString.call(e)}function B(e){return null!=e&&"[object Object]"===Object.prototype.toString.call(e)}function r(e){return void 0===e}function N(e){return"number"==typeof e||"[object Number]"===Object.prototype.toString.call(e)}function R(e){return e instanceof Date||"[object Date]"===Object.prototype.toString.call(e)}function V(e,t){for(var n=[],i=0;i<e.length;++i)n.push(t(e[i],i));return n}function f(e,t){return Object.prototype.hasOwnProperty.call(e,t)}function a(e,t){for(var n in t)f(t,n)&&(e[n]=t[n]);return f(t,"toString")&&(e.toString=t.toString),f(t,"valueOf")&&(e.valueOf=t.valueOf),e}function u(e,t,n,i){return Pt(e,t,n,i,!0).utc()}function m(e){return null==e._pf&&(e._pf={empty:!1,unusedTokens:[],unusedInput:[],overflow:-2,charsLeftOver:0,nullInput:!1,invalidMonth:null,invalidFormat:!1,userInvalidated:!1,iso:!1,parsedDateParts:[],meridiem:null,rfc2822:!1,weekdayMismatch:!1}),e._pf}function $(e){if(null==e._isValid){var t=m(e),n=U.call(t.parsedDateParts,function(e){return null!=e}),n=!isNaN(e._d.getTime())&&t.overflow<0&&!t.empty&&!t.invalidMonth&&!t.invalidWeekday&&!t.weekdayMismatch&&!t.nullInput&&!t.invalidFormat&&!t.userInvalidated&&(!t.meridiem||t.meridiem&&n);if(e._strict&&(n=n&&0===t.charsLeftOver&&0===t.unusedTokens.length&&void 0===t.bigHour),null!=Object.isFrozen&&Object.isFrozen(e))return n;e._isValid=n}return e._isValid}function z(e){var t=u(NaN);return null!=e?a(m(t),e):m(t).userInvalidated=!0,t}var U=Array.prototype.some||function(e){for(var t=Object(this),n=t.length>>>0,i=0;i<n;i++)if(i in t&&e.call(this,t[i],i,t))return!0;return!1},W=p.momentProperties=[];function G(e,t){var n,i,o;if(r(t._isAMomentObject)||(e._isAMomentObject=t._isAMomentObject),r(t._i)||(e._i=t._i),r(t._f)||(e._f=t._f),r(t._l)||(e._l=t._l),r(t._strict)||(e._strict=t._strict),r(t._tzm)||(e._tzm=t._tzm),r(t._isUTC)||(e._isUTC=t._isUTC),r(t._offset)||(e._offset=t._offset),r(t._pf)||(e._pf=m(t)),r(t._locale)||(e._locale=t._locale),0<W.length)for(n=0;n<W.length;n++)r(o=t[i=W[n]])||(e[i]=o);return e}var Y=!1;function H(e){G(this,e),this._d=new Date(null!=e._d?e._d.getTime():NaN),this.isValid()||(this._d=new Date(NaN)),!1===Y&&(Y=!0,p.updateOffset(this),Y=!1)}function s(e){return e instanceof H||null!=e&&null!=e._isAMomentObject}function c(e){return e<0?Math.ceil(e)||0:Math.floor(e)}function d(e){var e=+e,t=0;return t=0!=e&&isFinite(e)?c(e):t}function q(e,t,n){for(var i=Math.min(e.length,t.length),o=Math.abs(e.length-t.length),r=0,s=0;s<i;s++)(n&&e[s]!==t[s]||!n&&d(e[s])!==d(t[s]))&&r++;return r+o}function Q(e){!1===p.suppressDeprecationWarnings&&"undefined"!=typeof console&&console.warn&&console.warn("Deprecation warning: "+e)}function e(o,r){var s=!0;return a(function(){if(null!=p.deprecationHandler&&p.deprecationHandler(null,o),s){for(var e,t=[],n=0;n<arguments.length;n++){if(e="","object"==_typeof(arguments[n])){for(var i in e+="\n["+n+"] ",arguments[0])e+=i+": "+arguments[0][i]+", ";e=e.slice(0,-2)}else e=arguments[n];t.push(e)}Q(o+"\nArguments: "+Array.prototype.slice.call(t).join("")+"\n"+(new Error).stack),s=!1}return r.apply(this,arguments)},r)}var X={};function K(e,t){null!=p.deprecationHandler&&p.deprecationHandler(e,t),X[e]||(Q(t),X[e]=!0)}function h(e){return e instanceof Function||"[object Function]"===Object.prototype.toString.call(e)}function Z(e,t){var n,i=a({},e);for(n in t)f(t,n)&&(B(e[n])&&B(t[n])?(i[n]={},a(i[n],e[n]),a(i[n],t[n])):null!=t[n]?i[n]=t[n]:delete i[n]);for(n in e)f(e,n)&&!f(t,n)&&B(e[n])&&(i[n]=a({},i[n]));return i}function J(e){null!=e&&this.set(e)}p.suppressDeprecationWarnings=!1,p.deprecationHandler=null;var ee=Object.keys||function(e){var t,n=[];for(t in e)f(e,t)&&n.push(t);return n},te={};function t(e,t){var n=e.toLowerCase();te[n]=te[n+"s"]=te[t]=e}function _(e){return"string"==typeof e?te[e]||te[e.toLowerCase()]:void 0}function ne(e){var t,n,i={};for(n in e)f(e,n)&&(t=_(n))&&(i[t]=e[n]);return i}var ie={};function n(e,t){ie[e]=t}function g(e,t,n){var i=""+Math.abs(e);return(0<=e?n?"+":"":"-")+Math.pow(10,Math.max(0,t-i.length)).toString().substr(1)+i}var oe=/(\[[^\[]*\])|(\\)?([Hh]mm(ss)?|Mo|MM?M?M?|Do|DDDo|DD?D?D?|ddd?d?|do?|w[o|w]?|W[o|W]?|Qo?|YYYYYY|YYYYY|YYYY|YY|gg(ggg?)?|GG(GGG?)?|e|E|a|A|hh?|HH?|kk?|mm?|ss?|S{1,9}|x|X|zz?|ZZ?|.)/g,re=/(\[[^\[]*\])|(\\)?(LTS|LT|LL?L?L?|l{1,4})/g,se={},ae={};function i(e,t,n,i){var o="string"==typeof i?function(){return this[i]()}:i;e&&(ae[e]=o),t&&(ae[t[0]]=function(){return g(o.apply(this,arguments),t[1],t[2])}),n&&(ae[n]=function(){return this.localeData().ordinal(o.apply(this,arguments),e)})}function le(e,t){return e.isValid()?(t=ue(t,e.localeData()),se[t]=se[t]||function(i){for(var e,o=i.match(oe),t=0,r=o.length;t<r;t++)ae[o[t]]?o[t]=ae[o[t]]:o[t]=(e=o[t]).match(/\[[\s\S]/)?e.replace(/^\[|\]$/g,""):e.replace(/\\/g,"");return function(e){for(var t="",n=0;n<r;n++)t+=h(o[n])?o[n].call(e,i):o[n];return t}}(t),se[t](e)):e.localeData().invalidDate()}function ue(e,t){var n=5;function i(e){return t.longDateFormat(e)||e}for(re.lastIndex=0;0<=n&&re.test(e);)e=e.replace(re,i),re.lastIndex=0,--n;return e}var o=/\d/,v=/\d\d/,ce=/\d{3}/,de=/\d{4}/,he=/[+-]?\d{6}/,b=/\d\d?/,pe=/\d\d\d\d?/,fe=/\d\d\d\d\d\d?/,me=/\d{1,3}/,_e=/\d{1,4}/,ge=/[+-]?\d{1,6}/,ve=/\d+/,be=/[+-]?\d+/,ye=/Z|[+-]\d\d:?\d\d/gi,we=/Z|[+-]\d\d(?::?\d\d)?/gi,y=/[0-9]{0,256}['a-z\u00A0-\u05FF\u0700-\uD7FF\uF900-\uFDCF\uFDF0-\uFF07\uFF10-\uFFEF]{1,256}|[\u0600-\u06FF\/]{1,256}(\s*?[\u0600-\u06FF]{1,256}){1,2}/i,Se={};function w(e,n,i){Se[e]=h(n)?n:function(e,t){return e&&i?i:n}}function Te(e){return e.replace(/[-\/\\^$*+?.()|[\]{}]/g,"\\$&")}var Ce={};function S(e,n){var t,i=n;for("string"==typeof e&&(e=[e]),N(n)&&(i=function(e,t){t[n]=d(e)}),t=0;t<e.length;t++)Ce[e[t]]=i}function ke(e,o){S(e,function(e,t,n,i){n._w=n._w||{},o(e,n._w,n,i)})}var T=0,C=1,k=2,x=3,M=4,P=5,xe=6,Me=7,Pe=8;function Ae(e){return Ee(e)?366:365}function Ee(e){return e%4==0&&e%100!=0||e%400==0}i("Y",0,0,function(){var e=this.year();return e<=9999?""+e:"+"+e}),i(0,["YY",2],0,function(){return this.year()%100}),i(0,["YYYY",4],0,"year"),i(0,["YYYYY",5],0,"year"),i(0,["YYYYYY",6,!0],0,"year"),t("year","y"),n("year",1),w("Y",be),w("YY",b,v),w("YYYY",_e,de),w("YYYYY",ge,he),w("YYYYYY",ge,he),S(["YYYYY","YYYYYY"],T),S("YYYY",function(e,t){t[T]=2===e.length?p.parseTwoDigitYear(e):d(e)}),S("YY",function(e,t){t[T]=p.parseTwoDigitYear(e)}),S("Y",function(e,t){t[T]=parseInt(e,10)}),p.parseTwoDigitYear=function(e){return d(e)+(68<d(e)?1900:2e3)};var A,De=Ie("FullYear",!0);function Ie(t,n){return function(e){return null!=e?(Fe(this,t,e),p.updateOffset(this,n),this):je(this,t)}}function je(e,t){return e.isValid()?e._d["get"+(e._isUTC?"UTC":"")+t]():NaN}function Fe(e,t,n){e.isValid()&&!isNaN(n)&&("FullYear"===t&&Ee(e.year())&&1===e.month()&&29===e.date()?e._d["set"+(e._isUTC?"UTC":"")+t](n,e.month(),Oe(n,e.month())):e._d["set"+(e._isUTC?"UTC":"")+t](n))}function Oe(e,t){return isNaN(e)||isNaN(t)?NaN:(e+=(t-(t=(t%12+12)%12))/12,1==t?Ee(e)?29:28:31-t%7%2)}A=Array.prototype.indexOf||function(e){for(var t=0;t<this.length;++t)if(this[t]===e)return t;return-1},i("M",["MM",2],"Mo",function(){return this.month()+1}),i("MMM",0,0,function(e){return this.localeData().monthsShort(this,e)}),i("MMMM",0,0,function(e){return this.localeData().months(this,e)}),t("month","M"),n("month",8),w("M",b),w("MM",b,v),w("MMM",function(e,t){return t.monthsShortRegex(e)}),w("MMMM",function(e,t){return t.monthsRegex(e)}),S(["M","MM"],function(e,t){t[C]=d(e)-1}),S(["MMM","MMMM"],function(e,t,n,i){i=n._locale.monthsParse(e,i,n._strict);null!=i?t[C]=i:m(n).invalidMonth=e});var Le=/D[oD]?(\[[^\[\]]*\]|\s)+MMMM?/,Be="January_February_March_April_May_June_July_August_September_October_November_December".split("_"),Ne="Jan_Feb_Mar_Apr_May_Jun_Jul_Aug_Sep_Oct_Nov_Dec".split("_");function Re(e,t){var n;if(e.isValid()){if("string"==typeof t)if(/^\d+$/.test(t))t=d(t);else if(!N(t=e.localeData().monthsParse(t)))return;n=Math.min(e.date(),Oe(e.year(),t)),e._d["set"+(e._isUTC?"UTC":"")+"Month"](t,n)}}function Ve(e){return null!=e?(Re(this,e),p.updateOffset(this,!0),this):je(this,"Month")}var $e=y,ze=y;function Ue(){function e(e,t){return t.length-e.length}for(var t,n=[],i=[],o=[],r=0;r<12;r++)t=u([2e3,r]),n.push(this.monthsShort(t,"")),i.push(this.months(t,"")),o.push(this.months(t,"")),o.push(this.monthsShort(t,""));for(n.sort(e),i.sort(e),o.sort(e),r=0;r<12;r++)n[r]=Te(n[r]),i[r]=Te(i[r]);for(r=0;r<24;r++)o[r]=Te(o[r]);this._monthsRegex=new RegExp("^("+o.join("|")+")","i"),this._monthsShortRegex=this._monthsRegex,this._monthsStrictRegex=new RegExp("^("+i.join("|")+")","i"),this._monthsShortStrictRegex=new RegExp("^("+n.join("|")+")","i")}function We(e){var t=new Date(Date.UTC.apply(null,arguments));return e<100&&0<=e&&isFinite(t.getUTCFullYear())&&t.setUTCFullYear(e),t}function Ge(e,t,n){n=7+t-n;return-(7+We(e,0,n).getUTCDay()-t)%7+n-1}function Ye(e,t,n,i,o){var r,t=1+7*(t-1)+(7+n-i)%7+Ge(e,i,o),n=t<=0?Ae(r=e-1)+t:t>Ae(e)?(r=e+1,t-Ae(e)):(r=e,t);return{year:r,dayOfYear:n}}function He(e,t,n){var i,o,r=Ge(e.year(),t,n),r=Math.floor((e.dayOfYear()-r-1)/7)+1;return r<1?i=r+qe(o=e.year()-1,t,n):r>qe(e.year(),t,n)?(i=r-qe(e.year(),t,n),o=e.year()+1):(o=e.year(),i=r),{week:i,year:o}}function qe(e,t,n){var i=Ge(e,t,n),t=Ge(e+1,t,n);return(Ae(e)-i+t)/7}i("w",["ww",2],"wo","week"),i("W",["WW",2],"Wo","isoWeek"),t("week","w"),t("isoWeek","W"),n("week",5),n("isoWeek",5),w("w",b),w("ww",b,v),w("W",b),w("WW",b,v),ke(["w","ww","W","WW"],function(e,t,n,i){t[i.substr(0,1)]=d(e)}),i("d",0,"do","day"),i("dd",0,0,function(e){return this.localeData().weekdaysMin(this,e)}),i("ddd",0,0,function(e){return this.localeData().weekdaysShort(this,e)}),i("dddd",0,0,function(e){return this.localeData().weekdays(this,e)}),i("e",0,0,"weekday"),i("E",0,0,"isoWeekday"),t("day","d"),t("weekday","e"),t("isoWeekday","E"),n("day",11),n("weekday",11),n("isoWeekday",11),w("d",b),w("e",b),w("E",b),w("dd",function(e,t){return t.weekdaysMinRegex(e)}),w("ddd",function(e,t){return t.weekdaysShortRegex(e)}),w("dddd",function(e,t){return t.weekdaysRegex(e)}),ke(["dd","ddd","dddd"],function(e,t,n,i){i=n._locale.weekdaysParse(e,i,n._strict);null!=i?t.d=i:m(n).invalidWeekday=e}),ke(["d","e","E"],function(e,t,n,i){t[i]=d(e)});var Qe="Sunday_Monday_Tuesday_Wednesday_Thursday_Friday_Saturday".split("_"),Xe="Sun_Mon_Tue_Wed_Thu_Fri_Sat".split("_"),Ke="Su_Mo_Tu_We_Th_Fr_Sa".split("_"),Ze=y,Je=y,et=y;function tt(){function e(e,t){return t.length-e.length}for(var t,n,i,o=[],r=[],s=[],a=[],l=0;l<7;l++)i=u([2e3,1]).day(l),t=this.weekdaysMin(i,""),n=this.weekdaysShort(i,""),i=this.weekdays(i,""),o.push(t),r.push(n),s.push(i),a.push(t),a.push(n),a.push(i);for(o.sort(e),r.sort(e),s.sort(e),a.sort(e),l=0;l<7;l++)r[l]=Te(r[l]),s[l]=Te(s[l]),a[l]=Te(a[l]);this._weekdaysRegex=new RegExp("^("+a.join("|")+")","i"),this._weekdaysShortRegex=this._weekdaysRegex,this._weekdaysMinRegex=this._weekdaysRegex,this._weekdaysStrictRegex=new RegExp("^("+s.join("|")+")","i"),this._weekdaysShortStrictRegex=new RegExp("^("+r.join("|")+")","i"),this._weekdaysMinStrictRegex=new RegExp("^("+o.join("|")+")","i")}function nt(){return this.hours()%12||12}function it(e,t){i(e,0,0,function(){return this.localeData().meridiem(this.hours(),this.minutes(),t)})}function ot(e,t){return t._meridiemParse}i("H",["HH",2],0,"hour"),i("h",["hh",2],0,nt),i("k",["kk",2],0,function(){return this.hours()||24}),i("hmm",0,0,function(){return""+nt.apply(this)+g(this.minutes(),2)}),i("hmmss",0,0,function(){return""+nt.apply(this)+g(this.minutes(),2)+g(this.seconds(),2)}),i("Hmm",0,0,function(){return""+this.hours()+g(this.minutes(),2)}),i("Hmmss",0,0,function(){return""+this.hours()+g(this.minutes(),2)+g(this.seconds(),2)}),it("a",!0),it("A",!1),t("hour","h"),n("hour",13),w("a",ot),w("A",ot),w("H",b),w("h",b),w("k",b),w("HH",b,v),w("hh",b,v),w("kk",b,v),w("hmm",pe),w("hmmss",fe),w("Hmm",pe),w("Hmmss",fe),S(["H","HH"],x),S(["k","kk"],function(e,t,n){e=d(e);t[x]=24===e?0:e}),S(["a","A"],function(e,t,n){n._isPm=n._locale.isPM(e),n._meridiem=e}),S(["h","hh"],function(e,t,n){t[x]=d(e),m(n).bigHour=!0}),S("hmm",function(e,t,n){var i=e.length-2;t[x]=d(e.substr(0,i)),t[M]=d(e.substr(i)),m(n).bigHour=!0}),S("hmmss",function(e,t,n){var i=e.length-4,o=e.length-2;t[x]=d(e.substr(0,i)),t[M]=d(e.substr(i,2)),t[P]=d(e.substr(o)),m(n).bigHour=!0}),S("Hmm",function(e,t,n){var i=e.length-2;t[x]=d(e.substr(0,i)),t[M]=d(e.substr(i))}),S("Hmmss",function(e,t,n){var i=e.length-4,o=e.length-2;t[x]=d(e.substr(0,i)),t[M]=d(e.substr(i,2)),t[P]=d(e.substr(o))});var rt,y=Ie("Hours",!0),st={calendar:{sameDay:"[Today at] LT",nextDay:"[Tomorrow at] LT",nextWeek:"dddd [at] LT",lastDay:"[Yesterday at] LT",lastWeek:"[Last] dddd [at] LT",sameElse:"L"},longDateFormat:{LTS:"h:mm:ss A",LT:"h:mm A",L:"MM/DD/YYYY",LL:"MMMM D, YYYY",LLL:"MMMM D, YYYY h:mm A",LLLL:"dddd, MMMM D, YYYY h:mm A"},invalidDate:"Invalid date",ordinal:"%d",dayOfMonthOrdinalParse:/\d{1,2}/,relativeTime:{future:"in %s",past:"%s ago",s:"a few seconds",ss:"%d seconds",m:"a minute",mm:"%d minutes",h:"an hour",hh:"%d hours",d:"a day",dd:"%d days",M:"a month",MM:"%d months",y:"a year",yy:"%d years"},months:Be,monthsShort:Ne,week:{dow:0,doy:6},weekdays:Qe,weekdaysMin:Ke,weekdaysShort:Xe,meridiemParse:/[ap]\.?m?\.?/i},E={},at={};function lt(e){return e&&e.toLowerCase().replace("_","-")}function ut(e){var t;if(!E[e]&&"undefined"!=typeof module&&module&&module.exports)try{t=rt._abbr,require("./locale/"+e),ct(t)}catch(e){}return E[e]}function ct(e,t){return e&&((t=r(t)?ht(e):dt(e,t))?rt=t:"undefined"!=typeof console&&console.warn&&console.warn("Locale "+e+" not found. Did you forget to load it?")),rt._abbr}function dt(e,t){if(null===t)return delete E[e],null;var n,i=st;if(t.abbr=e,null!=E[e])K("defineLocaleOverride","use moment.updateLocale(localeName, config) to change an existing locale. moment.defineLocale(localeName, config) should only be used for creating a new locale See http://momentjs.com/guides/#/warnings/define-locale/ for more info."),i=E[e]._config;else if(null!=t.parentLocale)if(null!=E[t.parentLocale])i=E[t.parentLocale]._config;else{if(null==(n=ut(t.parentLocale)))return at[t.parentLocale]||(at[t.parentLocale]=[]),at[t.parentLocale].push({name:e,config:t}),null;i=n._config}return E[e]=new J(Z(i,t)),at[e]&&at[e].forEach(function(e){dt(e.name,e.config)}),ct(e),E[e]}function ht(e){var t;if(e=e&&e._locale&&e._locale._abbr?e._locale._abbr:e){if(!l(e)){if(t=ut(e))return t;e=[e]}for(var n,i,o,r,s=e,a=0;a<s.length;){for(n=(r=lt(s[a]).split("-")).length,i=(i=lt(s[a+1]))?i.split("-"):null;0<n;){if(o=ut(r.slice(0,n).join("-")))return o;if(i&&i.length>=n&&q(r,i,!0)>=n-1)break;n--}a++}}return rt}function pt(e){var t=e._a;return t&&-2===m(e).overflow&&(t=t[C]<0||11<t[C]?C:t[k]<1||t[k]>Oe(t[T],t[C])?k:t[x]<0||24<t[x]||24===t[x]&&(0!==t[M]||0!==t[P]||0!==t[xe])?x:t[M]<0||59<t[M]?M:t[P]<0||59<t[P]?P:t[xe]<0||999<t[xe]?xe:-1,m(e)._overflowDayOfYear&&(t<T||k<t)&&(t=k),m(e)._overflowWeeks&&-1===t&&(t=Me),m(e)._overflowWeekday&&-1===t&&(t=Pe),m(e).overflow=t),e}function ft(e,t,n){return null!=e?e:null!=t?t:n}function mt(e){var t,n,i,o,r,s,a,l,u=[];if(!e._d){var c=e,d=new Date(p.now()),h=c._useUTC?[d.getUTCFullYear(),d.getUTCMonth(),d.getUTCDate()]:[d.getFullYear(),d.getMonth(),d.getDate()];for(e._w&&null==e._a[k]&&null==e._a[C]&&(null!=(d=(c=e)._w).GG||null!=d.W||null!=d.E?(o=1,r=4,a=ft(d.GG,c._a[T],He(D(),1,4).year),l=ft(d.W,1),((n=ft(d.E,1))<1||7<n)&&(i=!0)):(o=c._locale._week.dow,r=c._locale._week.doy,s=He(D(),o,r),a=ft(d.gg,c._a[T],s.year),l=ft(d.w,s.week),null!=d.d?((n=d.d)<0||6<n)&&(i=!0):null!=d.e?(n=d.e+o,(d.e<0||6<d.e)&&(i=!0)):n=o),l<1||l>qe(a,o,r)?m(c)._overflowWeeks=!0:null!=i?m(c)._overflowWeekday=!0:(s=Ye(a,l,n,o,r),c._a[T]=s.year,c._dayOfYear=s.dayOfYear)),null!=e._dayOfYear&&(d=ft(e._a[T],h[T]),(e._dayOfYear>Ae(d)||0===e._dayOfYear)&&(m(e)._overflowDayOfYear=!0),i=We(d,0,e._dayOfYear),e._a[C]=i.getUTCMonth(),e._a[k]=i.getUTCDate()),t=0;t<3&&null==e._a[t];++t)e._a[t]=u[t]=h[t];for(;t<7;t++)e._a[t]=u[t]=null==e._a[t]?2===t?1:0:e._a[t];24===e._a[x]&&0===e._a[M]&&0===e._a[P]&&0===e._a[xe]&&(e._nextDay=!0,e._a[x]=0),e._d=(e._useUTC?We:function(e,t,n,i,o,r,s){t=new Date(e,t,n,i,o,r,s);return e<100&&0<=e&&isFinite(t.getFullYear())&&t.setFullYear(e),t}).apply(null,u),a=e._useUTC?e._d.getUTCDay():e._d.getDay(),null!=e._tzm&&e._d.setUTCMinutes(e._d.getUTCMinutes()-e._tzm),e._nextDay&&(e._a[x]=24),e._w&&void 0!==e._w.d&&e._w.d!==a&&(m(e).weekdayMismatch=!0)}}var _t=/^\s*((?:[+-]\d{6}|\d{4})-(?:\d\d-\d\d|W\d\d-\d|W\d\d|\d\d\d|\d\d))(?:(T| )(\d\d(?::\d\d(?::\d\d(?:[.,]\d+)?)?)?)([\+\-]\d\d(?::?\d\d)?|\s*Z)?)?$/,gt=/^\s*((?:[+-]\d{6}|\d{4})(?:\d\d\d\d|W\d\d\d|W\d\d|\d\d\d|\d\d))(?:(T| )(\d\d(?:\d\d(?:\d\d(?:[.,]\d+)?)?)?)([\+\-]\d\d(?::?\d\d)?|\s*Z)?)?$/,vt=/Z|[+-]\d\d(?::?\d\d)?/,bt=[["YYYYYY-MM-DD",/[+-]\d{6}-\d\d-\d\d/],["YYYY-MM-DD",/\d{4}-\d\d-\d\d/],["GGGG-[W]WW-E",/\d{4}-W\d\d-\d/],["GGGG-[W]WW",/\d{4}-W\d\d/,!1],["YYYY-DDD",/\d{4}-\d{3}/],["YYYY-MM",/\d{4}-\d\d/,!1],["YYYYYYMMDD",/[+-]\d{10}/],["YYYYMMDD",/\d{8}/],["GGGG[W]WWE",/\d{4}W\d{3}/],["GGGG[W]WW",/\d{4}W\d{2}/,!1],["YYYYDDD",/\d{7}/]],yt=[["HH:mm:ss.SSSS",/\d\d:\d\d:\d\d\.\d+/],["HH:mm:ss,SSSS",/\d\d:\d\d:\d\d,\d+/],["HH:mm:ss",/\d\d:\d\d:\d\d/],["HH:mm",/\d\d:\d\d/],["HHmmss.SSSS",/\d\d\d\d\d\d\.\d+/],["HHmmss,SSSS",/\d\d\d\d\d\d,\d+/],["HHmmss",/\d\d\d\d\d\d/],["HHmm",/\d\d\d\d/],["HH",/\d\d/]],wt=/^\/?Date\((\-?\d+)/i;function St(e){var t,n,i,o,r,s,a=e._i,l=_t.exec(a)||gt.exec(a);if(l){for(m(e).iso=!0,t=0,n=bt.length;t<n;t++)if(bt[t][1].exec(l[1])){o=bt[t][0],i=!1!==bt[t][2];break}if(null==o)return e._isValid=!1;if(l[3]){for(t=0,n=yt.length;t<n;t++)if(yt[t][1].exec(l[3])){r=(l[2]||" ")+yt[t][0];break}if(null==r)return e._isValid=!1}if(!i&&null!=r)return e._isValid=!1;if(l[4]){if(!vt.exec(l[4]))return e._isValid=!1;s="Z"}e._f=o+(r||"")+(s||""),xt(e)}else e._isValid=!1}var Tt=/^(?:(Mon|Tue|Wed|Thu|Fri|Sat|Sun),?\s)?(\d{1,2})\s(Jan|Feb|Mar|Apr|May|Jun|Jul|Aug|Sep|Oct|Nov|Dec)\s(\d{2,4})\s(\d\d):(\d\d)(?::(\d\d))?\s(?:(UT|GMT|[ECMP][SD]T)|([Zz])|([+-]\d{4}))$/;var Ct={UT:0,GMT:0,EDT:-240,EST:-300,CDT:-300,CST:-360,MDT:-360,MST:-420,PDT:-420,PST:-480};function kt(e){var t,n,i,o,r,s,a=Tt.exec(e._i.replace(/\([^)]*\)|[\n\t]/g," ").replace(/(\s\s+)/g," ").replace(/^\s\s*/,"").replace(/\s\s*$/,""));a?(t=a[4],n=a[3],i=a[2],o=a[5],r=a[6],s=a[7],t=[(t=parseInt(t,10))<=49?2e3+t:t<=999?1900+t:t,Ne.indexOf(n),parseInt(i,10),parseInt(o,10),parseInt(r,10)],s&&t.push(parseInt(s,10)),i=n=t,o=e,(r=a[1])&&Xe.indexOf(r)!==new Date(i[0],i[1],i[2]).getDay()?(m(o).weekdayMismatch=!0,o._isValid=!1):(e._a=n,e._tzm=(s=a[8],t=a[9],r=a[10],s?Ct[s]:t?0:((s=parseInt(r,10))-(t=s%100))/100*60+t),e._d=We.apply(null,e._a),e._d.setUTCMinutes(e._d.getUTCMinutes()-e._tzm),m(e).rfc2822=!0)):e._isValid=!1}function xt(e){if(e._f!==p.ISO_8601)if(e._f!==p.RFC_2822){e._a=[],m(e).empty=!0;for(var t,n,i,o=""+e._i,r=o.length,s=0,a=ue(e._f,e._locale).match(oe)||[],l=0;l<a.length;l++)t=a[l],(h=(o.match((h=e,f(Se,d=t)?Se[d](h._strict,h._locale):new RegExp(Te(d.replace("\\","").replace(/\\(\[)|\\(\])|\[([^\]\[]*)\]|\\(.)/g,function(e,t,n,i,o){return t||n||i||o})))))||[])[0])&&(0<(d=o.substr(0,o.indexOf(h))).length&&m(e).unusedInput.push(d),o=o.slice(o.indexOf(h)+h.length),s+=h.length),ae[t]?(h?m(e).empty=!1:m(e).unusedTokens.push(t),d=t,i=e,null!=(n=h)&&f(Ce,d)&&Ce[d](n,i._a,i,d)):e._strict&&!h&&m(e).unusedTokens.push(t);m(e).charsLeftOver=r-s,0<o.length&&m(e).unusedInput.push(o),e._a[x]<=12&&!0===m(e).bigHour&&0<e._a[x]&&(m(e).bigHour=void 0),m(e).parsedDateParts=e._a.slice(0),m(e).meridiem=e._meridiem,e._a[x]=(r=e._locale,u=e._a[x],null==(c=e._meridiem)?u:null!=r.meridiemHour?r.meridiemHour(u,c):(null!=r.isPM&&((r=r.isPM(c))&&u<12&&(u+=12),r||12!==u||(u=0)),u)),mt(e),pt(e)}else kt(e);else St(e);var u,c,d,h}function Mt(e){var t,n,i=e._i,o=e._f;return e._locale=e._locale||ht(e._l),null===i||void 0===o&&""===i?z({nullInput:!0}):("string"==typeof i&&(e._i=i=e._locale.preparse(i)),s(i)?new H(pt(i)):(R(i)?e._d=i:l(o)?function(e){var t,n,i,o,r;if(0===e._f.length)return m(e).invalidFormat=!0,e._d=new Date(NaN);for(o=0;o<e._f.length;o++)r=0,t=G({},e),null!=e._useUTC&&(t._useUTC=e._useUTC),t._f=e._f[o],xt(t),$(t)&&(r=(r+=m(t).charsLeftOver)+10*m(t).unusedTokens.length,m(t).score=r,(null==i||r<i)&&(i=r,n=t));a(e,n||t)}(e):o?xt(e):r(o=(i=e)._i)?i._d=new Date(p.now()):R(o)?i._d=new Date(o.valueOf()):"string"==typeof o?(t=i,null===(n=wt.exec(t._i))?(St(t),!1===t._isValid&&(delete t._isValid,kt(t),!1===t._isValid&&(delete t._isValid,p.createFromInputFallback(t)))):t._d=new Date(+n[1])):l(o)?(i._a=V(o.slice(0),function(e){return parseInt(e,10)}),mt(i)):B(o)?(t=i)._d||(n=ne(t._i),t._a=V([n.year,n.month,n.day||n.date,n.hour,n.minute,n.second,n.millisecond],function(e){return e&&parseInt(e,10)}),mt(t)):N(o)?i._d=new Date(o):p.createFromInputFallback(i),$(e)||(e._d=null),e))}function Pt(e,t,n,i,o){var r={};return!0!==n&&!1!==n||(i=n,n=void 0),(B(e)&&function(e){if(Object.getOwnPropertyNames)return 0===Object.getOwnPropertyNames(e).length;for(var t in e)if(e.hasOwnProperty(t))return;return 1}(e)||l(e)&&0===e.length)&&(e=void 0),r._isAMomentObject=!0,r._useUTC=r._isUTC=o,r._l=n,r._i=e,r._f=t,r._strict=i,(o=new H(pt(Mt(r))))._nextDay&&(o.add(1,"d"),o._nextDay=void 0),o}function D(e,t,n,i){return Pt(e,t,n,i,!1)}p.createFromInputFallback=e("value provided is not in a recognized RFC2822 or ISO format. moment construction falls back to js Date(), which is not reliable across all browsers and versions. Non RFC2822/ISO date formats are discouraged and will be removed in an upcoming major release. Please refer to http://momentjs.com/guides/#/warnings/js-date/ for more info.",function(e){e._d=new Date(e._i+(e._useUTC?" UTC":""))}),p.ISO_8601=function(){},p.RFC_2822=function(){};pe=e("moment().min is deprecated, use moment.max instead. http://momentjs.com/guides/#/warnings/min-max/",function(){var e=D.apply(null,arguments);return this.isValid()&&e.isValid()?e<this?this:e:z()}),fe=e("moment().max is deprecated, use moment.min instead. http://momentjs.com/guides/#/warnings/min-max/",function(){var e=D.apply(null,arguments);return this.isValid()&&e.isValid()?this<e?this:e:z()});function At(e,t){var n,i;if(!(t=1===t.length&&l(t[0])?t[0]:t).length)return D();for(n=t[0],i=1;i<t.length;++i)t[i].isValid()&&!t[i][e](n)||(n=t[i]);return n}var Et=["year","quarter","month","week","day","hour","minute","second","millisecond"];function Dt(e){var e=ne(e),t=e.year||0,n=e.quarter||0,i=e.month||0,o=e.week||0,r=e.day||0,s=e.hour||0,a=e.minute||0,l=e.second||0,u=e.millisecond||0;this._isValid=function(e){for(var t in e)if(-1===A.call(Et,t)||null!=e[t]&&isNaN(e[t]))return!1;for(var n=!1,i=0;i<Et.length;++i)if(e[Et[i]]){if(n)return!1;parseFloat(e[Et[i]])!==d(e[Et[i]])&&(n=!0)}return!0}(e),this._milliseconds=+u+1e3*l+6e4*a+1e3*s*60*60,this._days=+r+7*o,this._months=+i+3*n+12*t,this._data={},this._locale=ht(),this._bubble()}function It(e){return e instanceof Dt}function jt(e){return e<0?-1*Math.round(-1*e):Math.round(e)}function Ft(e,n){i(e,0,0,function(){var e=this.utcOffset(),t="+";return e<0&&(e=-e,t="-"),t+g(~~(e/60),2)+n+g(~~e%60,2)})}Ft("Z",":"),Ft("ZZ",""),w("Z",we),w("ZZ",we),S(["Z","ZZ"],function(e,t,n){n._useUTC=!0,n._tzm=Lt(we,e)});var Ot=/([\+\-]|\d\d)/gi;function Lt(e,t){var t=(t||"").match(e);return null===t?null:0===(t=60*(e=((t[t.length-1]||[])+"").match(Ot)||["-",0,0])[1]+d(e[2]))?0:"+"===e[0]?t:-t}function Bt(e,t){var n;return t._isUTC?(t=t.clone(),n=(s(e)||R(e)?e:D(e)).valueOf()-t.valueOf(),t._d.setTime(t._d.valueOf()+n),p.updateOffset(t,!1),t):D(e).local()}function Nt(e){return 15*-Math.round(e._d.getTimezoneOffset()/15)}function Rt(){return!!this.isValid()&&this._isUTC&&0===this._offset}p.updateOffset=function(){};var Vt=/^(\-|\+)?(?:(\d*)[. ])?(\d+)\:(\d+)(?:\:(\d+)(\.\d*)?)?$/,$t=/^(-|\+)?P(?:([-+]?[0-9,.]*)Y)?(?:([-+]?[0-9,.]*)M)?(?:([-+]?[0-9,.]*)W)?(?:([-+]?[0-9,.]*)D)?(?:T(?:([-+]?[0-9,.]*)H)?(?:([-+]?[0-9,.]*)M)?(?:([-+]?[0-9,.]*)S)?)?$/;function I(e,t){var n,i,o=e,r=null;return It(e)?o={ms:e._milliseconds,d:e._days,M:e._months}:N(e)?(o={},t?o[t]=e:o.milliseconds=e):(r=Vt.exec(e))?(n="-"===r[1]?-1:1,o={y:0,d:d(r[k])*n,h:d(r[x])*n,m:d(r[M])*n,s:d(r[P])*n,ms:d(jt(1e3*r[xe]))*n}):(r=$t.exec(e))?(n="-"===r[1]?-1:(r[1],1),o={y:zt(r[2],n),M:zt(r[3],n),w:zt(r[4],n),d:zt(r[5],n),h:zt(r[6],n),m:zt(r[7],n),s:zt(r[8],n)}):null==o?o={}:"object"==_typeof(o)&&("from"in o||"to"in o)&&(t=D(o.from),r=D(o.to),n=t.isValid()&&r.isValid()?(r=Bt(r,t),t.isBefore(r)?i=Ut(t,r):((i=Ut(r,t)).milliseconds=-i.milliseconds,i.months=-i.months),i):{milliseconds:0,months:0},(o={}).ms=n.milliseconds,o.M=n.months),r=new Dt(o),It(e)&&f(e,"_locale")&&(r._locale=e._locale),r}function zt(e,t){e=e&&parseFloat(e.replace(",","."));return(isNaN(e)?0:e)*t}function Ut(e,t){var n={milliseconds:0,months:0};return n.months=t.month()-e.month()+12*(t.year()-e.year()),e.clone().add(n.months,"M").isAfter(t)&&--n.months,n.milliseconds=+t-+e.clone().add(n.months,"M"),n}function Wt(i,o){return function(e,t){var n;return null===t||isNaN(+t)||(K(o,"moment()."+o+"(period, number) is deprecated. Please use moment()."+o+"(number, period). See http://momentjs.com/guides/#/warnings/add-inverted-param/ for more info."),n=e,e=t,t=n),Gt(this,I(e="string"==typeof e?+e:e,t),i),this}}function Gt(e,t,n,i){var o=t._milliseconds,r=jt(t._days),t=jt(t._months);e.isValid()&&(i=null==i||i,t&&Re(e,je(e,"Month")+t*n),r&&Fe(e,"Date",je(e,"Date")+r*n),o&&e._d.setTime(e._d.valueOf()+o*n),i&&p.updateOffset(e,r||t))}I.fn=Dt.prototype,I.invalid=function(){return I(NaN)};Be=Wt(1,"add"),Qe=Wt(-1,"subtract");function Yt(e,t){var n=12*(t.year()-e.year())+(t.month()-e.month()),i=e.clone().add(n,"months");return-(n+(t-i<0?(t-i)/(i-e.clone().add(n-1,"months")):(t-i)/(e.clone().add(1+n,"months")-i)))||0}function Ht(e){return void 0===e?this._locale._abbr:(null!=(e=ht(e))&&(this._locale=e),this)}p.defaultFormat="YYYY-MM-DDTHH:mm:ssZ",p.defaultFormatUtc="YYYY-MM-DDTHH:mm:ss[Z]";Ke=e("moment().lang() is deprecated. Instead, use moment().localeData() to get the language configuration. Use moment().locale() to change languages.",function(e){return void 0===e?this.localeData():this.locale(e)});function qt(){return this._locale}function Qt(e,t){i(0,[e,e.length],0,t)}function Xt(e,t,n,i,o){var r;return null==e?He(this,i,o).year:((r=qe(e,i,o))<t&&(t=r),function(e,t,n,i,o){e=Ye(e,t,n,i,o),t=We(e.year,0,e.dayOfYear);return this.year(t.getUTCFullYear()),this.month(t.getUTCMonth()),this.date(t.getUTCDate()),this}.call(this,e,t,n,i,o))}i(0,["gg",2],0,function(){return this.weekYear()%100}),i(0,["GG",2],0,function(){return this.isoWeekYear()%100}),Qt("gggg","weekYear"),Qt("ggggg","weekYear"),Qt("GGGG","isoWeekYear"),Qt("GGGGG","isoWeekYear"),t("weekYear","gg"),t("isoWeekYear","GG"),n("weekYear",1),n("isoWeekYear",1),w("G",be),w("g",be),w("GG",b,v),w("gg",b,v),w("GGGG",_e,de),w("gggg",_e,de),w("GGGGG",ge,he),w("ggggg",ge,he),ke(["gggg","ggggg","GGGG","GGGGG"],function(e,t,n,i){t[i.substr(0,2)]=d(e)}),ke(["gg","GG"],function(e,t,n,i){t[i]=p.parseTwoDigitYear(e)}),i("Q",0,"Qo","quarter"),t("quarter","Q"),n("quarter",7),w("Q",o),S("Q",function(e,t){t[C]=3*(d(e)-1)}),i("D",["DD",2],"Do","date"),t("date","D"),n("date",9),w("D",b),w("DD",b,v),w("Do",function(e,t){return e?t._dayOfMonthOrdinalParse||t._ordinalParse:t._dayOfMonthOrdinalParseLenient}),S(["D","DD"],k),S("Do",function(e,t){t[k]=d(e.match(b)[0])});_e=Ie("Date",!0),i("DDD",["DDDD",3],"DDDo","dayOfYear"),t("dayOfYear","DDD"),n("dayOfYear",4),w("DDD",me),w("DDDD",ce),S(["DDD","DDDD"],function(e,t,n){n._dayOfYear=d(e)}),i("m",["mm",2],0,"minute"),t("minute","m"),n("minute",14),w("m",b),w("mm",b,v),S(["m","mm"],M),de=Ie("Minutes",!1);i("s",["ss",2],0,"second"),t("second","s"),n("second",15),w("s",b),w("ss",b,v),S(["s","ss"],P);var Kt,ge=Ie("Seconds",!1);for(i("S",0,0,function(){return~~(this.millisecond()/100)}),i(0,["SS",2],0,function(){return~~(this.millisecond()/10)}),i(0,["SSS",3],0,"millisecond"),i(0,["SSSS",4],0,function(){return 10*this.millisecond()}),i(0,["SSSSS",5],0,function(){return 100*this.millisecond()}),i(0,["SSSSSS",6],0,function(){return 1e3*this.millisecond()}),i(0,["SSSSSSS",7],0,function(){return 1e4*this.millisecond()}),i(0,["SSSSSSSS",8],0,function(){return 1e5*this.millisecond()}),i(0,["SSSSSSSSS",9],0,function(){return 1e6*this.millisecond()}),t("millisecond","ms"),n("millisecond",16),w("S",me,o),w("SS",me,v),w("SSS",me,ce),Kt="SSSS";Kt.length<=9;Kt+="S")w(Kt,ve);function Zt(e,t){t[xe]=d(1e3*("0."+e))}for(Kt="S";Kt.length<=9;Kt+="S")S(Kt,Zt);he=Ie("Milliseconds",!1),i("z",0,0,"zoneAbbr"),i("zz",0,0,"zoneName"),o=H.prototype;function Jt(e){return e}o.add=Be,o.calendar=function(e,t){var e=e||D(),n=Bt(e,this).startOf("day"),n=p.calendarFormat(this,n)||"sameElse",t=t&&(h(t[n])?t[n].call(this,e):t[n]);return this.format(t||this.localeData().calendar(n,this,D(e)))},o.clone=function(){return new H(this)},o.diff=function(e,t,n){var i,o,r;if(!this.isValid())return NaN;if(!(i=Bt(e,this)).isValid())return NaN;switch(o=6e4*(i.utcOffset()-this.utcOffset()),t=_(t)){case"year":r=Yt(this,i)/12;break;case"month":r=Yt(this,i);break;case"quarter":r=Yt(this,i)/3;break;case"second":r=(this-i)/1e3;break;case"minute":r=(this-i)/6e4;break;case"hour":r=(this-i)/36e5;break;case"day":r=(this-i-o)/864e5;break;case"week":r=(this-i-o)/6048e5;break;default:r=this-i}return n?r:c(r)},o.endOf=function(e){return void 0===(e=_(e))||"millisecond"===e?this:this.startOf(e="date"===e?"day":e).add(1,"isoWeek"===e?"week":e).subtract(1,"ms")},o.format=function(e){e=e||(this.isUtc()?p.defaultFormatUtc:p.defaultFormat);e=le(this,e);return this.localeData().postformat(e)},o.from=function(e,t){return this.isValid()&&(s(e)&&e.isValid()||D(e).isValid())?I({to:this,from:e}).locale(this.locale()).humanize(!t):this.localeData().invalidDate()},o.fromNow=function(e){return this.from(D(),e)},o.to=function(e,t){return this.isValid()&&(s(e)&&e.isValid()||D(e).isValid())?I({from:this,to:e}).locale(this.locale()).humanize(!t):this.localeData().invalidDate()},o.toNow=function(e){return this.to(D(),e)},o.get=function(e){return h(this[e=_(e)])?this[e]():this},o.invalidAt=function(){return m(this).overflow},o.isAfter=function(e,t){e=s(e)?e:D(e);return!(!this.isValid()||!e.isValid())&&("millisecond"===(t=_(r(t)?"millisecond":t))?this.valueOf()>e.valueOf():e.valueOf()<this.clone().startOf(t).valueOf())},o.isBefore=function(e,t){e=s(e)?e:D(e);return!(!this.isValid()||!e.isValid())&&("millisecond"===(t=_(r(t)?"millisecond":t))?this.valueOf()<e.valueOf():this.clone().endOf(t).valueOf()<e.valueOf())},o.isBetween=function(e,t,n,i){return("("===(i=i||"()")[0]?this.isAfter(e,n):!this.isBefore(e,n))&&(")"===i[1]?this.isBefore(t,n):!this.isAfter(t,n))},o.isSame=function(e,t){var e=s(e)?e:D(e);return!(!this.isValid()||!e.isValid())&&("millisecond"===(t=_(t||"millisecond"))?this.valueOf()===e.valueOf():(e=e.valueOf(),this.clone().startOf(t).valueOf()<=e&&e<=this.clone().endOf(t).valueOf()))},o.isSameOrAfter=function(e,t){return this.isSame(e,t)||this.isAfter(e,t)},o.isSameOrBefore=function(e,t){return this.isSame(e,t)||this.isBefore(e,t)},o.isValid=function(){return $(this)},o.lang=Ke,o.locale=Ht,o.localeData=qt,o.max=fe,o.min=pe,o.parsingFlags=function(){return a({},m(this))},o.set=function(n,e){if("object"==_typeof(n))for(var t=function(){var e,t=[];for(e in n)t.push({unit:e,priority:ie[e]});return t.sort(function(e,t){return e.priority-t.priority}),t}(n=ne(n)),i=0;i<t.length;i++)this[t[i].unit](n[t[i].unit]);else if(h(this[n=_(n)]))return this[n](e);return this},o.startOf=function(e){switch(e=_(e)){case"year":this.month(0);case"quarter":case"month":this.date(1);case"week":case"isoWeek":case"day":case"date":this.hours(0);case"hour":this.minutes(0);case"minute":this.seconds(0);case"second":this.milliseconds(0)}return"week"===e&&this.weekday(0),"isoWeek"===e&&this.isoWeekday(1),"quarter"===e&&this.month(3*Math.floor(this.month()/3)),this},o.subtract=Qe,o.toArray=function(){var e=this;return[e.year(),e.month(),e.date(),e.hour(),e.minute(),e.second(),e.millisecond()]},o.toObject=function(){var e=this;return{years:e.year(),months:e.month(),date:e.date(),hours:e.hours(),minutes:e.minutes(),seconds:e.seconds(),milliseconds:e.milliseconds()}},o.toDate=function(){return new Date(this.valueOf())},o.toISOString=function(e){var t;return this.isValid()?(t=(e=!0!==e)?this.clone().utc():this).year()<0||9999<t.year()?le(t,e?"YYYYYY-MM-DD[T]HH:mm:ss.SSS[Z]":"YYYYYY-MM-DD[T]HH:mm:ss.SSSZ"):h(Date.prototype.toISOString)?e?this.toDate().toISOString():new Date(this.valueOf()+60*this.utcOffset()*1e3).toISOString().replace("Z",le(t,"Z")):le(t,e?"YYYY-MM-DD[T]HH:mm:ss.SSS[Z]":"YYYY-MM-DD[T]HH:mm:ss.SSSZ"):null},o.inspect=function(){var e,t,n;return this.isValid()?(t="moment",e="",this.isLocal()||(t=0===this.utcOffset()?"moment.utc":"moment.parseZone",e="Z"),t="["+t+'("]',n=0<=this.year()&&this.year()<=9999?"YYYY":"YYYYYY",this.format(t+n+"-MM-DD[T]HH:mm:ss.SSS"+(e+'[")]'))):"moment.invalid(/* "+this._i+" */)"},o.toJSON=function(){return this.isValid()?this.toISOString():null},o.toString=function(){return this.clone().locale("en").format("ddd MMM DD YYYY HH:mm:ss [GMT]ZZ")},o.unix=function(){return Math.floor(this.valueOf()/1e3)},o.valueOf=function(){return this._d.valueOf()-6e4*(this._offset||0)},o.creationData=function(){return{input:this._i,format:this._f,locale:this._locale,isUTC:this._isUTC,strict:this._strict}},o.year=De,o.isLeapYear=function(){return Ee(this.year())},o.weekYear=function(e){return Xt.call(this,e,this.week(),this.weekday(),this.localeData()._week.dow,this.localeData()._week.doy)},o.isoWeekYear=function(e){return Xt.call(this,e,this.isoWeek(),this.isoWeekday(),1,4)},o.quarter=o.quarters=function(e){return null==e?Math.ceil((this.month()+1)/3):this.month(3*(e-1)+this.month()%3)},o.month=Ve,o.daysInMonth=function(){return Oe(this.year(),this.month())},o.week=o.weeks=function(e){var t=this.localeData().week(this);return null==e?t:this.add(7*(e-t),"d")},o.isoWeek=o.isoWeeks=function(e){var t=He(this,1,4).week;return null==e?t:this.add(7*(e-t),"d")},o.weeksInYear=function(){var e=this.localeData()._week;return qe(this.year(),e.dow,e.doy)},o.isoWeeksInYear=function(){return qe(this.year(),1,4)},o.date=_e,o.day=o.days=function(e){var t,n,i;return this.isValid()?(i=this._isUTC?this._d.getUTCDay():this._d.getDay(),null!=e?(t=e,n=this.localeData(),e="string"!=typeof t?t:isNaN(t)?"number"==typeof(t=n.weekdaysParse(t))?t:null:parseInt(t,10),this.add(e-i,"d")):i):null!=e?this:NaN},o.weekday=function(e){var t;return this.isValid()?(t=(this.day()+7-this.localeData()._week.dow)%7,null==e?t:this.add(e-t,"d")):null!=e?this:NaN},o.isoWeekday=function(e){var t,n;return this.isValid()?null!=e?(t=e,n=this.localeData(),n="string"==typeof t?n.weekdaysParse(t)%7||7:isNaN(t)?null:t,this.day(this.day()%7?n:n-7)):this.day()||7:null!=e?this:NaN},o.dayOfYear=function(e){var t=Math.round((this.clone().startOf("day")-this.clone().startOf("year"))/864e5)+1;return null==e?t:this.add(e-t,"d")},o.hour=o.hours=y,o.minute=o.minutes=de,o.second=o.seconds=ge,o.millisecond=o.milliseconds=he,o.utcOffset=function(e,t,n){var i,o=this._offset||0;if(!this.isValid())return null!=e?this:NaN;if(null==e)return this._isUTC?o:Nt(this);if("string"==typeof e){if(null===(e=Lt(we,e)))return this}else Math.abs(e)<16&&!n&&(e*=60);return!this._isUTC&&t&&(i=Nt(this)),this._offset=e,this._isUTC=!0,null!=i&&this.add(i,"m"),o!==e&&(!t||this._changeInProgress?Gt(this,I(e-o,"m"),1,!1):this._changeInProgress||(this._changeInProgress=!0,p.updateOffset(this,!0),this._changeInProgress=null)),this},o.utc=function(e){return this.utcOffset(0,e)},o.local=function(e){return this._isUTC&&(this.utcOffset(0,e),this._isUTC=!1,e&&this.subtract(Nt(this),"m")),this},o.parseZone=function(){var e;return null!=this._tzm?this.utcOffset(this._tzm,!1,!0):"string"==typeof this._i&&(null!=(e=Lt(ye,this._i))?this.utcOffset(e):this.utcOffset(0,!0)),this},o.hasAlignedHourOffset=function(e){return!!this.isValid()&&(e=e?D(e).utcOffset():0,(this.utcOffset()-e)%60==0)},o.isDST=function(){return this.utcOffset()>this.clone().month(0).utcOffset()||this.utcOffset()>this.clone().month(5).utcOffset()},o.isLocal=function(){return!!this.isValid()&&!this._isUTC},o.isUtcOffset=function(){return!!this.isValid()&&this._isUTC},o.isUtc=Rt,o.isUTC=Rt,o.zoneAbbr=function(){return this._isUTC?"UTC":""},o.zoneName=function(){return this._isUTC?"Coordinated Universal Time":""},o.dates=e("dates accessor is deprecated. Use date instead.",_e),o.months=e("months accessor is deprecated. Use month instead",Ve),o.years=e("years accessor is deprecated. Use year instead",De),o.zone=e("moment().zone is deprecated, use moment().utcOffset instead. http://momentjs.com/guides/#/warnings/zone/",function(e,t){return null!=e?(this.utcOffset(e="string"!=typeof e?-e:e,t),this):-this.utcOffset()}),o.isDSTShifted=e("isDSTShifted is deprecated. See http://momentjs.com/guides/#/warnings/dst-shifted/ for more information",function(){var e,t;return r(this._isDSTShifted)&&(G(e={},this),(e=Mt(e))._a?(t=(e._isUTC?u:D)(e._a),this._isDSTShifted=this.isValid()&&0<q(e._a,t.toArray())):this._isDSTShifted=!1),this._isDSTShifted});v=J.prototype;function en(e,t,n,i){var o=ht(),i=u().set(i,t);return o[n](i,e)}function tn(e,t,n){if(N(e)&&(t=e,e=void 0),e=e||"",null!=t)return en(e,t,n,"month");for(var i=[],o=0;o<12;o++)i[o]=en(e,o,n,"month");return i}function nn(e,t,n,i){"boolean"==typeof e?N(t)&&(n=t,t=void 0):(t=e,e=!1,N(n=t)&&(n=t,t=void 0)),t=t||"";var o=ht(),r=e?o._week.dow:0;if(null!=n)return en(t,(n+r)%7,i,"day");for(var s=[],a=0;a<7;a++)s[a]=en(t,(a+r)%7,i,"day");return s}v.calendar=function(e,t,n){e=this._calendar[e]||this._calendar.sameElse;return h(e)?e.call(t,n):e},v.longDateFormat=function(e){var t=this._longDateFormat[e],n=this._longDateFormat[e.toUpperCase()];return t||!n?t:(this._longDateFormat[e]=n.replace(/MMMM|MM|DD|dddd/g,function(e){return e.slice(1)}),this._longDateFormat[e])},v.invalidDate=function(){return this._invalidDate},v.ordinal=function(e){return this._ordinal.replace("%d",e)},v.preparse=Jt,v.postformat=Jt,v.relativeTime=function(e,t,n,i){var o=this._relativeTime[n];return h(o)?o(e,t,n,i):o.replace(/%d/i,e)},v.pastFuture=function(e,t){e=this._relativeTime[0<e?"future":"past"];return h(e)?e(t):e.replace(/%s/i,t)},v.set=function(e){var t,n;for(n in e)h(t=e[n])?this[n]=t:this["_"+n]=t;this._config=e,this._dayOfMonthOrdinalParseLenient=new RegExp((this._dayOfMonthOrdinalParse.source||this._ordinalParse.source)+"|"+/\d{1,2}/.source)},v.months=function(e,t){return e?(l(this._months)?this._months:this._months[(this._months.isFormat||Le).test(t)?"format":"standalone"])[e.month()]:l(this._months)?this._months:this._months.standalone},v.monthsShort=function(e,t){return e?(l(this._monthsShort)?this._monthsShort:this._monthsShort[Le.test(t)?"format":"standalone"])[e.month()]:l(this._monthsShort)?this._monthsShort:this._monthsShort.standalone},v.monthsParse=function(e,t,n){var i,o;if(this._monthsParseExact)return function(e,t,n){var i,o,r,e=e.toLocaleLowerCase();if(!this._monthsParse)for(this._monthsParse=[],this._longMonthsParse=[],this._shortMonthsParse=[],i=0;i<12;++i)r=u([2e3,i]),this._shortMonthsParse[i]=this.monthsShort(r,"").toLocaleLowerCase(),this._longMonthsParse[i]=this.months(r,"").toLocaleLowerCase();return n?"MMM"===t?-1!==(o=A.call(this._shortMonthsParse,e))?o:null:-1!==(o=A.call(this._longMonthsParse,e))?o:null:"MMM"===t?-1!==(o=A.call(this._shortMonthsParse,e))||-1!==(o=A.call(this._longMonthsParse,e))?o:null:-1!==(o=A.call(this._longMonthsParse,e))||-1!==(o=A.call(this._shortMonthsParse,e))?o:null}.call(this,e,t,n);for(this._monthsParse||(this._monthsParse=[],this._longMonthsParse=[],this._shortMonthsParse=[]),i=0;i<12;i++){if(o=u([2e3,i]),n&&!this._longMonthsParse[i]&&(this._longMonthsParse[i]=new RegExp("^"+this.months(o,"").replace(".","")+"$","i"),this._shortMonthsParse[i]=new RegExp("^"+this.monthsShort(o,"").replace(".","")+"$","i")),n||this._monthsParse[i]||(o="^"+this.months(o,"")+"|^"+this.monthsShort(o,""),this._monthsParse[i]=new RegExp(o.replace(".",""),"i")),n&&"MMMM"===t&&this._longMonthsParse[i].test(e))return i;if(n&&"MMM"===t&&this._shortMonthsParse[i].test(e))return i;if(!n&&this._monthsParse[i].test(e))return i}},v.monthsRegex=function(e){return this._monthsParseExact?(f(this,"_monthsRegex")||Ue.call(this),e?this._monthsStrictRegex:this._monthsRegex):(f(this,"_monthsRegex")||(this._monthsRegex=ze),this._monthsStrictRegex&&e?this._monthsStrictRegex:this._monthsRegex)},v.monthsShortRegex=function(e){return this._monthsParseExact?(f(this,"_monthsRegex")||Ue.call(this),e?this._monthsShortStrictRegex:this._monthsShortRegex):(f(this,"_monthsShortRegex")||(this._monthsShortRegex=$e),this._monthsShortStrictRegex&&e?this._monthsShortStrictRegex:this._monthsShortRegex)},v.week=function(e){return He(e,this._week.dow,this._week.doy).week},v.firstDayOfYear=function(){return this._week.doy},v.firstDayOfWeek=function(){return this._week.dow},v.weekdays=function(e,t){return e?(l(this._weekdays)?this._weekdays:this._weekdays[this._weekdays.isFormat.test(t)?"format":"standalone"])[e.day()]:l(this._weekdays)?this._weekdays:this._weekdays.standalone},v.weekdaysMin=function(e){return e?this._weekdaysMin[e.day()]:this._weekdaysMin},v.weekdaysShort=function(e){return e?this._weekdaysShort[e.day()]:this._weekdaysShort},v.weekdaysParse=function(e,t,n){var i,o;if(this._weekdaysParseExact)return function(e,t,n){var i,o,r,e=e.toLocaleLowerCase();if(!this._weekdaysParse)for(this._weekdaysParse=[],this._shortWeekdaysParse=[],this._minWeekdaysParse=[],i=0;i<7;++i)r=u([2e3,1]).day(i),this._minWeekdaysParse[i]=this.weekdaysMin(r,"").toLocaleLowerCase(),this._shortWeekdaysParse[i]=this.weekdaysShort(r,"").toLocaleLowerCase(),this._weekdaysParse[i]=this.weekdays(r,"").toLocaleLowerCase();return n?"dddd"===t?-1!==(o=A.call(this._weekdaysParse,e))?o:null:"ddd"===t?-1!==(o=A.call(this._shortWeekdaysParse,e))?o:null:-1!==(o=A.call(this._minWeekdaysParse,e))?o:null:"dddd"===t?-1!==(o=A.call(this._weekdaysParse,e))||-1!==(o=A.call(this._shortWeekdaysParse,e))||-1!==(o=A.call(this._minWeekdaysParse,e))?o:null:"ddd"===t?-1!==(o=A.call(this._shortWeekdaysParse,e))||-1!==(o=A.call(this._weekdaysParse,e))||-1!==(o=A.call(this._minWeekdaysParse,e))?o:null:-1!==(o=A.call(this._minWeekdaysParse,e))||-1!==(o=A.call(this._weekdaysParse,e))||-1!==(o=A.call(this._shortWeekdaysParse,e))?o:null}.call(this,e,t,n);for(this._weekdaysParse||(this._weekdaysParse=[],this._minWeekdaysParse=[],this._shortWeekdaysParse=[],this._fullWeekdaysParse=[]),i=0;i<7;i++){if(o=u([2e3,1]).day(i),n&&!this._fullWeekdaysParse[i]&&(this._fullWeekdaysParse[i]=new RegExp("^"+this.weekdays(o,"").replace(".","\\.?")+"$","i"),this._shortWeekdaysParse[i]=new RegExp("^"+this.weekdaysShort(o,"").replace(".","\\.?")+"$","i"),this._minWeekdaysParse[i]=new RegExp("^"+this.weekdaysMin(o,"").replace(".","\\.?")+"$","i")),this._weekdaysParse[i]||(o="^"+this.weekdays(o,"")+"|^"+this.weekdaysShort(o,"")+"|^"+this.weekdaysMin(o,""),this._weekdaysParse[i]=new RegExp(o.replace(".",""),"i")),n&&"dddd"===t&&this._fullWeekdaysParse[i].test(e))return i;if(n&&"ddd"===t&&this._shortWeekdaysParse[i].test(e))return i;if(n&&"dd"===t&&this._minWeekdaysParse[i].test(e))return i;if(!n&&this._weekdaysParse[i].test(e))return i}},v.weekdaysRegex=function(e){return this._weekdaysParseExact?(f(this,"_weekdaysRegex")||tt.call(this),e?this._weekdaysStrictRegex:this._weekdaysRegex):(f(this,"_weekdaysRegex")||(this._weekdaysRegex=Ze),this._weekdaysStrictRegex&&e?this._weekdaysStrictRegex:this._weekdaysRegex)},v.weekdaysShortRegex=function(e){return this._weekdaysParseExact?(f(this,"_weekdaysRegex")||tt.call(this),e?this._weekdaysShortStrictRegex:this._weekdaysShortRegex):(f(this,"_weekdaysShortRegex")||(this._weekdaysShortRegex=Je),this._weekdaysShortStrictRegex&&e?this._weekdaysShortStrictRegex:this._weekdaysShortRegex)},v.weekdaysMinRegex=function(e){return this._weekdaysParseExact?(f(this,"_weekdaysRegex")||tt.call(this),e?this._weekdaysMinStrictRegex:this._weekdaysMinRegex):(f(this,"_weekdaysMinRegex")||(this._weekdaysMinRegex=et),this._weekdaysMinStrictRegex&&e?this._weekdaysMinStrictRegex:this._weekdaysMinRegex)},v.isPM=function(e){return"p"===(e+"").toLowerCase().charAt(0)},v.meridiem=function(e,t,n){return 11<e?n?"pm":"PM":n?"am":"AM"},ct("en",{dayOfMonthOrdinalParse:/\d{1,2}(th|st|nd|rd)/,ordinal:function(e){var t=e%10;return e+(1===d(e%100/10)?"th":1==t?"st":2==t?"nd":3==t?"rd":"th")}}),p.lang=e("moment.lang is deprecated. Use moment.locale instead.",ct),p.langData=e("moment.langData is deprecated. Use moment.localeData instead.",ht);var j=Math.abs;function on(e,t,n,i){t=I(t,n);return e._milliseconds+=i*t._milliseconds,e._days+=i*t._days,e._months+=i*t._months,e._bubble()}function rn(e){return e<0?Math.floor(e):Math.ceil(e)}function sn(e){return 4800*e/146097}function an(e){return 146097*e/4800}function ln(e){return function(){return this.as(e)}}me=ln("ms"),ce=ln("s"),Be=ln("m"),fe=ln("h"),pe=ln("d"),Qe=ln("w"),y=ln("M"),de=ln("y");function un(e){return function(){return this.isValid()?this._data[e]:NaN}}var ge=un("milliseconds"),he=un("seconds"),_e=un("minutes"),De=un("hours"),v=un("days"),cn=un("months"),dn=un("years"),hn=Math.round,F={ss:44,s:45,m:45,h:22,d:26,M:11},pn=Math.abs;function fn(e){return(0<e)-(e<0)||+e}function mn(){var e,t,n,i,o,r,s,a,l,u;return this.isValid()?(r=pn(this._milliseconds)/1e3,n=pn(this._days),t=pn(this._months),i=c((o=c(r/60))/60),r%=60,o%=60,e=c(t/12),t=t%=12,n=n,i=i,o=o,r=r?r.toFixed(3).replace(/\.?0+$/,""):"",(s=this.asSeconds())?(a=fn(this._months)!==fn(s)?"-":"",l=fn(this._days)!==fn(s)?"-":"",u=fn(this._milliseconds)!==fn(s)?"-":"",(s<0?"-":"")+"P"+(e?a+e+"Y":"")+(t?a+t+"M":"")+(n?l+n+"D":"")+(i||o||r?"T":"")+(i?u+i+"H":"")+(o?u+o+"M":"")+(r?u+r+"S":"")):"P0D"):this.localeData().invalidDate()}var O=Dt.prototype;return O.isValid=function(){return this._isValid},O.abs=function(){var e=this._data;return this._milliseconds=j(this._milliseconds),this._days=j(this._days),this._months=j(this._months),e.milliseconds=j(e.milliseconds),e.seconds=j(e.seconds),e.minutes=j(e.minutes),e.hours=j(e.hours),e.months=j(e.months),e.years=j(e.years),this},O.add=function(e,t){return on(this,e,t,1)},O.subtract=function(e,t){return on(this,e,t,-1)},O.as=function(e){if(!this.isValid())return NaN;var t,n,i=this._milliseconds;if("month"===(e=_(e))||"year"===e)return t=this._days+i/864e5,n=this._months+sn(t),"month"===e?n:n/12;switch(t=this._days+Math.round(an(this._months)),e){case"week":return t/7+i/6048e5;case"day":return t+i/864e5;case"hour":return 24*t+i/36e5;case"minute":return 1440*t+i/6e4;case"second":return 86400*t+i/1e3;case"millisecond":return Math.floor(864e5*t)+i;default:throw new Error("Unknown unit "+e)}},O.asMilliseconds=me,O.asSeconds=ce,O.asMinutes=Be,O.asHours=fe,O.asDays=pe,O.asWeeks=Qe,O.asMonths=y,O.asYears=de,O.valueOf=function(){return this.isValid()?this._milliseconds+864e5*this._days+this._months%12*2592e6+31536e6*d(this._months/12):NaN},O._bubble=function(){var e=this._milliseconds,t=this._days,n=this._months,i=this._data;return 0<=e&&0<=t&&0<=n||e<=0&&t<=0&&n<=0||(e+=864e5*rn(an(n)+t),n=t=0),i.milliseconds=e%1e3,e=c(e/1e3),i.seconds=e%60,e=c(e/60),i.minutes=e%60,e=c(e/60),i.hours=e%24,n+=e=c(sn(t+=c(e/24))),t-=rn(an(e)),e=c(n/12),n%=12,i.days=t,i.months=n,i.years=e,this},O.clone=function(){return I(this)},O.get=function(e){return e=_(e),this.isValid()?this[e+"s"]():NaN},O.milliseconds=ge,O.seconds=he,O.minutes=_e,O.hours=De,O.days=v,O.weeks=function(){return c(this.days()/7)},O.months=cn,O.years=dn,O.humanize=function(e){var t,n,i,o,r,s,a,l,u;return this.isValid()?(t=!e,n=l=this.localeData(),s=I(this).abs(),a=hn(s.as("s")),u=hn(s.as("m")),i=hn(s.as("h")),o=hn(s.as("d")),r=hn(s.as("M")),s=hn(s.as("y")),(a=(a<=F.ss?["s",a]:a<F.s&&["ss",a])||u<=1&&["m"]||u<F.m&&["mm",u]||i<=1&&["h"]||i<F.h&&["hh",i]||o<=1&&["d"]||o<F.d&&["dd",o]||r<=1&&["M"]||r<F.M&&["MM",r]||s<=1&&["y"]||["yy",s])[2]=t,a[3]=0<+this,a[4]=n,u=function(e,t,n,i,o){return o.relativeTime(t||1,!!n,e,i)}.apply(null,a),e&&(u=l.pastFuture(+this,u)),l.postformat(u)):this.localeData().invalidDate()},O.toISOString=mn,O.toString=mn,O.toJSON=mn,O.locale=Ht,O.localeData=qt,O.toIsoString=e("toIsoString() is deprecated. Please use toISOString() instead (notice the capitals)",mn),O.lang=Ke,i("X",0,0,"unix"),i("x",0,0,"valueOf"),w("x",be),w("X",/[+-]?\d+(\.\d{1,3})?/),S("X",function(e,t,n){n._d=new Date(1e3*parseFloat(e,10))}),S("x",function(e,t,n){n._d=new Date(d(e))}),p.version="2.22.2",L=D,p.fn=o,p.min=function(){return At("isBefore",[].slice.call(arguments,0))},p.max=function(){return At("isAfter",[].slice.call(arguments,0))},p.now=function(){return Date.now?Date.now():+new Date},p.utc=u,p.unix=function(e){return D(1e3*e)},p.months=function(e,t){return tn(e,t,"months")},p.isDate=R,p.locale=ct,p.invalid=z,p.duration=I,p.isMoment=s,p.weekdays=function(e,t,n){return nn(e,t,n,"weekdays")},p.parseZone=function(){return D.apply(null,arguments).parseZone()},p.localeData=ht,p.isDuration=It,p.monthsShort=function(e,t){return tn(e,t,"monthsShort")},p.weekdaysMin=function(e,t,n){return nn(e,t,n,"weekdaysMin")},p.defineLocale=dt,p.updateLocale=function(e,t){var n,i;return null!=t?(i=st,(n=new J(t=Z(i=null!=(n=ut(e))?n._config:i,t))).parentLocale=E[e],E[e]=n,ct(e)):null!=E[e]&&(null!=E[e].parentLocale?E[e]=E[e].parentLocale:null!=E[e]&&delete E[e]),E[e]},p.locales=function(){return ee(E)},p.weekdaysShort=function(e,t,n){return nn(e,t,n,"weekdaysShort")},p.normalizeUnits=_,p.relativeTimeRounding=function(e){return void 0===e?hn:"function"==typeof e&&(hn=e,!0)},p.relativeTimeThreshold=function(e,t){return void 0!==F[e]&&(void 0===t?F[e]:(F[e]=t,"s"===e&&(F.ss=t-1),!0))},p.calendarFormat=function(e,t){e=e.diff(t,"days",!0);return e<-6?"sameElse":e<-1?"lastWeek":e<0?"lastDay":e<1?"sameDay":e<2?"nextDay":e<7?"nextWeek":"sameElse"},p.prototype=o,p.HTML5_FMT={DATETIME_LOCAL:"YYYY-MM-DDTHH:mm",DATETIME_LOCAL_SECONDS:"YYYY-MM-DDTHH:mm:ss",DATETIME_LOCAL_MS:"YYYY-MM-DDTHH:mm:ss.SSS",DATE:"YYYY-MM-DD",TIME:"HH:mm",TIME_SECONDS:"HH:mm:ss",TIME_MS:"HH:mm:ss.SSS",WEEK:"YYYY-[W]WW",MONTH:"YYYY-MM"},p}),define("Modules/Toolset/Tools/FinancialData",["underscore","jquery","Backbone","Modules/Mutators/Mutator","Moment"],function(i,e,t,n,o){function r(e){var t;return i.isNu(e)?e:(t=e.replace(f,""),i.isFinite(t=+t)&&!i.isNaN(t)||(e.isnt("--")&&e.isnt("-")&&announceWarnCode("mkfrji2",t),t=0),t)}var s,a="text",l="numeric",u="double_numeric",c="short_numeric",d="percent",h="timestamp",p="timestamp_str",f=new RegExp("[+%".concat(",","]"),"g"),m=/^\d\d:\d\d$/,_=["","K","M","B","T"],g={k:3,m:6,b:9,t:12},v=(_defineProperty(s={},"enum",/^\d+$/),_defineProperty(s,h,/^\d{1,13}$/),_defineProperty(s,p,/^\d\d\/\d\d\/\d\d|\d\d:\d\d$/),_defineProperty(s,a,/^[^]+$/),_defineProperty(s,l,new RegExp("^[+\\-]?\\d{1,3}(".concat(",","?(\\d{3}))*(\\.\\d+)?$"))),_defineProperty(s,u,/^(-?[\d\.]+)\s\([\d\.]+%\)$/),_defineProperty(s,c,new RegExp("^(-?[\\d\\.]+)([KMBT]?)$","i")),_defineProperty(s,d,/^[\+\-]?\d{1,3}(,\d{3})*(\.\d+)?%$/),s),b=(_defineProperty(s={},"enum",function(e){return""===e?"":+e}),_defineProperty(s,h,function(e){return e}),_defineProperty(s,p,function(e){return+o(e,m.exec(e)?"HH:mm":"MM/DD/YY")}),_defineProperty(s,a,function(e){return e.trim()}),_defineProperty(s,l,r),_defineProperty(s,u,function(e){return e.is("-")?0:+v[u].exec(e)[1]}),_defineProperty(s,c,function(e){var t;return e.is("-")?0:(t=(e=_slicedToArray(v[c].exec(e)||[],3))[1],e=e[2],r(t)*Math.pow(10,g[i.toLowerCase(e)]||0))}),_defineProperty(s,d,r),s);return n.mutate(i,[["getRawValue",r],["formatNumber",function(e){var e=""+e,t=e[0].is("-"),e=e.substr(+t).split("."),n=e[0].length%3,i=e[1]?"."+e[1]:"";return(t?"-":"")+e[0].split("").map(function(e,t){return(!(t%3-n)&&n+t?",":"")+e}).join("")+i}],["formatToBigNumber",function(e){var t=Math.max(0,Math.floor(Math.log10(Math.abs(e)))),t=Math.min(4,Math.floor(t/3)),t=(e/Math.pow(10,3*t)).toFixed(2)+_[t];return e?t:"0"}]],"Late Underscore Mutation"),t.Model.extend({initialize:function(){},is:function(e,t){return v[e]||throwError("Financial Data Invalid Type",e),!t||"-"===t||!!v[e].exec(t)},getValue:function(e,t){return b[e](t)},getAnyRawValue:function(t){var n=this,e=[c,d,u,l,a];return i.isNu(t)?t:!t||t.is(["-","--"])?0:(e=i.findFirst(e,function(e){return n.is(e,t)}),this.getValue(e,t))}})}),define("Modules/Toolset/Tools/EarlyListener",["underscore","jquery","Backbone"],function(e,t,n){return n.Model.extend({initialize:function(){this._storedClicks=window.iuefhlwifguhnliw,t(function(){return setTimeout(function(){document.removeEventListener("click",window.iuefhlwifguhnliw.fuuoef),delete window.iuefhlwifguhnliw},2500)})},wasElementClicked:function(t){return!!e.find(this._storedClicks,function(e){return e===t[0]||t.isParentOf(e)})}})}),define("Modules/Toolset/Tools/texts",["underscore","jquery","Backbone"],function(e,t,n,i,o){return n.Model.extend({initialize:function(){},capitalizeWord:function(e){return e.substr(0,1).toUpperCase()+e.substr(1)},capitalizeWords:function(e){return e.split(" ").map(this.capitalizeWord).join(" ")}})}),define("Modules/Toolset/Tools/is",["underscore","jquery","Backbone"],function(t,e,n,i,o){return n.Model.extend({initialize:function(){},St:function(e){return t.isString(e)},Fu:function(e){return t.isFunction(e)},Arr:function(e){return e&&e.constructor===Array}})}),define("Modules/Toolset/Tools/DeepMap",[],function(){return function(e){function s(e){return[].concat(e)}this.dataMap=function t(){var n=new Map(e);return n.initOn=function(e){n.set(e,t())},n}(),this.get=function(e){try{return t=this.dataMap,s(e).reduce(function(e,t){return e.get(t)},t)}catch(e){}var t},this.set=function(e,n){var i,o=(e=s(e)).length-1,r=this.dataMap;return e.forEach(function(e,t){i=r.get(e),t===o?r.set(e,n):(i&&i.constructor===Map||(r.initOn(e),i&&console.warn("Existing value overridden by deeper maps",i)),r=r.get(e))}),i}}}),define("Modules/Toolset/Tools/Export",["underscore","jquery","Backbone"],function(r,o,e){var s=o(document.body),a="print-mode",l=function(){return s.css("cursor","wait")&&{then:function(e){return setTimeout(e,60)}}},u=function(){return s.css("cursor","")};return HTMLCanvasElement.prototype.toBlob||Object.defineProperty(HTMLCanvasElement.prototype,"toBlob",{value:function(o,r,s){var a=this;setTimeout(function(){for(var e=atob(a.toDataURL(r,s).split(",")[1]),t=e.length,n=new Uint8Array(t),i=0;i<t;i++)n[i]=e.charCodeAt(i);o(new Blob([n],{type:r||"image/png"}))})}}),e.Model.extend({_filename:null,initialize:function(){},downloadTableAsImage:function(e,t){var n=this,i=this._getTableContentClone(e,t),o=i.mF(".js-table");this._setFileName(),e.after(i),l().then(function(){o.aCl(a),n._downloadElementAsImage(i,n._filename,i).then(function(){return o.rCl(a)}).then(function(){return u()})})},elementToImagedCanvas:function(e){return window.html2canvas(e.get(0))},downloadArrayAsCSV:function(e){this._setFileName(),e.unshift(o(".js-main-title").textT(),""),this.downloadCSV(e.join("\n"),"".concat(this._filename,".csv"))},arrayToCSV:function(e){var i,t,o=this;return e&&e.length?(i=new r.StringAccumulator,t=Object.keys(e[0]),i.concat(t.join(",")+"\n"),e.forEach(function(n){t.forEach(function(e,t){return i.concat((t?",":"")+n[e])&&o._processValue(n,e)}),i.concat("\n")}),i.get()):null},downloadCSV:function(e,t){var n;e.match(/^data:text\/csv/i)||(n="data:text/csv;charset=utf-8,"+e),(e=document.createElement("a")).setAttribute("href",encodeURI(n)),e.setAttribute("download",t),e.click()},_setFileName:function(){this._filename=/^[\s\r\n]*([^]*)[\s\r\n]*$/.exec(o("h1.js-main-title").textT())[1].trim()},_downloadElementAsImage:function(i,o,r){var e=this;return new Promise(function(n){e.elementToImagedCanvas(i._show()).then(function(e){r&&i.remove();var t=document.createElement("a");t.download=o,t.href=e.toDataURL("image/png;base64"),document.createEvent?((e=document.createEvent("MouseEvents")).initMouseEvent("click",!0,!0,window,0,0,0,0,0,!1,!1,!1,!1,0,null),t.dispatchEvent(e)):t.fireEvent&&t.fireEvent("onclick"),n()}).catch(function(e){return lcl("Image Export Exception","(Was element in DOM?)",e)})})},_processValue:function(e,t){r.isNu(e[t])&&isNaN(e[t])&&announceWarn("Export CSV","Writing NaN value",e,t)},_getTableContentClone:function(e,t){var e=e.clone().hideEl().kickOffView().width(e.outerWidth()),n=e.mF(".js-table-wrapper, .js-calendar-table-wrapper"),i=s.f(".js-main-title-wrapper").clone();return e.f(".js-bulk-panel, .js-link-section, .js-forecast-box, .js-table-controls, .js-toggled-wrapper").remove(),e.prepend(i,o("<br><br>")),t&&r.e$(n,function(e){var t=e.mF(".js-table>tbody>tr").unmark(),n=r.size(t);r.e$(t,function(e){var t=e.f(".js-row-mark-checkbox");t.exists()&&t.isChecked()||(e.remove(),n--)}),n||e.remove()}),t||n.f(".js-table>tbody>tr").unmark(),e}})}),define("Modules/Toolset/Tools/Hashes",[],function(){function r(e,t){var n=s(e[0],r=e[1],o=e[2],i=e[3],t[0],7,-680876936),i=s(i,n,r,o,t[1],12,-389564586),o=s(o,i,n,r,t[2],17,606105819),r=s(r,o,i,n,t[3],22,-1044525330);n=s(n,r,o,i,t[4],7,-176418897),i=s(i,n,r,o,t[5],12,1200080426),o=s(o,i,n,r,t[6],17,-1473231341),r=s(r,o,i,n,t[7],22,-45705983),n=s(n,r,o,i,t[8],7,1770035416),i=s(i,n,r,o,t[9],12,-1958414417),o=s(o,i,n,r,t[10],17,-42063),r=s(r,o,i,n,t[11],22,-1990404162),n=s(n,r,o,i,t[12],7,1804603682),i=s(i,n,r,o,t[13],12,-40341101),o=s(o,i,n,r,t[14],17,-1502002290),n=l(n,r=s(r,o,i,n,t[15],22,1236535329),o,i,t[1],5,-165796510),i=l(i,n,r,o,t[6],9,-1069501632),o=l(o,i,n,r,t[11],14,643717713),r=l(r,o,i,n,t[0],20,-373897302),n=l(n,r,o,i,t[5],5,-701558691),i=l(i,n,r,o,t[10],9,38016083),o=l(o,i,n,r,t[15],14,-660478335),r=l(r,o,i,n,t[4],20,-405537848),n=l(n,r,o,i,t[9],5,568446438),i=l(i,n,r,o,t[14],9,-1019803690),o=l(o,i,n,r,t[3],14,-187363961),r=l(r,o,i,n,t[8],20,1163531501),n=l(n,r,o,i,t[13],5,-1444681467),i=l(i,n,r,o,t[2],9,-51403784),o=l(o,i,n,r,t[7],14,1735328473),n=u(n,r=l(r,o,i,n,t[12],20,-1926607734),o,i,t[5],4,-378558),i=u(i,n,r,o,t[8],11,-2022574463),o=u(o,i,n,r,t[11],16,1839030562),r=u(r,o,i,n,t[14],23,-35309556),n=u(n,r,o,i,t[1],4,-1530992060),i=u(i,n,r,o,t[4],11,1272893353),o=u(o,i,n,r,t[7],16,-155497632),r=u(r,o,i,n,t[10],23,-1094730640),n=u(n,r,o,i,t[13],4,681279174),i=u(i,n,r,o,t[0],11,-358537222),o=u(o,i,n,r,t[3],16,-722521979),r=u(r,o,i,n,t[6],23,76029189),n=u(n,r,o,i,t[9],4,-640364487),i=u(i,n,r,o,t[12],11,-421815835),o=u(o,i,n,r,t[15],16,530742520),n=c(n,r=u(r,o,i,n,t[2],23,-995338651),o,i,t[0],6,-198630844),i=c(i,n,r,o,t[7],10,1126891415),o=c(o,i,n,r,t[14],15,-1416354905),r=c(r,o,i,n,t[5],21,-57434055),n=c(n,r,o,i,t[12],6,1700485571),i=c(i,n,r,o,t[3],10,-1894986606),o=c(o,i,n,r,t[10],15,-1051523),r=c(r,o,i,n,t[1],21,-2054922799),n=c(n,r,o,i,t[8],6,1873313359),i=c(i,n,r,o,t[15],10,-30611744),o=c(o,i,n,r,t[6],15,-1560198380),r=c(r,o,i,n,t[13],21,1309151649),n=c(n,r,o,i,t[4],6,-145523070),i=c(i,n,r,o,t[11],10,-1120210379),o=c(o,i,n,r,t[2],15,718787259),r=c(r,o,i,n,t[9],21,-343485551),e[0]=d(n,e[0]),e[1]=d(r,e[1]),e[2]=d(o,e[2]),e[3]=d(i,e[3])}function a(e,t,n,i,o,r){return t=d(d(t,e),d(i,r)),d(t<<o|t>>>32-o,n)}function s(e,t,n,i,o,r,s){return a(t&n|~t&i,e,t,o,r,s)}function l(e,t,n,i,o,r,s){return a(t&i|n&~i,e,t,o,r,s)}function u(e,t,n,i,o,r,s){return a(t^n^i,e,t,o,r,s)}function c(e,t,n,i,o,r,s){return a(n^(t|~i),e,t,o,r,s)}function t(e){for(var t=e.length,n=[1732584193,-271733879,-1732584194,271733878],i=64;i<=e.length;i+=64)r(n,function(e){var t,n=[];for(t=0;t<64;t+=4)n[t>>2]=e.charCodeAt(t)+(e.charCodeAt(t+1)<<8)+(e.charCodeAt(t+2)<<16)+(e.charCodeAt(t+3)<<24);return n}(e.substring(i-64,i)));e=e.substring(i-64);var o=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0];for(i=0;i<e.length;i++)o[i>>2]|=e.charCodeAt(i)<<(i%4<<3);if(o[i>>2]|=128<<(i%4<<3),55<i)for(r(n,o),i=0;i<16;i++)o[i]=0;return o[14]=8*t,r(n,o),n}var i="0123456789abcdef".split("");function n(e){for(var t=0;t<e.length;t++)e[t]=function(e){for(var t="",n=0;n<4;n++)t+=i[e>>8*n+4&15]+i[e>>8*n&15];return t}(e[t]);return e.join("")}function e(e){return n(t(e))}function d(e,t){return e+t&4294967295}return"5d41402abc4b2a76b9719d911017c592"!==e("hello")&&0,{md5:e,simple:function(e){for(var t=5381,n=0;n<e.length;n++)t=(t<<5)+t+e.charCodeAt(n);return""+t}}}),define("Modules/Toolset/Tools/Keyboard",["underscore","jquery","Backbone"],function(e,t,n){return n.View.extend({events:{keydown:"_keyDown"},_keyMap:{enter:13,esc:27},_listenerMap:{},initialize:function(){n.View.prototype.initialize.call(this),this.$el=t(document),this.delegateEvents(null,!0)},on:function(e,t){this._listenerMap[this._keyMap[e]]||(this._listenerMap[this._keyMap[e]]=[]),this._listenerMap[this._keyMap[e]].push(t)},_keyDown:function(t){e.e(this._listenerMap[t.keyCode],function(e){return e(t)})}})}),define("External/lz-string",[],function(){var g=String.fromCharCode,n="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",i="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+-$",o={};function r(e,t){if(!o[e]){o[e]={};for(var n=0;n<e.length;n++)o[e][e.charAt(n)]=n}return o[e][t]}var s={compressToBase64:function(e){if(null==e)return"";var t=s._compress(e,6,function(e){return n.charAt(e)});switch(t.length%4){default:case 0:return t;case 1:return t+"===";case 2:return t+"==";case 3:return t+"="}},decompressFromBase64:function(t){return null==t?"":""==t?null:s._decompress(t.length,32,function(e){return r(n,t.charAt(e))})},compressToUTF16:function(e){return null==e?"":s._compress(e,15,function(e){return g(e+32)})+" "},decompressFromUTF16:function(t){return null==t?"":""==t?null:s._decompress(t.length,16384,function(e){return t.charCodeAt(e)-32})},compressToUint8Array:function(e){for(var t=s.compress(e),n=new Uint8Array(2*t.length),i=0,o=t.length;i<o;i++){var r=t.charCodeAt(i);n[2*i]=r>>>8,n[2*i+1]=r%256}return n},decompressFromUint8Array:function(e){if(null==e)return s.decompress(e);for(var t=new Array(e.length/2),n=0,i=t.length;n<i;n++)t[n]=256*e[2*n]+e[2*n+1];var o=[];return t.forEach(function(e){o.push(g(e))}),s.decompress(o.join(""))},compressToEncodedURIComponent:function(e){return null==e?"":s._compress(e,6,function(e){return i.charAt(e)})},decompressFromEncodedURIComponent:function(t){return null==t?"":""==t?null:(t=t.replace(/ /g,"+"),s._decompress(t.length,32,function(e){return r(i,t.charAt(e))}))},compress:function(e){return s._compress(e,16,function(e){return g(e)})},_compress:function(e,t,n){if(null==e)return"";for(var i,o,r,s,a={},l={},u="",c=2,d=3,h=2,p=[],f=0,m=0,_=0;_<e.length;_+=1)if(r=e.charAt(_),Object.prototype.hasOwnProperty.call(a,r)||(a[r]=d++,l[r]=!0),s=u+r,Object.prototype.hasOwnProperty.call(a,s))u=s;else{if(Object.prototype.hasOwnProperty.call(l,u)){if(u.charCodeAt(0)<256){for(i=0;i<h;i++)f<<=1,m==t-1?(m=0,p.push(n(f)),f=0):m++;for(o=u.charCodeAt(0),i=0;i<8;i++)f=f<<1|1&o,m==t-1?(m=0,p.push(n(f)),f=0):m++,o>>=1}else{for(o=1,i=0;i<h;i++)f=f<<1|o,m==t-1?(m=0,p.push(n(f)),f=0):m++,o=0;for(o=u.charCodeAt(0),i=0;i<16;i++)f=f<<1|1&o,m==t-1?(m=0,p.push(n(f)),f=0):m++,o>>=1}0==--c&&(c=Math.pow(2,h),h++),delete l[u]}else for(o=a[u],i=0;i<h;i++)f=f<<1|1&o,m==t-1?(m=0,p.push(n(f)),f=0):m++,o>>=1;0==--c&&(c=Math.pow(2,h),h++),a[s]=d++,u=String(r)}if(""!==u){if(Object.prototype.hasOwnProperty.call(l,u)){if(u.charCodeAt(0)<256){for(i=0;i<h;i++)f<<=1,m==t-1?(m=0,p.push(n(f)),f=0):m++;for(o=u.charCodeAt(0),i=0;i<8;i++)f=f<<1|1&o,m==t-1?(m=0,p.push(n(f)),f=0):m++,o>>=1}else{for(o=1,i=0;i<h;i++)f=f<<1|o,m==t-1?(m=0,p.push(n(f)),f=0):m++,o=0;for(o=u.charCodeAt(0),i=0;i<16;i++)f=f<<1|1&o,m==t-1?(m=0,p.push(n(f)),f=0):m++,o>>=1}0==--c&&(c=Math.pow(2,h),h++),delete l[u]}else for(o=a[u],i=0;i<h;i++)f=f<<1|1&o,m==t-1?(m=0,p.push(n(f)),f=0):m++,o>>=1;0==--c&&(c=Math.pow(2,h),h++)}for(o=2,i=0;i<h;i++)f=f<<1|1&o,m==t-1?(m=0,p.push(n(f)),f=0):m++,o>>=1;for(;;){if(f<<=1,m==t-1){p.push(n(f));break}m++}return p.join("")},decompress:function(t){return null==t?"":""==t?null:s._decompress(t.length,32768,function(e){return t.charCodeAt(e)})},_decompress:function(e,t,n){for(var i,o,r,s,a,l,u=[],c=4,d=4,h=3,p="",f=[],m={val:n(0),position:t,index:1},_=0;_<3;_+=1)u[_]=_;for(o=0,s=Math.pow(2,2),a=1;a!=s;)r=m.val&m.position,m.position>>=1,0==m.position&&(m.position=t,m.val=n(m.index++)),o|=(0<r?1:0)*a,a<<=1;switch(o){case 0:for(o=0,s=Math.pow(2,8),a=1;a!=s;)r=m.val&m.position,m.position>>=1,0==m.position&&(m.position=t,m.val=n(m.index++)),o|=(0<r?1:0)*a,a<<=1;l=g(o);break;case 1:for(o=0,s=Math.pow(2,16),a=1;a!=s;)r=m.val&m.position,m.position>>=1,0==m.position&&(m.position=t,m.val=n(m.index++)),o|=(0<r?1:0)*a,a<<=1;l=g(o);break;case 2:return""}for(i=u[3]=l,f.push(l);;){if(m.index>e)return"";for(o=0,s=Math.pow(2,h),a=1;a!=s;)r=m.val&m.position,m.position>>=1,0==m.position&&(m.position=t,m.val=n(m.index++)),o|=(0<r?1:0)*a,a<<=1;switch(l=o){case 0:for(o=0,s=Math.pow(2,8),a=1;a!=s;)r=m.val&m.position,m.position>>=1,0==m.position&&(m.position=t,m.val=n(m.index++)),o|=(0<r?1:0)*a,a<<=1;u[d++]=g(o),l=d-1,c--;break;case 1:for(o=0,s=Math.pow(2,16),a=1;a!=s;)r=m.val&m.position,m.position>>=1,0==m.position&&(m.position=t,m.val=n(m.index++)),o|=(0<r?1:0)*a,a<<=1;u[d++]=g(o),l=d-1,c--;break;case 2:return f.join("")}if(0==c&&(c=Math.pow(2,h),h++),u[l])p=u[l];else{if(l!==d)return null;p=i+i.charAt(0)}f.push(p),u[d++]=i+p.charAt(0),i=p,0==--c&&(c=Math.pow(2,h),h++)}}};return s}),define("Modules/Toolset/Tools/ClientStorage",["underscore","jquery","Backbone","External/lz-string"],function(a,e,t,l){var u="clientExpiration",n="wipeVersion",i="_p_2_p_";return t.Model.extend({_cache:null,_withPrints:null,_expirations:{},_useCompression:null,initialize:function(){this._useCompression=1,this._withPrints=!1,this._cache=this.getObj("_l_c_")||{},this._expirations=this.cache(u)||{},this._wipeVersion=this.cache(n)||0,this._wipeVersion<7&&(this.clearAll(),this.cache(n,7))},setVal:function(e,t,o,r){var s=this;return a.e(a.isOb(e)?e:_defineProperty({},e,t),function(e,t){var e=""+e,n=e,i=""+t;r&&(s._expirations[t]=Date.now()+r,s.cache(u,s._expirations)),s._useCompression&&!o&&(n=l.compressToUTF16(e),s._withPrints&&lcl("Compression Stats\nBefore: ".concat(e.length,"\nAfter: ").concat(n.length,"\nRatio: ").concat(+(n.length/e.length).toFixed(8)))),localStorage.setItem(i,n)}),this},getVal:function(e,t){return this._expirations[e]&&this._expirations[e]<Date.now()?(this.clearVal(e),null):(e=localStorage.getItem(e),t?e:this._decompress(e))},clearVal:function(e){localStorage.removeItem(e)},setObj:function(e,t,n,i){return this.setVal(e,JSON.stringify(t),n,i),this},getObj:function(e,t){return this._unpack(this.getVal(e,t))},onStorage:function(n,i){function o(e,t){e(r._unpack(r._decompress(t)))}var r=this;e(window).on("storage",a.isFu(i)?function(e){var t=e.originalEvent.newValue;e.originalEvent.key===n&&t&&o(i,t)}:function(e){var t=e.originalEvent.key,e=e.originalEvent.newValue;e&&o(n,t)})},triggerStorage:function(e,t){var n=this;this.setObj(e,t),setTimeout(function(){return n.clearVal(e)},66.6)},clearAll:function(){localStorage.clear(),this._cache={},this._expirations={}},P2P:function(e){return a.isUn(e)?this.getObj(i):this.setObj(i,e)},cache:function(e,t){if(!a.isntUn(t))return this._cache[e];this._cache[e]=t,this.setObj("_l_c_",this._cache)},addToP2P:function(e,t){var n=this.P2P();a.extend(n.portfolios,_defineProperty({},e,t)),this.P2P(n)},addPairToP2P:function(e,t){var n=this.P2P();n.portfolios[e].pairIds.push(t),this.P2P(n)},isPairInPortfolio:function(e,t){return a.isIn(this.P2P().portfolios[e].pairIds,t)},isPairInPortfolios:function(t){return a.any(this.P2P().portfolios,function(e){return a.isIn(e.pairIds,t)})},removePairFromP2P:function(e,t){var n=this.P2P(),e=n.portfolios[e].pairIds;e.splice(e.indexOf(t),1),this.P2P(n)},_decompress:function(e){return this._useCompression&&e?l.decompressFromUTF16(e):e},_unpack:function(e){return JSON.parse(e||null)}})}),define("Modules/Toolset/Tools/UserStorage",["underscore","jquery","Backbone"],function(n,e,t){return t.Model.extend({_userId:null,_userStorageObj:null,_clientStorage:null,initialize:function(e){t.Model.prototype.initialize.call(this),this._clientStorage=e,this._userStorageObj=this._clientStorage.getObj("_u_s_")||{},this._userId=this._clientStorage.cache("userId")||0},getUserId:function(){return this._userId},setObj:function(e,t){return n.isntUn(this._userStorageObj[this._userId])?this._userStorageObj[this._userId][e]=t:this._userStorageObj[this._userId]=_defineProperty({},e,t),this._clientStorage.setObj("_u_s_",this._userStorageObj),this},getObj:function(e){var t=this._userStorageObj[this._userId];return t&&t[e]}})}),define("Modules/Toolset/Tools/Dates",["underscore","jquery","Backbone","Moment"],function(e,t,n,i){return n.Model.extend({initialize:function(){},getTimeElapsed:function(e){return i.unix(e).fromNow()},getFutureTime:function(e){return i.unix(e).toNow()},_makeSimpleDate:function(e){return i(e).format("HH:mm:ss MM/DD/YYYY")}})}),define("Toolset",["underscore","jquery","Backbone","Modules/Toolset/Tools/math","Modules/Toolset/Tools/FinancialData","Modules/Toolset/Tools/EarlyListener","Modules/Toolset/Tools/texts","Modules/Toolset/Tools/is","Modules/Toolset/Tools/DeepMap","Modules/Toolset/Tools/Export","Modules/Toolset/Tools/Hashes","Modules/Toolset/Tools/Keyboard","Modules/Toolset/Tools/ClientStorage","Modules/Toolset/Tools/UserStorage","Modules/Toolset/Tools/Dates","External/lz-string"],function(e,t,n,i,o,r,s,a,l,u,c,d,h,p,f,m){var _=t(document.body),t=new h,h=n.Model.extend({UserStorage:new p(t),Export:new u,Math:new i,FinancialData:new o,EarlyListener:new r,Texts:new s,is:new a,Keyboard:new d,ClientStorage:t,Dates:new f,DeepMap:l,Hashes:c,LZString:m,Helpers:{generateRandomString:function(e){return Math.random().toString(36).substring(e?13-e:2)},free:function(){return _.css("cursor","")}}});return window.lz=m,new h}),window.lcl=function(){},window.lcl.makeCustom=function(){return function(){return 0}},window.lcl=function(){for(var e,t=arguments.length,n=new Array(t),i=0;i<t;i++)n[i]=arguments[i];window.lcl.flag?(window.lcl.customFlags.printTime&&n.unshift(window.getTimeFromStart()),(e=console).log.apply(e,n),(e=window.lcl).customCL.apply(e,n)):window.lcl.initialized||window.lcl.earlyPrints.push([].concat(n,["(Early)"]))},window.lcl.customCL=function(){return 1},window.lcl.earlyPrints=[],window.lcl.customFlags=!1,window.lcl.makeCustom=function(i){return function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return window.lcl.customFlags?window.lcl.customFlags[i]&&lcl.apply(void 0,["".concat(i," -")].concat(t)):window.lcl.earlyPrints.push([].concat(t,["(Early ".concat(i,")")]))}},define("Modules/Mutators/BackboneMutator",["underscore","jquery","Backbone","Toolset"],function(r,e,i,o){function t(){return null}var s="persistentClientStorage",a=o.ClientStorage.getObj(s)||{},n=lcl.makeCustom("BackboneMutator"),l=/^(\?)?(@)?((\w+)(\s(.*))?)$/,u={onMultiple:function(e){var n=this;return r.e(e,function(e,t){return n.on(t,e)}),this},offMultiple:function(e){var n=this;return r.e(e,function(e,t){return n.off(t,e)}),this},offArray:function(e){var t=this;r.e(e,function(e){return t.off(e)})},triggerMultiple:function(e){var n=this;r.e(e,function(e,t){return n.trigger.apply(n,[t].concat(_toConsumableArray(e)))})}},c={config:function(e,t){return r.isntUn(t)&&(this.config[e]=t),this.config[e]},answerMultiple:function(e){var n=this;r.e(e,function(e,t){return n.answer(t,e)})},answer:function(e,t){this._questionsToAnswer||(this._questionsToAnswer={}),this._questionsToAnswer[e]&&throwError("Duplicate Answer binding",e,this),this._questionsToAnswer[e]=t},ask:function(e){var t;this._questionsToAnswer&&r.isFu(this._questionsToAnswer[e])||throwError("Question Asked but no answer bound",e,this);for(var n=arguments.length,i=new Array(1<n?n-1:0),o=1;o<n;o++)i[o-1]=arguments[o];return(t=this._questionsToAnswer)[e].apply(t,i)},unbindAnswer:function(e){return this._questionsToAnswer&&(e?delete this._questionsToAnswer[e]:delete this._questionsToAnswer),this},bindReplications:function(e,n){var i=this;r.e([].concat(e),function(t){o.ClientStorage.onStorage(i._getModuleNamePrefix()+t,function(e){i._skipReplication=!0,n&&n.apply(void 0,_toConsumableArray(e)),i[t].apply(i,_toConsumableArray(e)),i._skipReplication=!1})})},replicate:function(e){for(var t=arguments.length,n=new Array(1<t?t-1:0),i=1;i<t;i++)n[i-1]=arguments[i];this._skipReplication||o.ClientStorage.triggerStorage(this._getModuleNamePrefix()+e,n)},delegateBubbling:function(){var n=this;r.e(this._bubbleEvents,function(e,t){return r.e(r.array(e),function(e){return n.listenTo(n[t],e,n.trigger.bind(n,e))})})},setToObjects:function(){for(var t=this,e=arguments.length,n=new Array(e),i=0;i<e;i++)n[i]=arguments[i];r.e(n,function(e){return t[e]={}})},setToArrays:function(){for(var t=this,e=arguments.length,n=new Array(e),i=0;i<e;i++)n[i]=arguments[i];r.e(n,function(e){return t[e]=[]})},_getModuleNamePrefix:function(){return this._moduleName?this._moduleName+"_":""},storage:{get:function(e,t){return o.ClientStorage.getVal(e,t)},set:function(e,t,n,i){return o.ClientStorage.setVal(e,t,n,i)}},persistentPropSet:function(e,t){var n=this;r.e(r.isOb(e)?e:_defineProperty({},e,t),function(e,t){n[t]=e,a[t]=e,o.ClientStorage.setObj(s,a)})},loadPersistentProps:function(e){var t=this;r.e(e,function(e){return t[e]=a[e]})},loadSettings:function(e){var t=this;this._settings={},r.isAr(e)?r.e(e,function(e){return t._settings[e]=!0}):this._settings=e},isSettingOn:function(e){return this._settings[e]},isSettingOff:function(e){return!this._settings[e]}},d={reorder:function(e,t){return r.swap(this.models,e,t),this},destroy:function(){return r.e(this.models,function(e){return e.destroy()}),this},e:i.Collection.prototype.each},h={sync:t,fetch:t,save:t,initIfWhenDOMReady:function(e,t){window.jf9e8uhjfu8[e]?(t(window.jf9e8uhjfu8[e]),delete window.jf9e8uhjfu8[e]):(n(e,"DOM wasn't ready, loading postponed"),window.jf9e8uhjfu8[e]=t)}};i.EView=i.View.extend(r.extend({},u,c,{initialize:function(e){this.$el=e},unbindDOMEvents:function(){var t=this;this.$el.off();for(var e=arguments.length,n=new Array(e),i=0;i<e;i++)n[i]=arguments[i];r.e(n,function(e){return t._dom[e].off()})},delegateEvents:function(e,t){var a=this,n=r.extend({},this.events);return t&&(this.debouncedEvents&&r.e(this.debouncedEvents,function(e,t){var e=_slicedToArray(e,3),n=e[0],i=e[1],e=e[2],o=n+"_debounced_";a[o]=r.debounce(a[n],i,e),a.events[t]=o}),this.events&&r.e(this.events,function(e,t){var n=_slicedToArray(l.exec(t),7),i=n[1],o=n[2],r=n[3],s=n[4],n=n[6];n&&(!i&&a.$el[0].innerHTML.trim()&&a.$el.f(n).isEmpty()&&throwError("Event binding on non-existent non-optional selector: '".concat(n,"'"),a),o&&(a.$el[i?"f":"mF"](n).on(s,a[e].bind(a)),delete a.events[t]),"#"===e[0]&&(a.$el[i?"f":"mF"](n).on(s,a.trigger.bind(a,e.substr(1))),delete a.events[t])),i&&(a.events[r]=e,delete a.events[t])})),t=i.View.prototype.delegateEvents.call(this,e),this.events=n,t}})),i.EModel=i.Model.extend(r.extend({},u,c,h)),i.ECollection=i.Collection.extend(r.extend({},u,d))}),define("app/main",["Modules/Mutators/GeneralMutator","Modules/Mutators/UnderscoreMutator","Modules/Mutators/jQueryMutator","Modules/Mutators/BackboneMutator"],function(){requirejs(["app/Investing"],function(e){return e.init()})}),define("Displayable",["underscore","jquery","Backbone"],function(t,n,e){return e.EView.extend({_dom:null,_markupTemplate:null,_skipReplication:!1,initialize:function(e){this.$el=n(e),this.$el.isEmpty()&&throwError("Initialized $el not found",e)},render:function(e,t){return t&&this.$el.html(t),this.delegateEvents(null,!0),this._dom={},this._cacheDom(this._markupScheme||e),this.$el},addToDOM:function(e,t){if(t.exists())return this._dom[e]=t,!0},_refetchDom:function(e){this._cacheDom(t.keep.apply(t,[this._markupScheme].concat(_toConsumableArray(e))))},_cacheDom:function(){var o=this;t.e(0<arguments.length&&void 0!==arguments[0]?arguments[0]:{},function(e,t){var n=_slicedToArray(/^(\?)?(.*)$/.exec(t),3),i=n[1],n=n[2];o._dom[n]=o.$el.find(e),o._dom[n].exists()||i||throwError("Cache DOM (Markup Scheme) - Element Not Found",t,e)})}})}),define("EventBus",["underscore","jquery","Backbone"],function(e,t,n){var i=1,o=lcl.makeCustom("EventBus"),r={},n=new(n.EModel.extend({onceAttachedToDOM:function(e,t){r[i++]={$elemToMonitor:e,cb:t}}}));return n.on("mainFrameInsertion",function(n){e.each(r,function(e,t){!e.$elemToMonitor.isChildOf(n)&&e.$elemToMonitor!==n||(e.cb.forEach?e.cb.forEach(function(e){return e()}):e.cb(),delete r[t])})}),n.on("all",function(e){for(var t=arguments.length,n=new Array(1<t?t-1:0),i=1;i<t;i++)n[i-1]=arguments[i];return o("EventBus Event Triggered:",e,n)}),n}),define("Modules/ControlPanel/FunctionalElementView",["underscore","jquery","Backbone","Toolset","Displayable"],function(l,u,e,n,t){var i="functionalElements";function c(e){return l.isUn(e.originalEvent.clientY)?l.seekInObj(e,"originalEvent.touches.0.clientY"):e.originalEvent.clientY}return t.extend({_state:null,_settings:null,_markupScheme:{},initialize:function(e){t.prototype.initialize.call(this,e.$element),this._state={},this._settings=e,this._settings.lsKey&&(this._loadState(),this._applyState()),e.resize&&this._initializeResizablity()},_applyState:function(){var n=this;l.e(this._state[this._settings.lsKey],function(e,t){n.$el[t](e)})},_loadState:function(){this._state=n.ClientStorage.getObj(i)||{},this._applyState()},_writeValueToState:function(e,t){this._settings.lsKey&&(this._loadState(),this._state[this._settings.lsKey]||(this._state[this._settings.lsKey]={}),this._state[this._settings.lsKey][e]=t,n.ClientStorage.setObj(i,this._state))},_initializeResizablity:function(){function e(){o=s,n._writeValueToState("height",s),u(document.body).rCl("lock-screen-touch-scroll")}var t,n=this,i=this._settings.resize,o=this.$el.height(),r=i.boundaries?i.boundaries.height:null,s=o,a=0;i.$resizeBar.on("dragstart touchstart",function(e){o=n.$el.height(),t=c(e),u(document.body).aCl("lock-screen-touch-scroll")}),i.$resizeBar.on("drag touchmove",l.throttle(function(e){e=t-c(e),e=o-e;s===e||r&&!r(e)||(n.$el.height(e),s=e)},16)),i.$resizeBar.on("dragend touchend",e),i.$resizeBar.on("click",function(){s=s?(a=s,0):a,n.$el.height(s),e()})}})}),define("Modules/ControlPanel/ControlPanelView",["underscore","jquery","Backbone","Displayable","EventBus","Toolset","./FunctionalElementView"],function(o,r,e,t,n,i,s){function a(){if(localStorage&&!localStorage.getItem("lsLimit")){var t=0;try{for(t=250;t<=1e4;t+=250)localStorage.setItem("test",new Array(1024*t+1).join("_"))}catch(e){localStorage.removeItem("test"),d=t-250,localStorage.setItem("lsLimit",d)}}}var l={},u=!!~["1","ᆨ "].indexOf(i.ClientStorage.getVal("consolePrints",!0)),c=i.ClientStorage.getObj("consolePrintsFlags")||{},d=localStorage.getItem("lsLimit");return d||r(function(){return setTimeout(a,200)}),t.extend({_settings:null,_markupScheme:{"?cpButton":"button.console-prints","?customConsole":".custom-console","?debugDelayInput":".debug-delay-input","?debugDelayButton":".debug-delay","?featureSelectionDialog":".feature-selection","?featureSelectionCheckboxes":".feature-selection input[type=checkbox]","?settingGroups":"[setting-group]","?debugDelayStop":".debug-delay-stop","?controlPanelPopup":".js-control-panel-popup","?popupCloser":".js-closer","?popupCancel":".js-cancel-button","?popupApply":".js-apply-button"},events:{"?click .console-prints":"_toggleConsolePrints","?click .clear-console":"_clearCustomConsole","?click .clear-template-cache":"_clearTemplateCache","?click .console-entry":"_toggleEntry","?click .append-more-rows-button2":"_append1k","?click .login":"_loginFromUI","?click .debug-delay":"_debugDelay","?click .select-features":"_featureSelection"},_controlPanelPopupInstance:null,initialize:function(){t.prototype.initialize.call(this,r("<div/>")),this._settings=i.ClientStorage.getObj("controlPanelSettings")||l,window.turnOnConsolePrints=this._toggleConsolePrints.bind(this),window.clearTemplateCache=window.templateCacheClear=this._clearTemplateCache.bind(this),window.printStorageStats=function(){var e,t,n=0,i=[];for(t in localStorage)localStorage.hasOwnProperty(t)&&(n+=e=2*(localStorage[t].length+t.length)/1024,i.push({name:t,size:e}));i.sort(function(e,t){return e.size-t.size}),o.e(i,function(e){var t=e.name,e=e.size;return lcl(t,"-",e.toFixed(2)+"KB")}),lcl("Total - ".concat(n.toFixed(2),"/").concat(d,"KB"))}},render:function(){return t.prototype.render.call(this),this._applyConsolePrintsState(!0),this._initLCL(),this.$el},initConsoleResize:function(){new s({lsKey:"controlPanel",$element:this.$el,resize:{$resizeBar:this.$el.f(".toolset-resize-area"),boundaries:{height:function(e){return 0<e&&e<400}}}})},_initCustomCL:function(){var o=this;window.lcl.customCL=function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];var i=t.join(" | ");o._dom.customConsole.prepend(r("<div/>").setup({addClass:"console-entry closed",text:i,attr:["title",i]}))}},_clearCustomConsole:function(){this._dom.customConsole.empty()},_toggleEntry:function(e){r(e.target).toggleClass("closed")},_toggleConsolePrints:function(){u=!u,console.log("Console Prints are ".concat(u?"On":"Off")),this._applyConsolePrintsState()},_initLCL:function(){window.lcl.initialized=!0,window.lcl.customFlags=c,window.lcl.sys=this.popSystemAlert.bind(this),window.lcl.printFlags=function(){o.e(window.lcl.customFlags,function(e,t){return lcl(t,!!e)})},window.lcl.toggleCustom=function(e){return window.lcl.customFlags[e]^=1,i.ClientStorage.setObj("consolePrintsFlags",window.lcl.customFlags),"Prints for ".concat(e," are ").concat(window.lcl.customFlags[e]?"on":"off")},o.e(window.lcl.earlyPrints,function(e){return lcl.apply(void 0,_toConsumableArray(e))})},_applyConsolePrintsState:function(e){e||i.ClientStorage.setVal("consolePrints",+u),window.lcl.flag=u},_clearTemplateCache:function(){i.ClientStorage.clearVal("templates"),i.ClientStorage.clearVal("TemplateMap"),i.ClientStorage.clearVal("lastTemplateVersion"),n.trigger("dropTemplatesEv"),lcl("Templates Cleared from LS")},_append1k:function(){n.trigger("append1k")},_loginFromUI:function(){n.trigger("loginFromUI")},_featureSelection:function(e){this._applySettingsToCheckboxes(),this._controlPanelPopupInstance=this.firePopup(this._dom.controlPanelPopup,{isModal:!0}),e.stopPropagation()},_initPopupActions:function(){var e=this;this._dom.popupCloser.add(this._dom.popupCancel).on("click",function(){return e._controlPanelPopupInstance.hidePopup()}),this._dom.popupApply.on("click",function(){e._applyCheckboxesToSettings(),e._controlPanelPopupInstance.hidePopup()})},_applySettingsToCheckboxes:function(){var t=this;this._dom.featureSelectionCheckboxes.uncheck(),o.e(this._dom.featureSelectionCheckboxes,function(e){e=r(e);e.toggleCheck(t._settings[e.data("featureName")])})},_applyCheckboxesToSettings:function(){var t=this;o.e(this._dom.featureSelectionCheckboxes,function(e){e=r(e);t._settings[e.data("featureName")]=e.isChecked()}),i.ClientStorage.setObj("controlPanelSettings",this._settings),this._applySettings()},_applySettings:function(){var t=this;o.e(this._dom.settingGroups,function(e){e=r(e);e._toggleShow(t._settings[e.attr("setting-group")])})},_debugDelay:function(){var e=this,t=this._dom.debugDelayInput.val(),n=parseInt(t)||500,i=1,o=setInterval(function(){e._dom.debugDelayInput.val(n-25*i++)},25),r=setTimeout(function(){clearInterval(o),e._dom.debugDelayStop._hide(),e._dom.debugDelayButton._show(),e._dom.debugDelayInput.val(t)},n);this._dom.debugDelayButton._hide(),this._dom.debugDelayStop._show().off("click.stop").on("click.stop",function(){clearInterval(o),clearTimeout(r),e._dom.debugDelayInput.val(t),e._dom.debugDelayButton._show(),e._dom.debugDelayStop._hide()})}})}),define("DataChest",["underscore","jquery","Backbone"],function(i,e,t){var n={},o={};return new(t.EModel.extend({_localClientData:null,_clientData:null,_translations:null,initialize:function(){var e=this;this._localClientData={},this._clientData=window.AudioParamMapReferrer,this._translations=this._clientData.locale||{},delete window.AudioParamMapReferrer,this.reloadTableInstruments(),this.config.isProduction||(window.printClientData=function(){return e._clientData})},setClientData:function(e,t){this._localClientData[e]=t},getClientData:function(e){return this._localClientData[e]},setData:function(e){this._clientData=JSON.parse(e),this.reloadTableInstruments()},get:function(e){return this._clientData[e]},reloadTableInstruments:function(){this._clientData.quoteTableData&&this.loadInstrumentData(this._clientData.quoteTableData)},clearData:function(e){delete this._localClientData[e]},setServerDataByKey:function(e,t){this._clientData[e]=t},getTranslation:function(e){return this._translations[e]||(announceWarn("Missing Translation (".concat(e,")")),"")},isLogged:function(){return i.isntE(this._clientData.user)},loadInstrumentData:function(e){i.e(i.array(e),function(e){return n[e.pId]=e})},getInstrumentData:function(e){return n[e]||{}},getInstrumentsData:function(e,t){var n=this;return i.clean(i.map(i.array(e),function(e){e=n.getInstrumentData(e)[t];return"type"===t&&o[e]||e}))}}))}),define("ActionQueue",["underscore","jquery","Backbone","Toolset","EventBus"],function(e,t,n,i,o){return new(n.EModel.extend({_queue:null,initialize:function(){var e=this;this._queue=i.ClientStorage.getObj("actionQueue")||[],o.on("userIsIdleEv",function(){return e.executeActions("onIdle")})},pushAction:function(e){this._queue.push(e),this._updateLS()},executeActions:function(t){var n=this;e.eFiltered(this._queue,function(e){return e.eventTrigger===t},function(e,t){o.trigger.apply(o,[e.eventName].concat(_toConsumableArray(e.eventParams||[]))),n._queue.splice(t,1)}),this._updateLS()},_updateLS:function(){i.ClientStorage.setObj("actionQueue",e.filter(this._queue,function(e){return!e.skipLS}))}}))}),define("Modules/ScrollHandler/ScrollHandler",["underscore","jquery","Backbone"],function(e,t,n){return new(n.EModel.extend({_$document:null,_navHistory:null,_scrollToTop:null,_historyHead:null,_manualRestoration:null,initialize:function(e){n.EModel.prototype.initialize.call(this,e),this._$document=t(window.document),this._navHistory=[],this._historyHead=0,"auto"===window.history.scrollRestoration&&(window.history.scrollRestoration="manual",this._manualRestoration=!0),this._createPosition()},newEntry:function(){return this._navHistory.splice(this._historyHead+1),this._addedNewEntry=!0,this},setToTopTrigger:function(e){this._scrollToTop=e},triggerIfNeeded:function(){var e;this._savePosition(),this._scrollToTop?(this._$document.scrollToTop(),this._historyHead++,this._createPosition(),this._scrollToTop=!1,this._addedNewEntry=!1):(e=window.location.href,this._addedNewEntry?(this._historyHead++,this._createPosition(),this._addedNewEntry=!1):((this._navHistory[this._historyHead-1]||{}).href===e?this._historyHead--:(this._navHistory[this._historyHead+1]||{}).href===e&&this._historyHead++,this._$document.scrollTop(this._navHistory[this._historyHead].position)))},_createPosition:function(){this._navHistory[this._historyHead]={href:window.location.href}},_savePosition:function(){this._navHistory[this._historyHead].position=this._$document.scrollTop()}}))}),define("Router",["underscore","jquery","Backbone","EventBus","DataChest","Modules/ScrollHandler/ScrollHandler"],function(o,r,t,s,e,a){lcl;var n=Date.now()+o.oneDay,l=["/portfolio/"];return new(t.EModel.extend({_router:null,_scrollToTop:null,_pendingHref:null,_travelStepsCount:null,_finishedInitialLoad:null,_localNavigationOngoing:null,initialize:function(){var e=t.Router.extend({routes:{"(/)(:tier0)(/)(:tier1)(/)(:tier2)(/)(:tier3)(/)(:tier4)(/)(:tier5)(/)(:tier6)(/)(:tier7)(/)(:tier8)(/)(:tier9)(/)":"all"},all:this._dispatchNavigation.bind(this),updateLocation:function(e){this.navigate(e,{trigger:!1,replace:!0})}});return this._router=new e,this._travelStepsCount=0,this._initEventBinding(),this},updateLocation:function(e){this._router.updateLocation(e)},_dispatchNavigation:function(){this._travelStepsCount++,this._finishedInitialLoad&&s.trigger("clientNavigationStartEv");for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];this.trigger.apply(this,["clientNavigationEv"].concat(t)),this._finishedInitialLoad=!0},navigateLocally:function(e,t){this._travelStepsCount<32&&Date.now()<n?(t&&a.setToTopTrigger(!0),this._router.navigate(e,{trigger:!0})):this.outerNavigate(e)},_initEventBinding:function(){var i=this;s.on("clientNavigationEndEv",function(){a.triggerIfNeeded(),i._pendingHref?(i.navigateLocally(i._pendingHref),i._pendingHref=""):i._localNavigationOngoing=!1,e.get("pageUri")!==window.location.pathname&&i.updateLocation(e.get("pageUri")+window.location.search)}),r(document).on("click","a[href]:not([data-outbound])",function(e){var t=r(e.currentTarget),n=t.href();o.isIn(["/","?"],n[0])&&!o.startsWith(n,l)&&(i._localNavigationOngoing?(i._pendingHref=n,setTimeout(function(){i._localNavigationOngoing&&i.outerNavigate(n)},1200)):(a.newEntry().setToTopTrigger(!t.hasData("hold-pos")),i._localNavigationOngoing=!0,i.navigateLocally(("?"===n[0]?window.location.pathname:"")+n)),e.preventDefault())})}}))}),define("Http",["underscore","jquery","Backbone","DataChest","EventBus","ActionQueue","Router"],function(g,v,e,b,y,w,S){function T(t){return g.removeByPredicate(x,function(e){e=e.label;return t===e})}function t(m){var _=1<arguments.length&&void 0!==arguments[1]?arguments[1]:{};return function(t){var n=1<arguments.length&&void 0!==arguments[1]?arguments[1]:{},s=2<arguments.length&&void 0!==arguments[2]?arguments[2]:{},a=g.isIn(_,"html"),l=_.label||"",i={},u=t+JSON.stringify(n),c=g.isIn(_,"cache"),d=g.isIn(_,"scheme"),h=(g.isIn(_,"template"),this.trigger.bind(this)),p=g.isIn(s,"silent"),f=g.isIn(_,"skipBrowserCache");return d&&(i["res-scheme"]=1),g.isIn(s,"targetUrl")&&(i["target-uri"]=s.targetUrl),g.isIn(_,"service")&&(i["is-service"]=1,i["ref-uri"]=window.location.pathname+window.location.search,i.token=F[i["ref-uri"]]||b.get("token")),new Promise(function(o,r){var e;C[t]?(e={success:!0,data:C[t]},p||j("Dummy ".concat(m," Request:"),t,e),o(e)):c&&M[u]?(p||j("CACHED ".concat(m," Request:"),t,M[u]),o(M[u])):c&&P[u]?P[u].push(o):(p||j("".concat(m," Request: ").concat(t," | ").concat(JSON.stringify(n||null))),e={url:t,data:n,type:m,headers:i,success:function(e){var t=e.data||e,n=e.payloads,i=e.clientData&&e.clientData.token;g.isIn(_,"reject")&&g.isE(e.data)&&r(),g.isntE(e.clientData)&&(b.setClientData("virtualClientData",e.clientData),e.clientData.quoteTableData&&b.loadInstrumentData(e.clientData.quoteTableData),g.e(e.clientData,function(e,t){return b.setServerDataByKey(t,e)})),a||p||j("".concat(m," Response:"),t),T(l),c&&(e=g.size(P[u]),M[u]=t,!p&&e&&j("Firing ".concat(e," stored cached call handler").concat(1<e?"s":"")),g.e(P[u],function(e){return e(t)}),delete P[u]),n&&(e=n.clientVersions,(n=n.GoogleTagManager)&&function(t){var n=1<arguments.length&&void 0!==arguments[1]?arguments[1]:{};g.e(t.clientUpdatesFields,function(e){n[D[e]]&&(n.pairIds&&g.isIn(["instrument_name","instrument_type"],e)?t[e]=b.getInstrumentsData(n.pairIds,"instrument_name"===e?"name":"type"):t[e]=n[D[e]])}),v.dispatchGTM(t)}(n,s.GTM),function(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{},t=e.LAST_TEMPLATE_UPDATE,e=e.CLIENT_SUPERVERSION;t&&A!==t&&(b.setServerDataByKey("lastTemplate",t),A=t,y.trigger("refetchTemplateMapEv")),e&&E!==e&&w.pushAction({eventTrigger:"onIdle",eventName:"reloadClientEv",skipLS:!0})}(e)),i&&s.targetUrl&&(F[s.targetUrl]=i),s.targetUrl&&s.updateLocation&&S.updateLocation(s.targetUrl),o(t)},error:function(e){k||(console.error(g.tryRun(I[e.status],e)||e),200===e.status?d?window.location.reload():announceWarn("Server Exception - 200 with Non-JSON response",t,e):(a&&404===e.status&&"/_temp"===t.substr(0,6)&&r(404),h(e.status,{url:t,data:n,error:e.responseJSON?e.responseJSON["error-massage"]:e})))},dataType:a?"html":"JSON"},c&&(P[u]=[]),f&&(e.cache=!1),x.push({label:l,cacheHash:u,ajax:v.ajax(e)}))})}}var C={},k=!1,x=[],M={},P={},A=b.get("lastTemplate"),E=b.get("lastSuperversion"),D={GA_event_action:"eventAction",GA_event_location:"triggerSource",GA_event_label_value:"eventValue",GA_event_label:"eventLabel",instrument_name:"instrumentName",instrument_type:"instrumentType"},I={500:function(e){var t=e.responseText,e=e.responseJSON;return'500 - Backend Exception: "'.concat(e&&e["error-massage"]||t,'"')}},j=lcl.makeCustom("Http"),F={},n=t("POST",["service"]);return new(e.EModel.extend({deleteService:t("DELETE",["service"]),get:t("GET"),getHtml:t("GET",["html"]),getTemplate:t("GET",["template","service"]),getCached:t("GET",["cache"]),getService:t("GET",["service"]),getServiceWithCatch:t("GET",["service","reject"]),getRender:t("GET",{service:!0,label:"Render"}),getInstruments:t("GET",{service:!0,label:"Instrument Search",cache:!0}),getPageScheme:t("GET",["scheme","skipBrowserCache"]),post:t("POST"),putService:t("PUT",["service"]),putSettings:t("PUT",{service:!0,label:"Settings"}),postService:n,mailLog:function(e,t){return n.call(this,"/devtools/mail-to-ben",{subject:e,message:t})},abortCall:function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];g.e(t,function(t){var e=g.filter(x,function(e){e=e.label;return t===e});g.isntE(e)&&(k=!0,g.e(T(t),function(e){var t=e.ajax,e=e.cacheHash;return t.abort(),delete P[e]}),j("Aborted ".concat(t," Request")),k=!1)})}}))}),define("Server",["underscore","jquery","Backbone","Http","Toolset","EventBus"],function(a,n,e,c,i,o){function l(e,t){return"".concat(e,"?").concat(n.param(t))}function u(e,t){return{"type-id":e,position:t}}var r=window.isProduction,t="".concat(window.isProduction?"https":"http","://i-invdn-com.investing.com/redesign/client/"),d={instrument:"/search-instrument/instrument",custom_view:"/custom-views/view",portfolios:"/portfolio/portfolios/",portfolio:"/portfolio/portfolio",portfolioRightsideSettings:"/user-settings/portfolios",marketsRightsideSetting:"/user-settings/market",marketsRightsideSettings:"/user-settings/markets",renderPortfolio:"/portfolio/portfolios-scheme",renderPortfolios:"/portfolio/render",renderMarketCategory:"/market/category",add_alert:"/alerts/alerts",get_alerts:"/alerts/instrument-data",edit_alert:"/alerts/alert",toggle_alert:"/alerts/alert-status",delete_alert:"/alerts/alert",save_earnings_alert:"/alerts/earnings-alerts",discussion_list:"/comments/list",discussion_add:"/comments/",load_more_comments:"/comments/more-comments",load_previous_replies:"/comments/previous-replies",reaction:"/api/reaction",reactions:"/api/reactions",chart_data:"/charts/instrument-chart-data",get_saved_items:"/saved-items/saved-items-panel",get_notifications_panel:"/user-notification/notification-panel",delete_saved_item:"/saved-items/item",add_saved_item:"/saved-items/item",dev_template_map:"/_templates/templateMap.json",cdn_template_map:t+"v/tm",cdn_template_dir:t+"v/",dev_client_map:"/scripts/app/clientMap.json",cdn_client_map:t+"cm",sentiments:"/sentiments",sentimentsFullMode:l("/sentiments",{addTablesSchema:1}),main_search:"/search-instrument/main-search",log_search:"/search-instrument/log-search",tableMoreRows:"/tables",sign_out:"/api/sign-out",externalNews:"/news/external-news-popup",aqlPopup:"/news/popup",revenue:"/jp.php",exportEvent:"/economic-calendar/export-event-data",eventsAlertsPopup:"/alerts/ec-popup",event_alert:"/alerts/"},s=new(e.EModel.extend({cdnPath:t,Render:{Portfolios:function(){return c.getRender(d.renderPortfolio)},Portfolio:function(e){return c.getRender(l(d.renderPortfolios,{id:e}))},RightsideMarket:function(e,t){return c.getRender(l(d.renderMarketCategory,{category_id:e,category_type:t?"portfolio":"default"}))},DiscussionPanel:function(e,t){return c.getService(d.discussion_list,{"type-id":t,"target-id":e})},SavedItems:function(e,t){return c.getService(d.get_saved_items,a.clean({limit:t,timestamp:e}))},NotificationsPanel:function(e){return c.getService(d.get_notifications_panel,{timestamp:e})},ExternalContentPopup:function(e,t,n,i){return c.getServiceWithCatch(d.externalNews,{contentId:e,contentType:t,contentPairId:n,pageType:i})},AqlContentPopup:function(e,t){return c.getService(d.aqlPopup,{id:e,type:t})},ExportEventPopup:function(e){return c.getService(d.exportEvent,{eventId:e})},EventsAlertsPopup:function(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:[];return c.getService(d.eventsAlertsPopup,a.isntE(e)?{events_IDs:e.join(",")}:{})}},Instrument:{Search:function(e){return c.getInstruments(d.instrument,{search_text:e,searchType:1<arguments.length&&void 0!==arguments[1]?arguments[1]:"",term:e,country_id:2<arguments.length&&void 0!==arguments[2]?arguments[2]:-1,tab_id:3<arguments.length&&void 0!==arguments[3]?arguments[3]:"All"})}},CustomView:{Add:function(e,t,n){return c.postService(d.custom_view,{"type-id":e,"view-name":t,columns:n})},Fetch:function(e,t){return c.getService(d.custom_view,u(e,t))},Update:function(e,t,n,i,o,r,s){return c.putService(l(d.custom_view,u(e,t)),a.clean({columns:n,"view-name":i,"new-position":o,"is-swap":r,"swap-columns":s},!0))},Reorder:function(e,t,n,i){return this.Update(e,t,null,null,n,i)},ReorderColumns:function(e,t,n,i){return this.Update(e,t,null,null,null,null,[n,i].join(","))},Delete:function(e,t){return c.deleteService(l(d.custom_view,u(e,t)))}},Portfolio:{Add:function(e){return c.postService(d.portfolio,{portfolioName:e})},Fetch:function(){return c.getService(d.portfolios)},Update:function(e,t,n){return c.putService(d.portfolio,{pairs:e.join(","),addToPortfolioId:t.join(","),removeFromPortfolioId:n.join(",")})},AddPair:function(e,t){return i.ClientStorage.isPairInPortfolio(e,t)?(o.trigger("addingAlreadyAddedPairEv"),{then:a.noop}):(i.ClientStorage.addPairToP2P(e,t),this.Update([t],[e],[]).then(function(){return o.trigger("portfolioModifiedEv",e,[t])}))},RemovePair:function(e,t){return i.ClientStorage.removePairFromP2P(e,t),this.Update([t],[],[e])},Delete:function(e){return c.deleteService(d.portfolio,{portfolioId:e})},RightsideSettings:function(e,t){return c.putSettings(d.portfolioRightsideSettings,{order:e.join(","),display:t.join(",")})}},MarketPanel:{SaveSettings:function(e,t,n,i){return c.putSettings(d.marketsRightsideSettings,{order:e.join(","),display:t.join(","),range:n,size:i})},SaveSetting:function(e,t,n,i){return c.putService(d.marketsRightsideSetting,{id:e,type:t,displayTitleType:n,displayDataType:i})}},Alerts:{Add:function(e,t,n,i,o,r,s,a,l){return c.postService(d.add_alert,{pair_ID:e.join(","),email_alert:n,app_alert:i,alert_trigger:a,threshold:s,value:o,frequency:r,alertType:"instrument",platform:"desktop",preReminderText:""},{GTM:l})},Update:function(e,t,n,i,o,r,s,a,l,u){return c.putService(d.edit_alert,{pair_ID:e.join(","),email_alert:n,app_alert:i,alert_trigger:l,threshold:a,value:o,frequency:r,alertType:"instrument",platform:"desktop",preReminderText:"",alert_ID:s},{GTM:u})},Fetch:function(e){return c.getService(d.get_alerts,{pair_ID:e})},Toggle:function(e,t){return c.putService(d.toggle_alert,{alert_ID:e,active:t,alertType:"instrument",platform:"desktop"})},Delete:function(e,t){return c.deleteService(d.delete_alert,{pair_ID:t,alert_ID:e,alertType:"instrument",platform:"desktop"})},SaveEarnings:function(e,t,n,i,o,r,s,a){return c[e?"putService":"postService"](d.save_earnings_alert,{alertType:"earnings",active:n,alert_ID:e,pair_ID:t.join(","),alert_trigger:"earnings",frequency:r,threshold:"over",platform:"desktop",pre_reminder:s?"day":"none",email_alert:i,app_alert:o,preReminderText:""},{GTM:a})}},EconomicCalendarAlerts:{Add:function(e,t,n){return c.postService(d.event_alert,{alert_type:"event",events_IDs:e.join(","),frequency:t,pre_reminder_time:n})},Update:function(e,t,n,i){return c.putService(d.event_alert,{alert_type:"event",alert_ID:e,active:t,frequency:n,pre_reminder_time:i})},Delete:function(e){return c.deleteService(d.event_alert,{alert_type:"event",alert_ID:e})}},Discussion:{Add:function(e,t,n,i,o,r){return c.postService(d.discussion_add,a.clean({text:e,"type-id":t,"target-id":n,"parent-id":o,chart:i}),{GTM:r})},LoadMoreComments:function(e,t,n){return c.getService(d.load_more_comments,{"page-num":e,"type-id":t,"target-id":n})},FetchReplies:function(e,t,n){return c.getService(d.load_previous_replies,{"type-id":e,"target-id":t,"parent-id":n})},Like:function(e){return c.postService(d.reaction,{"item-type":1<arguments.length&&void 0!==arguments[1]?arguments[1]:"comment","item-id":e,reaction:2<arguments.length&&void 0!==arguments[2]?arguments[2]:"like",isUnlike:3<arguments.length&&void 0!==arguments[3]&&arguments[3]},{GTM:4<arguments.length?arguments[4]:void 0})},GetReactions:function(){return c.getService(d.reactions,{"item-type":"comment"})}},Charts:{Fetch:function(e){var t=e.chartType,n=e.range,i=e.volumeSeries,o=e.timeframe,r=e.pairId,e=e.pairIdForNews;return c.getService(d.chart_data,a.clean({chartType:t,period:n,pairInterval:o,volumeSeries:i?"yes":"no",pairId:r,pairIdForNews:e}))},FetchAggregatedData:function(e,t){return c.getCached((e=e,t=t,"".concat("https://sbcharts.investing.com/charts_xml","/").concat(e).concat(t,".json")),{},{silent:!0})}},LeftPanel:{},SavedItems:{Delete:function(e,t,n){return c.deleteService(l(d.delete_saved_item,{id:e,type:t,timestamp:n}))},Add:function(e,t,n){return c.postService(l(d.add_saved_item,a.clean({id:e,type:t,timestamp:n})))}},Maps:{Templates:function(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:"";return c.get(r?"".concat(d.cdn_template_map+e,".json"):"".concat(d.dev_template_map,"?v=").concat(e))},Client:function(e){return c.get(r?"".concat(d.cdn_client_map+e,".json"):"".concat(d.dev_client_map,"?v=").concat(e))}},Get:{Template:function(e,t){return c.getHtml(r?"".concat(d.cdn_template_dir+e+t,".html"):"/_templates/".concat(e,".html"))},TemplateLocal:function(e){return c.getTemplate("/templates?id=".concat(e))}},Sentiments:{Vote:function(e,t,n,i){return c.postService(n?d.sentimentsFullMode:d.sentiments,{pair_ID:e,call_type:t},{GTM:i})},Delete:function(e,t,n){return c.deleteService(t?d.sentimentsFullMode:d.sentiments,{pair_ID:e},{GTM:n})}},Search:{All:function(e,t,n,i){return c.getInstruments(l(d.main_search,a.clean({searchText:e,type:t,limit:n,offset:i})))},Log:function(e,t){return c.postService(d.log_search,{searchText:e,clickedResult:t})}},Table:{fetchMoreRows:function(e){return c.getService(d.tableMoreRows,e)}},User:{SingOut:function(){return c.postService(d.sign_out,{})}},Revenue:{Count:function(e,t){return c.getHtml(l(d.revenue,{b:e?11:10,placement:!0,k:t}))}}}));return r||(window.runService=function(e,t){for(var n=arguments.length,i=new Array(2<n?n-2:0),o=2;o<n;o++)i[o-2]=arguments[o];return(e=s[e])[t].apply(e,i)}),s}),define("Modules/DependencyLoader/DependencyLoader",["underscore","jquery","Backbone"],function(e,t,n){return n.EModel.extend({initialize:function(){this.loadedComponents={},this.initializedComponents={}},drop:function(){this.loadedComponents={},this.initializedComponents={}},get:function(e){return this.loadedComponents[e]},getSize:function(){return e.size(this.loadedComponents)},load:function(e,t,n){this.loadedComponents[e]={deps:t,definition:n}},areLoaded:function(e){return this._allScriptsLoadedInArray(e)},export:function(){return JSON.stringify(this.loadedComponents)},import:function(e){this.loadedComponents=JSON.parse(e)},_buildDepsReferences:function(e){return e.reduce(function(e,t){return e.push(this.initializedComponents[t]),e},[])},_loadComponent:function(e){var t=this.loadedComponents[e].deps,t=this._buildDepsReferences(t);this.initializedComponents[e]=(e=this.loadedComponents[e].definition,t=t,"function"==typeof e?e.apply(null,t):e)},_allScriptsLoadedInArray:function(e){var n=this;return e.reduce(function(e,t){return e&&!!n.initializedComponents[t]},!0)},_attemptToInitScript:function(e){this._allScriptsLoadedInArray(this.loadedComponents[e].deps)&&this._loadComponent(e)}})}),define("TemplateManager",["underscore","jquery","Backbone","Http","Server","EventBus","Toolset","DataChest","Modules/DependencyLoader/DependencyLoader"],function(h,e,t,o,r,n,s,i,a){function l(){return+i.get("lastTemplate")}var p="__collection__",u="lastTemplateVersion",c={trimPath:/^.+(app\/.+)$/,forwardSlashes:/\//g},d="investing.com"===window.location.host.substr(-13)&&"qa.investing.com"!==window.location.host.substr(-16),f=lcl.makeCustom("Templates"),m={},_=new a;function g(e){var t,n,i=e.templateName,e=e.content,e=void 0===e?"":e;return t=i,(n=e)&&n.trim()||throwError("Bad Template Content",t,n),_.load(i,[],e),this}function v(e,t,n){e.$nestedData||(e.$nestedData={}),e.$nestedData[t]=n}return new(t.EModel.extend({_failedPromises:null,_templateFetches:null,_fetchTMapPromise:null,_missingTemplates:null,_fetchPromiseCollection:null,initialize:function(){var e=this._loadFromLS();e&&_.import(e),this._updateTemplatesIfNeeded(),n.onMultiple({dropTemplatesEv:this._dropTemplates.bind(this),refetchTemplateMapEv:this._updateTemplatesIfNeeded.bind(this)})},render:function(t){var n=this,i={};return f("Loading Scheme:",t),this._testInnerChunkStructure(t),new Promise(function(e){return n._fetchTMapPromise?n._fetchTMapPromise.then(function(){return Promise.all(n._templateFetches).then(function(){return n._fireRender(t,i,e)})}):n._fireRender(t,i,e)})},renderList:function(e,t){return this.render(_defineProperty({},t,{_list:e}))},refetchMap:function(){return this._updateTemplatesIfNeeded(),this},_fireRender:function(e,t,n){var i=this;return this._loadTemplatesFromScheme(e,t).then(function(){return f("Constructed Data Container:",t)}).then(function(){return n(i._recursivelyRenderTemplates(t).$nestedData)})},_dropTemplates:function(){_.drop(),this._saveToLS()},_updateTemplatesIfNeeded:function(){var n=this,t=s.ClientStorage.cache(u)||0,i=l();t!==i?(f("Newer Template Map Version Exists"),this._templateFetches=[],this._fetchTMapPromise=r.Maps.Templates(i).then(function(e){n._templateMap=e,h.e(h.filterObject(e,function(e){return e.unix>t}),function(e,t){_.get(t)&&n._templateFetches.push(n._fetchTemplate(t).then(g))}),h.isE(n._templateFetches)&&f("No newer versions of stored templates, only updating map"),Promise.all(n._templateFetches).then(function(){s.ClientStorage.setObj("_t_m_",e),s.ClientStorage.cache(u,i),n._saveToLS()})})):(this._templateMap=s.ClientStorage.getObj("_t_m_"),this._fetchTMapPromise=null)},_testInnerChunkStructure:function(e){h.hasKeys(e,["view","vars","nested","viewPath"])&&this._breakOnCorruptedTemplate("Invalid Scheme, main object is an inner chunk (Not wrapped with a name key)",e)},_loadTemplatesFromScheme:function(e){var i=this,t=1<arguments.length&&void 0!==arguments[1]?arguments[1]:{};return this._fetchPromiseCollection=[],this._failedPromises=[],this._missingTemplates={},this._recursivelyFetchTemplates(h.cleanEmpty(e),t),h.isntE(this._missingTemplates)&&(this.config("isProduction")&&d?(e=l(),t=h.map(this._missingTemplates,function(e){return"app/"+e.split("/app/")[1]}).join(","),t="Templates Missing from Map:\n\n".concat(t,"\n\nLast Template Version: ").concat((""+new Date(e)).substr(0,24),"(").concat(e,")\n\n\t\t\t\t\t\tLocation: ").concat(window.location,"\nUser: ").concat(s.UserStorage.getUserId()),n.trigger("clientNavigationEndEv"),window.throwError.silent({type:"major",title:"Templates Notice",message:t}),window.location.reload()):throwError("Missing Templates",this._missingTemplates)),new Promise(function(n){h.isntEmpty(i._fetchPromiseCollection)?Promise.all(i._fetchPromiseCollection).then(function(e){var t;h.isntE(i._failedPromises)?(t="".concat(h.size(i._failedPromises)," Fetches failed. Rejected Templates:\n").concat(i._failedPromises.join("\n"),"\n"),o.mailLog("Templates Notice","Failed Template Fetches:\n\n".concat(t)).then(function(){return window.location.reload()})):(h.each(e,g),i._saveToLS(),f("Done fetching, loading and saving ".concat(h.size(i._fetchPromiseCollection)," templates - Starting Render")),n())}):(f("All templates already stored - Starting Render"),n())})},_fetchTemplate:function(i){var e=this;return new Promise(function(t){function n(e){return t({templateName:i,content:e})}e._templateMap[i]&&r.Get.Template(i,e._templateMap[i].unix).then(n).catch(function(){r.Get.TemplateLocal(i).then(function(e){n(e.template),o.mailLog("Templates Notice","Fell back To ".concat(i,' with "').concat(e.template,'"'))}).catch(function(){e._failedPromises.push(i),t()})})})},_addFetchPromise:function(e){_.get(e)||m[e]||(f("Fetching",e),m[e]=!0,this._fetchPromiseCollection.push(this._fetchTemplate(e)))},_recursivelyFetchTemplates:function(e,a,l,u){var c=this,d=h.isAr(e);h.e(h.omit(e,h.isEmpty),function(e,t){var n=e.viewPath,i=e.view,o=e.nested,r=e.vars,s=e._list,n=n||l;h.has(e,"_list")?h.isntE(s)?h.isAr(s)?c._recursivelyFetchTemplates(s,a,n,t):c._breakOnCorruptedTemplate("Non-array object under _list",t):a[t]={templateData:[],nestedData:{}}:(s={hashedTemplateName:e=c._makeViewPath(n,i),templateData:r},c._templateMap[e]||(c._missingTemplates[e]="".concat(n,"/").concat(i,".phtml")),c._addFetchPromise(e),d?(a[u]||(a[u]=_defineProperty({},p,[])),s.templateHash=e,a[u][p].push(s)):a[t]=s,o&&(s.nestedData={},c._recursivelyFetchTemplates(o,s.nestedData,n)))}),h.e(h.omit(e,h.isntE),function(e,t){a[t]={templateData:[],nestedData:{}}})},_renderIteration:function(e,t,n,i){var o,r=this,s={},a=[];t[p]?(h.e(t[p],function(e){return r._renderIteration(a,e,e.templateHash,!0)}),v(e,n,a.join(""))):(o=_.get(t.hashedTemplateName))?(o=o?h.template(this._unpackTemplate(o.definition)):function(){return""},h.isntE(t.nestedData)&&(s=this._recursivelyRenderTemplates(t.nestedData)),t=t,s=s,(i?function(e,t,n){e.push(n)}:v)(e,n,o(h.extend({$vars:t.templateData||{}},s)))):v(e,n,"")},_recursivelyRenderTemplates:function(e){var n=this,i={};return h.e(e,function(e,t){return n._renderIteration(i,e,t)}),i},_makeViewPath:function(e,t){e=_slicedToArray(c.trimPath.exec(e+"/"+t),2)[1];return s.Hashes.md5(e.replace(c.forwardSlashes,"\\")+".phtml")},_breakOnCorruptedTemplate:function(e,t){throwError("Corrupted Scheme",e,t)},_saveToLS:function(){s.ClientStorage.setVal("_t_",_.export())},_unpackTemplate:function(e){return s.LZString.decompressFromUTF16(e.substr(5))},_loadFromLS:function(){return s.ClientStorage.getVal("_t_")}}))}),define("Modules/MainSearch/CategoryView",["underscore","jquery","Backbone","Displayable"],function(o,r,e,n){var t={quotes:"_buildQuoteRow",news:"_buildNewsRow",articles:"_buildNewsRow",ec_event:"_buildEconomicEventRow",tools:"_buildNewsRow",authors:"_buildNewsRow",popular:"_buildQuoteRow",recent:"_buildQuoteRow"};return n.extend({_categoryName:null,_quotesData:null,_isMoreQuotesFetched:null,_markupScheme:{itemsWrapper:".js-category-items-wrapper",itemClone:".js-category-item-clone","?query":".js-category-query","?itemsCounter":".js-category-items-counter","?accordion":".js-accordion","?showMoreWrapper":".js-category-show-more-wrapper","?showMoreFooter":".js-category-show-more-footer","?showAllLink":".js-category-link"},events:{"?click .js-category-show-more-footer > button":"_toggleExpansion"},initialize:function(e,t){n.prototype.initialize.call(this,e),this._categoryName=t},render:function(e){n.prototype.render.call(this),this._dom.itemClone.detach().rCl("js-category-item-clone"),e&&this._buildItems(e)},populate:function(e,t,n){this._reset(),this._buildItems(this._limitItemsToMaxAmount(e)),this._boldifyIfNeeded(t),this._hideExpandButtonIfNeeded(+e.length),this._setQueryAndItemsCount(t,n),this._setShowAllLink(t)},hideCategory:function(){this.$el.hideEl()},_buildItems:function(e){this._dom.itemsWrapper.buildAndPopulate(e,this[t[this._categoryName]].bind(this))},_reset:function(){this.$el.showEl().unsetLastChild(),this._dom.showMoreWrapper.rOpen(),this._dom.accordion.rOpen()},_buildQuoteRow:function(e){var t=this,n=this._dom.itemClone.clone().attr("href",e.link).data("id",e.pairId);return n.mF(".js-category-item-flag").aCl("flag-".concat(o.toLowerCase(e.flag))),n.mF(".js-category-item-symbol").textT(e.symbol),n.mF(".js-category-item-name").textT(e.name).attr("title",e.name),n.mF(".js-category-item-type").textT(e.type),n.on("click",function(){return t.trigger("searchedItemClickedCatEv",e)}),n},_buildNewsRow:function(e){var t=this._dom.itemClone.clone();return t.mF(".js-category-item-title").attr("href",e.link).textT(e.name),t},_buildEconomicEventRow:function(e){var t=this._dom.itemClone.clone().attr("href",e.link);return t.mF(".js-category-item-flag").aCl("flag-".concat(o.toLowerCase(e.flag))),t.mF(".js-category-item-symbol").textT(e.symbol),t.mF(".js-category-item-name").textT(e.name).attr("title",e.name),t.mF(".js-category-item-star").slice(+e.importance,3).remove(),t},_setQueryAndItemsCount:function(e,t){this._dom.query.textT(e),this._dom.itemsCounter.textT("(".concat((e=t)<=100?e:"100+",")"))},_setShowAllLink:function(e){this._dom.showAllLink.href("/search/?q=".concat(e,"&tab=").concat(this._categoryName))},_hideExpandButtonIfNeeded:function(e){this._dom.showMoreWrapper.tCl("show-more",5<e),this._dom.showMoreFooter.toggleEl(5<e),this._dom.showAllLink.toggleEl(10<=e)},_toggleExpansion:function(){this._dom.showMoreWrapper.tOpen()},_limitItemsToMaxAmount:function(e){return e.slice(0,10)},_boldifyIfNeeded:function(i){var e=this._dom.itemsWrapper.f(">");3<=i.length&&e&&e.find(".js-category-item-symbol, .js-category-item-name, .js-category-item-title").each(function(e,t){var n=r(t).text();o.containsText(n,i)&&r(t).html(function(e,t){return t.replace(new RegExp("(".concat(i,")"),"gi"),'<span class="search-hint">$1</span>')})})},_isOpen:function(){return this._dom.accordion.hCl("open")}})}),define("Modules/MainSearch/QuotesCategoryView",["underscore","jquery","Backbone","Modules/MainSearch/CategoryView"],function(i,o,e,r){function t(e){return i.uniq(e,function(e){return e.pairId})}return r.extend({_categoryName:null,_quotesData:null,_isMoreQuotesFetched:null,_query:null,_filtersPopup:null,_markupScheme:{itemsWrapper:".js-category-items-wrapper",itemClone:".js-category-item-clone",query:".js-category-query",itemsCounter:".js-category-items-counter",accordion:".js-accordion",showMoreWrapper:".js-category-show-more-wrapper",showMoreFooter:".js-category-show-more-footer",showAllLink:".js-category-link",filtersOpener:".js-main-search-quotes-filters-opener",filtersText:".js-main-search-quotes-filters-text",noResults:".js-main-search-quotes-no-res",noResMessageType:".js-quotes-no-results-message"},events:{"click .js-category-show-more-footer > button":"_toggleExpansion","click .js-accordion":"_toggleFiltersVisibility"},initialize:function(e){r.prototype.initialize.call(this,e,"quotes"),this._quotesData=[],this._isMoreQuotesFetched=!1},render:function(){r.prototype.render.call(this),this._initQuotesFilters()},populate:function(e,t,n){this._query=t,this._setQuotesData(e),r.prototype.populate.call(this,e,t,n)},addQuotesData:function(e){this._quotesData=t(this._quotesData.concat(e))},toggleFiltersVisibility:function(){this._dom.filtersOpener.toggleEl(this._isOpen())},_reset:function(){r.prototype._reset.call(this),this._dom.noResults.hideEl(),this._dom.showMoreWrapper.showEl(),this._dom.filtersText.textT(this.$el.mF('.js-main-search-quotes-filters-popup li[data-value="all"]').textT())},_applyQuotesFilters:function(e){var e=o(e.currentTarget),t=e.data("value"),n=i.clone(this._quotesData),n=t.is("All")?n:i.filter(n,function(e){return e.pair_type===t});this._dom.filtersText.textT(e.textT()),this._dom.noResMessageType.textT(e.textT()),this._buildNewItemsAfterFilter(n,this._query),this._closeFiltersPopup()},_buildNewItemsAfterFilter:function(e,t){this._buildItems(this._limitItemsToMaxAmount(e)),this._boldifyIfNeeded(t),this._hideExpandButtonIfNeeded(+e.length),this._dom.noResults.toggleEl(!e.length),this._dom.showMoreWrapper.toggleEl(e.length)},_setQuotesData:function(e){this._isMoreQuotesFetched=!1,this._quotesData=t(e)},_initQuotesFilters:function(){var e=this,t=this.$el.mF(".js-main-search-quotes-filters-popup");this._filtersPopup=this.setupPopup(this._dom.filtersOpener,t),this._dom.filtersOpener.on("mouseenter",function(){e._isMoreQuotesFetched||(e._isMoreQuotesFetched=!0,e.trigger("fetchMoreQuotesEv",e._quotesData.length))}),t.mF("li[data-value]").on("click",this._applyQuotesFilters.bind(this)),t.mF(".js-main-search-filters-mobile-close").on("click",this._closeFiltersPopup.bind(this))},_closeFiltersPopup:function(){this._filtersPopup.close()}})}),define("Modules/MainSearch/MainSearchView",["underscore","jquery","Backbone","Displayable","Modules/MainSearch/CategoryView","Modules/MainSearch/QuotesCategoryView"],function(o,i,e,r,s,n){var a=i(window.document),l="quotes",u=["news","articles","ec_event","tools","authors"];return r.extend({_debouncedFireSearch:null,_popularSearches:null,_recentSearches:null,_categories:null,_markupScheme:{input:".js-main-search-input",desktopPopup:".js-main-search-desktop-popup",mobilePopup:".js-main-search-mobile-popup",results:".js-main-search-results-wrapper",noQueryResults:".js-main-search-no-query-results-wrapper",noResults:".js-main-search-no-res",allCategories:".js-main-search-category",dynamicCategories:".js-main-search-categories-wrapper > .js-main-search-category",accordions:".js-accordion"},events:{"focus .js-main-search-input":"_showDialog","input .js-main-search-input":"_updateResultsState","click .js-main-search-mobile-back-button":"_hideDialog","click .js-main-search-mobile-open-button":"_showDialog"},initialize:function(e,t,n){r.prototype.initialize.call(this,e),this._debouncedFireSearch=o.debounce(this._fireSearch.bind(this),500),this._popularSearches=t,this._recentSearches=n},render:function(){var t=this;r.prototype.render.call(this),this._openDialogIfInFocus(),this._initCategories(),this.setupAccordions(this._dom.accordions,function(){return t._categories[l].toggleFiltersVisibility()}),this._dom.input.onEnter(this._redirectToSearchResultPage.bind(this)).onEsc(function(e){return o.pD(e),i.blur(),t._hideDialog()}),a.on("mousedown",this._hideDialog.bind(this)),this.$el.on("mousedown",o.sP)},populate:function(n){var i=this,e=!n.total.allResults;o.e(this._categories,function(e,t){n[t]?e.populate(n[t],i._dom.input.valT(),n.total[t]):e.hideCategory()}),this._dom.noResults.toggleEl(e),this._dom.results.toggleEl(!e),this._openFirstVisibleCategory(),this._addLastChildToLastVisibleCategory(),this._toggleQuotesFiltersVisibility()},populateQuotes:function(e){this._categories[l].addQuotesData(e)},_initCategories:function(){var t=this;this._categories=_defineProperty({},l,this._initQuotesCategory()),o.e(u,function(e){return t._categories[e]=t._initCategory(e)}),this._initCategory("popular",this._popularSearches),this._initCategory("recent",this._recentSearches),this._dom.noQueryResults.mF('[data-category-name="recent"]').toggleEl(this._recentSearches.length)},_initCategory:function(t,e){var n=i(o.find(this._dom.allCategories,function(e){return i(e).data("category-name").is(t)})),n=new s(n,t);return n.render(e),n.on("searchedItemClickedCatEv",this._triggerItemClick.bind(this)),n},_initQuotesCategory:function(){var t=this,e=i(o.find(this._dom.allCategories,function(e){return i(e).data("category-name").is(l)})),e=new n(e);return e.render(),e.on("searchedItemClickedCatEv",this._triggerItemClick.bind(this)),e.on("fetchMoreQuotesEv",function(e){return t.trigger("fetchMoreQuotesEv",t._dom.input.valT(),e)}),e},_triggerItemClick:function(e){var t=this._dom.input.valT();this._dom.input.val(""),this._updateResultsState(),this._hideDialog(),this.trigger("searchedItemClickedEv",e,t)},_openDialogIfInFocus:function(){this._dom.input.isActive()&&this._showDialog()},_openFirstVisibleCategory:function(){var e=o.find(this._dom.dynamicCategories,function(e){return i(e).isVisible()});e&&i(e).mF(".js-accordion").aOpen()},_addLastChildToLastVisibleCategory:function(){var e=o.findLast(this._dom.dynamicCategories,function(e){return i(e).isVisible()});e&&i(e).setLastChild()},_showDialog:function(){this._dom.desktopPopup.showElDesktop(),this._dom.mobilePopup.showElMobile()},_hideDialog:function(){this._dom.desktopPopup.hideElDesktop(),this._dom.mobilePopup.hideElMobile()},_updateResultsState:function(){var e=this._dom.input.valT();this._dom.noQueryResults.toggleEl(!e),this._dom.results.toggleEl(e&&this._dom.results.isVisible()),this._dom.noResults.hideEl(),this._debouncedFireSearch(e)},_fireSearch:function(e){this.abortCall("Instrument Search"),e&&this.trigger("fireMainSearchEv",e)},_redirectToSearchResultPage:function(){var e=this._dom.input.valT();e&&(this._hideDialog(),this.abortCall("Instrument Search"),this.navigate("/search/?q=".concat(e),!0))},_toggleQuotesFiltersVisibility:function(){this._categories[l].toggleFiltersVisibility()}})}),define("MainSearch",["underscore","jquery","Backbone","Server","Toolset","DataChest","Modules/MainSearch/MainSearchView"],function(n,e,t,i,o,r,s){var a="recentSearches";return t.EModel.extend({_view:null,_popularSearches:null,_recentSearches:null,initialize:function(){this._popularSearches=r.get("mainSearch"),this._recentSearches=o.ClientStorage.getObj(a,!0)||[]},render:function(e){var n=this;this._view=new s(e,this._popularSearches,this._recentSearches),this._view.render(),this._view.onMultiple({fireMainSearchEv:this._fireSearch.bind(this),fetchMoreQuotesEv:this._fetchMoreQuotes.bind(this),searchedItemClickedEv:function(e,t){n._saveItemToRecentSearches(e),n._logSearch(t,e.pairId)}})},_fireSearch:function(e){var t=this;i.Search.All(e).then(function(e){return t._view.populate(e)})},_fetchMoreQuotes:function(e,t){var n=this;i.Search.All(e,"quotes",300,t).then(function(e){return n._view.populateQuotes(e.quotes||[])})},_saveItemToRecentSearches:function(t){var e=n.findIndex(this._recentSearches,function(e){return""+e.pairId==""+t.pairId});5!==this._recentSearches.length&&!~e||this._recentSearches.splice(e,1),this._recentSearches.unshift(t),o.ClientStorage.setObj(a,this._recentSearches,!0)},_logSearch:function(e,t){i.Search.Log(e,t)}})}),define("Modules/DynamicPage/More",["underscore","jquery","Backbone","Server","DataChest","EventBus","Displayable"],function(s,a,e,t,n,i,o){var r=a(window),l=a(window.document),u=5*s.oneMinute,c=15*s.oneMinute;return o.extend({_keyTriggers:null,_keyLoggerInput:null,_lastDFPRefresh:null,_lastGTMRefresh:null,_dfpLazyLoadElements:null,_dataLayerRefreshJSON:null,_markupScheme:{"?toOldSite":".js-go-back-to-old-site-wrapper","?officeOnlyPrints":".js-office-only"},initialize:function(e){o.prototype.initialize.call(this,window.document.body),this._$contentWrapper=e,this._dfpLazyLoadElements={},this._lastDFPRefresh=Date.now(),this._lastGTMRefresh=Date.now(),this._keyLoggerInput=[],this._keyTriggers={},this._initGTMData()},render:function(){var e=this;return o.prototype.render.call(this),this._initDFPs(),this._initDFPLazyLoadElements(),this._setupKeylogger(),this._countRevenueImpressions(),r.on("focus.dfpRefresh",function(){return e._refreshDFPIfNeeded()}),r.on("focus.gtmRefresh",function(){return e._refreshGTMIfNeeded()}),i.on("refreshDFPsInContainerEv",this._initDFPs.bind(this)),this.$el},destroy:function(){r.off("focus.dfpRefresh"),r.off("focus.gtmRefresh"),l.off("scroll.dfpLazyLoad"),i.off("refreshDFPsInContainerEv")},_initGTMData:function(){var e=n.get("GTMData");e.pageBreakpoints=a.getPageBreakpoint(),e.leftSideStatus=100<+this._$contentWrapper.f(".js-left-panel-main-container").width()?2:1,e.autoRefresh="no",e.locationURL=window.location.href,e.smd=this.getCookie("smd"),e.udid=this.getCookie("udid"),e.udid_created=this.getCookie("firstUdid")||0,this._dataLayerRefreshJSON=s.extend({},e,{autoRefresh:"yes",event:"GTM page to GA"}),this.GTMObj(e)},getFreshSmdValue:function(){var e=Date.now(),t=this.getCookie("smd"),n=this.getCookie("udid"),n=(n&&(t=n+"-"+Math.floor(e/1e3)),new Date),e=new Date;if(e.setMinutes(n.getMinutes()+30),""!==t)return this.setDomainCookie("smd",t,e.toGMTString()),t},setDomainCookie:function(e,t,n){document.cookie=e+" = "+t+"; expires="+n+"; domain=investing.com; path=/"},getCookie:function(e){for(var t=e+"=",n=document.cookie.split(";"),i=0;i<n.length;i++){for(var o=n[i];" "==o.charAt(0);)o=o.substring(1);if(0==o.indexOf(t))return o.substring(t.length,o.length)}return""},_setupKeylogger:function(){var i=this;this.$el.on("keydown",function(e){var t=e.key,n=e.shiftKey;i._keyLoggerInput.push(t),s.e(i._keyTriggers,function(e,t){return n&&t.is(i._keyLoggerInput.slice(-t.length).join(""))&&e()})}),this._dom.officeOnlyPrints.exists()&&(this._keyTriggers.oo=function(){return i._openOfficeOnlyPopup()}),this._dom.toOldSite.isVisible()&&(this._keyTriggers.qw=function(){return i._hideToOldSiteBar()}),setInterval(function(){return i._keyLoggerInput=[]},6e3),"?oo"===window.location.search&&this._openOfficeOnlyPopup()},_openOfficeOnlyPopup:function(){this.firePopup(this._dom.officeOnlyPrints,["modal"])},_refreshDFPIfNeeded:function(){Date.now()>this._lastDFPRefresh+u&&(this._lastDFPRefresh=Date.now(),window.googletag&&window.googletag.pubads&&s.tryRun(window.googletag.pubads().refresh))},_refreshGTMIfNeeded:function(){Date.now()>this._lastGTMRefresh+c&&(this._lastGTMRefresh=Date.now(),this._dataLayerRefreshJSON.smd=this.getFreshSmdValue(),this.GTMObj(this._dataLayerRefreshJSON))},_hideToOldSiteBar:function(){this._dom.toOldSite.hideEl(),window.document.cookie="hideBackToOld=1;domain=".concat(window.location.hostname,";path=/; expires=").concat(new Date(1591731589980).toUTCString())},_initDFPLazyLoadElements:function(){var t=this;s.e$(this._$contentWrapper.f(".js-dfp-lazy-load"),function(e){t._dfpLazyLoadElements[e.data("slot-id")]={elementId:e.attr("id"),size:e.data("size"),$lazyLoadWrapper:e}}),l.on("scroll.dfpLazyLoad",function(){return t._triggerVisibleDFPs()}),this._triggerVisibleDFPs()},_initDFPs:function(e,r){s.e$((e||this._$contentWrapper).f(".js-dfp"),function(e){var t=e.data(),n=t.size,i=t.slotId,t=t.platform,o=e.attr("id");!(a.isntMobile()&&t.is("desktop")||a.isMobile()&&t.is("mobile"))||r&&!e.isVisible()||a.initDFPSlot(i,o,n)})},_triggerVisibleDFPs:function(){var o=this;s.e(this._dfpLazyLoadElements,function(e,t){var n=e.elementId,i=e.$lazyLoadWrapper,e=e.size;i.isInView(!0)&&(a.initDFPSlot(t,n,e),delete o._dfpLazyLoadElements[t],s.isE(o._dfpLazyLoadElements)&&l.off("scroll.dfpLazyLoad"))})},_countRevenueImpressions:function(){t.Revenue.Count(a.isMobile(),n.get("adscachetag"))}})}),define("Modules/DynamicPage/GeneralInits",["underscore","jquery","Backbone","Http","EventBus","TemplateManager","Displayable"],function(n,e,t,i,o,r,s){return s.extend({_$generalPageWrapper:null,_markupScheme:{},initialize:function(e){s.prototype.initialize.call(this,e)},render:function(){var e,t=this;return s.prototype.render.call(this),this._$generalPageWrapper=this.$el.f(".js-general-page-wrapper"),this._$generalPageWrapper.exists()&&((e=this._$generalPageWrapper.f(".js-general-page-navigation-select")).on("input",function(){return t._navigateGenerally(e.val())}),n.e$(this._$generalPageWrapper.f(".js-general-page-navigation-link"),function(e){return e.on("click",function(){return t._navigateGenerally(e.data("service-url"))})})),this.$el},_navigateGenerally:function(e){var t=this;o.trigger("indicateLoadingEv"),i.getService(e).then(r.render.bind(r)).then(function(e){e=e.table;return t._$generalPageWrapper.html(e)}).then(function(){return o.trigger("indicateLoadingOffEv")}).then(function(){return o.trigger("renderDynamicPageEv")}).then(function(){return t.render()})}})}),define("Modules/News/NewsView",["underscore","jquery","Backbone","Displayable","EventBus"],function(i,t,e,n,o){return n.extend({_currentAqlPopup:null,_aqlPopup:null,_encodedUrl:null,_markupScheme:{"?aqlWrappers":".js-aql-popup-wrapper"},events:{"?click .js-external-content-link":"_openExternalContentInView","?click .js-main-share-twitter":"_openTwitterPopup","?click .js-main-share-facebook":"_openFacebookPopup","?click .js-main-share-whatsapp":"_openWhatsappPopup","?click .js-main-share-vk":"_openVkPopup"},initialize:function(e){n.prototype.initialize.call(this,e),this._currentAqlPopup=[],this._aqlPopup=t('<div class="'.concat("popup e-inside-article-popup",'"></div>')),this._encodedUrl=encodeURIComponent(location.href)},render:function(){return n.prototype.render.call(this),this._bindAqlPopupsEvents(),this.$el},showAqlPopup:function(e,t,n){n=this._aqlPopup.html(n);this._currentAqlPopup[0]&&this.closePopupFromElement(this._currentAqlPopup[1]),this._currentAqlPopup=[e[0],n],this.fireRelocate(n,e,["sticky","openWithinContent"]),o.trigger("renderDynamicPageEv",n,t.entityId)},_bindAqlPopupsEvents:function(){var n=this;i.e$(this._dom.aqlWrappers,function(e){var t=e.mF(".js-aql-popup-link");t.on("mouseenter",i.debounce(n._openAqlPopupInView.bind(n,e,t.data()),250)),e.on("mouseleave",i.debounce(n._closeAqlPopupInView.bind(n,e),625))})},_openExternalContentInView:function(e){e=e.currentTarget;this.trigger("openExternalContentEv",t(e).data())},_openAqlPopupInView:function(e,t){e.is(":hover")&&this._currentAqlPopup[0]!==e[0]&&this.trigger("openAqlPopupEv",e,t)},_closeAqlPopupInView:function(e){e.is(":hover")||this._currentAqlPopup[0]!==e[0]||(e=this._currentAqlPopup[1],this.closePopupFromElement(e),e.remove(),this._currentAqlPopup=[])},_openFacebookPopup:function(){i.openSocialPopup("facebook",this._encodedUrl)},_openTwitterPopup:function(){i.openSocialPopup("twitter",this._encodedUrl,400)},_openWhatsappPopup:function(){i.openSocialPopup("whatsapp",this._encodedUrl)},_openVkPopup:function(){i.openSocialPopup("whatsapp",this.vk)}})}),define("Modules/News/News",["underscore","jquery","Backbone","Server","TemplateManager","EventBus","./NewsView"],function(e,a,t,l,u,c,n){return t.EModel.extend({_view:null,initialize:function(e){this._view=new n(e)},render:function(){this._view.render(),this._view.onMultiple({openExternalContentEv:this._openExternalContentPopup.bind(this),openAqlPopupEv:this._fetchAqlPopup.bind(this)})},_openExternalContentPopup:function(e){var t=this,n=e.contentId,i=e.contentType,o=e.contentPairId,r=e.pageType,s=e.url;l.Render.ExternalContentPopup(n,i,o,r).then(function(e){return u.render({body:e}).then(function(e){e=e.body,e=a(e);t.firePopup(e,["superModal"]),c.trigger("initShareSaveEv",e)})}).catch(function(){return window.open(s,"_blank")})},_fetchAqlPopup:function(t,n){var i=this,e=n.entityId,o=n.entityType;l.Render.AqlContentPopup(e,o).then(function(e){u.render({body:e}).then(function(e){e=e.body;i._view.showAqlPopup(t,n,e)})})}})}),define("Socket",["underscore","jquery","Backbone","DataChest","Moment","External/sockjs-client"],function(u,i,e,n,r,o){function s(e){var t={};this.addNode=function(e){t[e.pId]||(t[e.pId]={callbacks:[],elements:{}}),e.finType&&e.$elem&&(t[e.pId].elements[e.finType]=(t[e.pId].elements[e.finType]||i()).add(e.$elem)),e.callback&&t[e.pId].callbacks.push(e.callback)},this.getIds=function(){return u.keys(t)},this.getEntry=function(e){return t[e]||t},this.removeNode=function(e){return delete t[e]},this.addNode(e)}var a={ask:"0.00",bid:"0.00",high:"199.82",last_close:"193.89",last_dir:"greenBg",low:"195.23",pc:"+5.83",pc_col:"greenFont",pcp:"+3.01%",time:"13:49:01",timestamp:1560865740,turnover:"4.95M",turnover_numeric:4947484},l={redBg:"red-bg",greenBg:"green-bg",greenFont:"u-up",redFont:"u-down"},t=i(document.body),c=!1;return new(e.EModel.extend({_sock:null,_isConnectionOpen:!1,_heartbeatIntervalCode:null,_subscriptions:{},_idsSubscribedInNode:{},_bulkSubscriptions:[],_finTypesAlternateNames:{"last-noblink":"last"},_attachedTables:[],initialize:function(){var i=this,e=this._openConnection();this.scanDOM(),e.then(function(){return i._sendBulkSubscription(i._getIdsForSubscription())}),this.config.isProduction||(window.trackPIdUpdates=function(e){return i.subscribe("pid",e,lcl)},window.simulateSocketUpdates=function(t,n){return setInterval(function(){var e=((n||199)+8*Math.random()).toFixed(2),e={dataObj:u.extend({last:e,last_numeric:+e,pId:""+t},a),pId:t,type:"pid"};i._dispatchIncomingMessage(e)},4096)},window.closeSocketConnection=function(){return i._sock.close()},window.testEventSocket=function(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:"404365";i._dispatchIncomingMessage({pId:e,type:"event",dataObj:{event_ID:e,actual_color:"greenFont",rev_from_col:"redFont",previous:"0.12%",forecast:"0.64%",actual:"0.65%",rev_from:"0.15%"}})})},subscribe:function(e,t,n,i){this._addToSubscriptionsAndSend(e,t,n,i)},subscribePair:function(e,t,n){this._addToSubscriptionsAndSend("pid",e,t,n)},unsubscribePair:function(e,t){this.unsubscribe("pid",e,t)},unsubscribe:function(e,t,n){e=this._subscriptions[e];return e&&(n?delete e.callbacks[u.findIndex(e.callbacks,n)]:e.removeNode(t)),this},attachTableData:function(e,t){var n={columnSettings:t,data:{}};u.e(e,function(e){n.data[e.pId]=e}),this._attachedTables.push(n)},_updateAttachedTables:function(i){u.e(this._attachedTables,function(n){n.data[i.pId]&&u.e(n.columnSettings,function(e,t){i.type.is(e.streamerType)&&(i.dataObj[e.finType]?n.data[i.pId][t]=u.getRawValue(i.dataObj[e.finType],e.finType):(c||announceWarn("Financial Type not supported in socket updates:",e.finType),c=!0))})})},_sendBulkSubscription:function(e){e&&this._sendDataToServer({_event:"bulk-subscribe",tzID:8,message:e})},_getIdsForSubscription:function(){var n=[];return u.e(this._subscriptions,function(e,t){u.e(e.getIds(),function(e){n.push("".concat(t,"-").concat(e,":"))})}),n.join("%%")},scanDOM:function(e){var o=this,e=e||t;u.e$(e.f(".js-streamable-element"),function(e){var t=e.data("s"),n=e.data("s-type")||"pid",i=e.data("s-financial-type")||"last";o._addToSubscriptionsAndSend(n,t,e,i)})},scanTables:function(e,a){var l=this;this._bulkSubscriptions=[],u.e$(e,function(e){var t={},n=e.find("tbody tr"),e=e.find(">thead>tr>th[data-stream-prefix][data-socket-key], >colgroup>col[data-stream-prefix][data-socket-key]");u.e$(e,function(e){return t[e.index()]={type:e.data("stream-prefix"),finType:e.data("socket-key"),targetSelector:e.data("target-class")?".".concat(e.data("target-class")):">*"}}),u.e$(n,function(r){var s=r.data("s");s&&u.e(t,function(e,t){var n,i=e.type,o=e.finType,e=e.targetSelector;i&&o&&(n=r.mF("td:eq(".concat(t,") ").concat(u.isFu(a)?"":e)),t=u.isFu(a)?function(e){return a(n,o,e)}:n,l._addToSubscriptions(i,s,t,o))})})}),this._sendBulkSubscription(this._bulkSubscriptions.join("%%"))},_addToSubscriptionsAndSend:function(e,t,n){var i=3<arguments.length&&void 0!==arguments[3]?arguments[3]:"last";this._bulkSubscriptions=[],this._addToSubscriptions(e,t,n,i),this._isConnectionOpen&&this._sendBulkSubscription(this._bulkSubscriptions.join("%%"))},_addToSubscriptions:function(e,t,n){n=_defineProperty({pId:t,type:e,finType:3<arguments.length&&void 0!==arguments[3]?arguments[3]:"last"},i.is$elem(n)?"$elem":"callback",n),t="".concat(e,"-").concat(t,":");this._subscriptions[e]?this._subscriptions[e].addNode(n):this._subscriptions[e]=new s(n),this._isConnectionOpen&&!this._idsSubscribedInNode[t]&&(this._idsSubscribedInNode[t]=!0,this._bulkSubscriptions.push(t))},_openConnection:function(){var t=this;return new Promise(function(e){t._sock=new o(n.get("socketUrl")+"/echo"),t._bindSocketEvents(e)})},_bindSocketEvents:function(e){var t=this;this._sock.onopen=function(){t._isConnectionOpen=!0,t._handleHeartbeats(),t._sendUID(),e(t._sock)},this._sock.onmessage=function(e){t._dispatchIncomingMessage(t._chewServerData(e))},this._sock.onclose=function(e){t._closeConnection()}},_chewServerData:function(e){var t,n,e=JSON.parse(e.data).message;return e&&(t=(e=_slicedToArray(e.match(/^(\w+)-(\d+(-\d+)*)::(.+)$/),5))[1],n=e[2],e=e[4],n={pId:n,type:t,dataObj:JSON.parse(e)}),n},_closeConnection:function(){var e=this;this._isConnectionOpen=!1,this._sock=null,clearInterval(this._heartbeatIntervalCode),setTimeout(function(){return e._openConnection().then(function(){return e._sendBulkSubscription(e._getIdsForSubscription())})},4e3)},_dispatchIncomingMessage:function(i){var e,t,o=this;i&&(e=(t=this._subscriptions[i.type].getEntry(i.pId)).elements,t=t.callbacks,u.e(e,function(e,t){var n=t.is("timestamp")?r.utcToLocal(i.dataObj.timestamp).hourOrDateFormat():i.dataObj[o._finTypesAlternateNames[t]||t];o._cleanNonExistentElements(e),e.textT(n),t.is("last")&&e.blinkClass(l[i.dataObj.last_dir],1e3),(e.hCl("u-up")||e.hCl("u-down"))&&e.removeAddClass("".concat("u-up"," ").concat("u-down"),l[i.dataObj.pc_col])}),this._updateAttachedTables(i),u.e(t,function(e){return e(i.dataObj,i.pId,i.type)}))},_cleanNonExistentElements:function(e){var n=[];u.e$(e,function(e,t){return!e.exists()&&n.push(t)}),u.extractByIndices(e,n)},_handleHeartbeats:function(){var e=this;this._heartbeatIntervalCode=setInterval(function(){e._sendDataToServer({_event:"heartbeat",data:"h"},!0)},5e3)},_sendDataToServer:function(e){this._sock&&this._sock.send(JSON.stringify(e))},_sendUID:function(){var e=n.get("user");u.isntE(e)&&this._sendDataToServer({_event:"UID",UID:e.user_ID})}}))}),function(e){"function"==typeof define&&define.amd?define("External/noUiSlider/nouislider",[],e):"object"===("undefined"==typeof exports?"undefined":_typeof(exports))?module.exports=e():window.noUiSlider=e()}(function(){var se="12.0.0";function s(e){return null!=e}function ae(e){e.preventDefault()}function d(e){return"number"==typeof e&&!isNaN(e)&&isFinite(e)}function le(e,t,n){0<n&&(de(e,t),setTimeout(function(){he(e,t)},n))}function ue(e){return Math.max(Math.min(e,100),0)}function ce(e){return Array.isArray(e)?e:[e]}function t(e){e=(e=String(e)).split(".");return 1<e.length?e[1].length:0}function de(e,t){e.classList?e.classList.add(t):e.className+=" "+t}function he(e,t){e.classList?e.classList.remove(t):e.className=e.className.replace(new RegExp("(^|\\b)"+t.split(" ").join("|")+"(\\b|$)","gi")," ")}function pe(e){var t=void 0!==window.pageXOffset,n="CSS1Compat"===(e.compatMode||"");return{x:t?window.pageXOffset:(n?e.documentElement:e.body).scrollLeft,y:t?window.pageYOffset:(n?e.documentElement:e.body).scrollTop}}function h(e,t){return 100/(t-e)}function p(e,t){return 100*t/(e[1]-e[0])}function a(e,t){for(var n=1;e>=t[n];)n+=1;return n}function n(e,t,n){var i,o,r;return n>=e.slice(-1)[0]?100:(r=a(n,e),i=e[r-1],e=e[r],o=t[r-1],t=t[r],o+(r=n,p(n=[i,e],n[0]<0?r+Math.abs(n[0]):r-n[0])/h(o,t)))}function i(e,t,n,i){var o,r,s;return 100===i?i:(r=e[(o=a(i,e))-1],s=e[o],n?(s-r)/2<i-r?s:r:t[o-1]?e[o-1]+(n=i-e[o-1],s=t[o-1],Math.round(n/s)*s):i)}function o(e,t,n){this.xPct=[],this.xVal=[],this.xSteps=[n||!1],this.xNumSteps=[!1],this.xHighestCompleteStep=[],this.snap=t;var i,o,r,s,a=[];for(i in e)e.hasOwnProperty(i)&&a.push([e[i],i]);for(a.length&&"object"===_typeof(a[0][0])?a.sort(function(e,t){return e[0][0]-t[0][0]}):a.sort(function(e,t){return e[0]-t[0]}),i=0;i<a.length;i++){l=c=u=l=void 0;var l=a[i][1],u=a[i][0],c=this;if("number"==typeof u&&(u=[u]),!Array.isArray(u))throw new Error("noUiSlider ("+se+"): 'range' contains invalid value.");if(!d(l="min"===l?0:"max"===l?100:parseFloat(l))||!d(u[0]))throw new Error("noUiSlider ("+se+"): 'range' value isn't numeric.");c.xPct.push(l),c.xVal.push(u[0]),l?c.xSteps.push(!isNaN(u[1])&&u[1]):isNaN(u[1])||(c.xSteps[0]=u[1]),c.xHighestCompleteStep.push(0)}for(this.xNumSteps=this.xSteps.slice(0),i=0;i<this.xNumSteps.length;i++)o=i,r=this.xNumSteps[i],s=this,r&&(s.xSteps[o]=p([s.xVal[o],s.xVal[o+1]],r)/h(s.xPct[o],s.xPct[o+1]),r=(s.xVal[o+1]-s.xVal[o])/s.xNumSteps[o],r=Math.ceil(Number(r.toFixed(3))-1),r=s.xVal[o]+s.xNumSteps[o]*r,s.xHighestCompleteStep[o]=r)}o.prototype.getMargin=function(e){var t=this.xNumSteps[0];if(t&&e/t%1!=0)throw new Error("noUiSlider ("+se+"): 'limit', 'margin' and 'padding' must be divisible by step.");return 2===this.xPct.length&&p(this.xVal,e)},o.prototype.toStepping=function(e){return e=n(this.xVal,this.xPct,e)},o.prototype.fromStepping=function(e){return t=this.xVal,n=this.xPct,100<=(e=e)?t.slice(-1)[0]:(r=a(e,n),i=t[r-1],t=t[r],o=n[r-1],n=n[r],(e-o)*h(o,n)*((r=[i,t])[1]-r[0])/100+r[0]);var t,n,i,o,r},o.prototype.getStep=function(e){return e=i(this.xPct,this.xSteps,this.snap,e)},o.prototype.getNearbySteps=function(e){e=a(e,this.xPct);return{stepBefore:{startValue:this.xVal[e-2],step:this.xNumSteps[e-2],highestStep:this.xHighestCompleteStep[e-2]},thisStep:{startValue:this.xVal[e-1],step:this.xNumSteps[e-1],highestStep:this.xHighestCompleteStep[e-1]},stepAfter:{startValue:this.xVal[e],step:this.xNumSteps[e],highestStep:this.xHighestCompleteStep[e]}}},o.prototype.countStepDecimals=function(){var e=this.xNumSteps.map(t);return Math.max.apply(null,e)},o.prototype.convert=function(e){return this.getStep(this.toStepping(e))};var l={to:function(e){return void 0!==e&&e.toFixed(2)},from:Number};function r(e){if("object"!==_typeof(e=e)||"function"!=typeof e.to||"function"!=typeof e.from)throw new Error("noUiSlider ("+se+"): 'format' requires 'to' and 'from' methods.")}function u(e,t){if(!d(t))throw new Error("noUiSlider ("+se+"): 'step' is not numeric.");e.singleStep=t}function c(e,t){if("object"!==_typeof(t)||Array.isArray(t))throw new Error("noUiSlider ("+se+"): 'range' is not an object.");if(void 0===t.min||void 0===t.max)throw new Error("noUiSlider ("+se+"): Missing 'min' or 'max' in 'range'.");if(t.min===t.max)throw new Error("noUiSlider ("+se+"): 'range' 'min' and 'max' cannot be equal.");e.spectrum=new o(t,e.snap,e.singleStep)}function f(e,t){if(t=ce(t),!Array.isArray(t)||!t.length)throw new Error("noUiSlider ("+se+"): 'start' option is incorrect.");e.handles=t.length,e.start=t}function m(e,t){if("boolean"!=typeof(e.snap=t))throw new Error("noUiSlider ("+se+"): 'snap' option must be a boolean.")}function _(e,t){if("boolean"!=typeof(e.animate=t))throw new Error("noUiSlider ("+se+"): 'animate' option must be a boolean.")}function g(e,t){if("number"!=typeof(e.animationDuration=t))throw new Error("noUiSlider ("+se+"): 'animationDuration' option must be a number.")}function v(e,t){var n,i=[!1];if("lower"===t?t=[!0,!1]:"upper"===t&&(t=[!1,!0]),!0===t||!1===t){for(n=1;n<e.handles;n++)i.push(t);i.push(!1)}else{if(!Array.isArray(t)||!t.length||t.length!==e.handles+1)throw new Error("noUiSlider ("+se+"): 'connect' option doesn't match handle count.");i=t}e.connect=i}function b(e,t){switch(t){case"horizontal":e.ort=0;break;case"vertical":e.ort=1;break;default:throw new Error("noUiSlider ("+se+"): 'orientation' option is invalid.")}}function y(e,t){if(!d(t))throw new Error("noUiSlider ("+se+"): 'margin' option must be numeric.");if(0!==t&&(e.margin=e.spectrum.getMargin(t),!e.margin))throw new Error("noUiSlider ("+se+"): 'margin' option is only supported on linear sliders.")}function w(e,t){if(!d(t))throw new Error("noUiSlider ("+se+"): 'limit' option must be numeric.");if(e.limit=e.spectrum.getMargin(t),!e.limit||e.handles<2)throw new Error("noUiSlider ("+se+"): 'limit' option is only supported on linear sliders with 2 or more handles.")}function S(e,t){if(!d(t)&&!Array.isArray(t))throw new Error("noUiSlider ("+se+"): 'padding' option must be numeric or array of exactly 2 numbers.");if(Array.isArray(t)&&2!==t.length&&!d(t[0])&&!d(t[1]))throw new Error("noUiSlider ("+se+"): 'padding' option must be numeric or array of exactly 2 numbers.");if(0!==t){if(Array.isArray(t)||(t=[t,t]),!(e.padding=[e.spectrum.getMargin(t[0]),e.spectrum.getMargin(t[1])])===e.padding[0]||!1===e.padding[1])throw new Error("noUiSlider ("+se+"): 'padding' option is only supported on linear sliders.");if(e.padding[0]<0||e.padding[1]<0)throw new Error("noUiSlider ("+se+"): 'padding' option must be a positive number(s).");if(100<=e.padding[0]+e.padding[1])throw new Error("noUiSlider ("+se+"): 'padding' option must not exceed 100% of the range.")}}function T(e,t){switch(t){case"ltr":e.dir=0;break;case"rtl":e.dir=1;break;default:throw new Error("noUiSlider ("+se+"): 'direction' option was not recognized.")}}function C(e,t){if("string"!=typeof t)throw new Error("noUiSlider ("+se+"): 'behaviour' must be a string containing options.");var n=0<=t.indexOf("tap"),i=0<=t.indexOf("drag"),o=0<=t.indexOf("fixed"),r=0<=t.indexOf("snap"),t=0<=t.indexOf("hover");if(o){if(2!==e.handles)throw new Error("noUiSlider ("+se+"): 'fixed' behaviour must be used with 2 handles");y(e,e.start[1]-e.start[0])}e.events={tap:n||r,drag:i,fixed:o,snap:r,hover:t}}function k(e,t){if(!1!==t)if(!0===t){e.tooltips=[];for(var n=0;n<e.handles;n++)e.tooltips.push(!0)}else{if(e.tooltips=ce(t),e.tooltips.length!==e.handles)throw new Error("noUiSlider ("+se+"): must pass a formatter for all handles.");e.tooltips.forEach(function(e){if("boolean"!=typeof e&&("object"!==_typeof(e)||"function"!=typeof e.to))throw new Error("noUiSlider ("+se+"): 'tooltips' must be passed a formatter or 'false'.")})}}function x(e,t){r(e.ariaFormat=t)}function M(e,t){r(e.format=t)}function P(e,t){if("boolean"!=typeof(e.keyboardSupport=t))throw new Error("noUiSlider ("+se+"): 'keyboardSupport' option must be a boolean.")}function A(e,t){e.documentElement=t}function E(e,t){if("string"!=typeof t&&!1!==t)throw new Error("noUiSlider ("+se+"): 'cssPrefix' must be a string or `false`.");e.cssPrefix=t}function D(e,t){if("object"!==_typeof(t))throw new Error("noUiSlider ("+se+"): 'cssClasses' must be an object.");if("string"==typeof e.cssPrefix)for(var n in e.cssClasses={},t)t.hasOwnProperty(n)&&(e.cssClasses[n]=e.cssPrefix+t[n]);else e.cssClasses=t}function fe(t){var n={margin:0,limit:0,padding:0,animate:!0,animationDuration:300,ariaFormat:l,format:l},i={step:{r:!1,t:u},start:{r:!0,t:f},connect:{r:!0,t:v},direction:{r:!0,t:T},snap:{r:!1,t:m},animate:{r:!1,t:_},animationDuration:{r:!1,t:g},range:{r:!0,t:c},orientation:{r:!1,t:b},margin:{r:!1,t:y},limit:{r:!1,t:w},padding:{r:!1,t:S},behaviour:{r:!0,t:C},ariaFormat:{r:!1,t:x},format:{r:!1,t:M},tooltips:{r:!1,t:k},keyboardSupport:{r:!0,t:P},documentElement:{r:!1,t:A},cssPrefix:{r:!0,t:E},cssClasses:{r:!0,t:D}},o={connect:!1,direction:"ltr",behaviour:"tap",orientation:"horizontal",keyboardSupport:!0,cssPrefix:"noUi-",cssClasses:{target:"target",base:"base",origin:"origin",handle:"handle",handleLower:"handle-lower",handleUpper:"handle-upper",horizontal:"horizontal",vertical:"vertical",background:"background",connect:"connect",connects:"connects",ltr:"ltr",rtl:"rtl",draggable:"draggable",drag:"state-drag",tap:"state-tap",active:"active",tooltip:"tooltip",pips:"pips",pipsHorizontal:"pips-horizontal",pipsVertical:"pips-vertical",marker:"marker",markerHorizontal:"marker-horizontal",markerVertical:"marker-vertical",markerNormal:"marker-normal",markerLarge:"marker-large",markerSub:"marker-sub",value:"value",valueHorizontal:"value-horizontal",valueVertical:"value-vertical",valueNormal:"value-normal",valueLarge:"value-large",valueSub:"value-sub"}},e=(t.format&&!t.ariaFormat&&(t.ariaFormat=t.format),Object.keys(i).forEach(function(e){if(!s(t[e])&&void 0===o[e]){if(i[e].r)throw new Error("noUiSlider ("+se+"): '"+e+"' is required.");return!0}i[e].t(n,(s(t[e])?t:o)[e])}),n.pips=t.pips,document.createElement("div")),r=void 0!==e.style.msTransform,e=void 0!==e.style.transform;n.transformRule=e?"transform":r?"msTransform":"webkitTransform";return n.style=[["left","top"],["right","bottom"]][n.dir][n.ort],n}function I(e,h,r){var a,s,l,u,c,i,d=window.navigator.pointerEnabled?{start:"pointerdown",move:"pointermove",end:"pointerup"}:window.navigator.msPointerEnabled?{start:"MSPointerDown",move:"MSPointerMove",end:"MSPointerUp"}:{start:"mousedown touchstart",move:"mousemove touchmove",end:"mouseup touchend"},L=window.CSS&&CSS.supports&&CSS.supports("touch-action","none")&&function(){var e=!1;try{var t=Object.defineProperty({},"passive",{get:function(){e=!0}});window.addEventListener("test",null,t)}catch(e){}return e}(),b=e,p=[],o=[],f=0,y=h.spectrum,m=[],_={},g=e.ownerDocument,v=h.documentElement||g.documentElement,w=g.body,B=-1,S=0,T=1,C=2,N="rtl"===g.dir||1===h.ort?0:100;function k(e,t){var n=g.createElement("div");return t&&de(n,t),e.appendChild(n),n}function R(e,t){return!!t&&k(e,h.cssClasses.connect)}function V(e,t){return!!h.tooltips[t]&&k(e.firstChild,h.cssClasses.tooltip)}function $(o,r,s){var a=g.createElement("div"),i=[],l=(i[S]=h.cssClasses.valueNormal,i[T]=h.cssClasses.valueLarge,i[C]=h.cssClasses.valueSub,[]),u=(l[S]=h.cssClasses.markerNormal,l[T]=h.cssClasses.markerLarge,l[C]=h.cssClasses.markerSub,[h.cssClasses.valueHorizontal,h.cssClasses.valueVertical]),c=[h.cssClasses.markerHorizontal,h.cssClasses.markerVertical];function d(e,t){var n=t===h.cssClasses.value;return t+" "+(n?u:c)[h.ort]+" "+(n?i:l)[e]}return de(a,h.cssClasses.pips),de(a,0===h.ort?h.cssClasses.pipsHorizontal:h.cssClasses.pipsVertical),Object.keys(o).forEach(function(e){var t,n,i;n=o[t=e][0],e=o[e][1],(e=r?r(n,e):e)!==B&&((i=k(a,!1)).className=d(e,h.cssClasses.marker),i.style[h.style]=t+"%",S<e&&((i=k(a,!1)).className=d(e,h.cssClasses.value),i.setAttribute("data-value",n),i.style[h.style]=t+"%",i.innerHTML=s.to(n)))}),a}function z(){var e;u&&((e=u).parentElement.removeChild(e),u=null)}function x(e){z();var h,p,f,m,_,g,v,t=e.mode,n=e.density||1,i=e.filter||!1,o=function(e,t,n){if("range"===e||"steps"===e)return y.xVal;if("count"===e){if(t<2)throw new Error("noUiSlider ("+se+"): 'values' (>= 2) required for mode 'count'.");var i=t-1,o=100/i;for(t=[];i--;)t[i]=i*o;t.push(100),e="positions"}return"positions"===e?t.map(function(e){return y.fromStepping(n?y.getStep(e):e)}):"values"===e?n?t.map(function(e){return y.fromStepping(y.getStep(y.toStepping(e)))}):t:void 0}(t,e.values||!1,e.stepped||!1),o=(h=n,p=t,f=o,m={},n=y.xVal[0],t=y.xVal[y.xVal.length-1],g=_=!1,v=0,(f=f.slice().sort(function(e,t){return e-t}).filter(function(e){return!this[e]&&(this[e]=!0)},{}))[0]!==n&&(f.unshift(n),_=!0),f[f.length-1]!==t&&(f.push(t),g=!0),f.forEach(function(e,t){var n,i,o,r,s,a,l,u=f[t+1],c="steps"===p,d=(d=c?y.xNumSteps[t]:d)||u-e;if(!1!==e&&void 0!==u)for(d=Math.max(d,1e-7),n=e;n<=u;n=+(n+d).toFixed(7)){for(l=(s=(o=y.toStepping(n))-v)/(a=Math.round(s/h)),i=1;i<=a;i+=1)m[(r=v+i*l).toFixed(5)]=[y.fromStepping(r),0];s=-1<f.indexOf(n)?T:c?C:S,!t&&_&&(s=0),n===u&&g||(m[o.toFixed(5)]=[n,s]),v=o}}),m),n=e.format||{to:Math.round};return u=b.appendChild($(o,i,n))}function U(){var e=j.getBoundingClientRect(),t="offset"+["Width","Height"][h.ort];return 0===h.ort?e.width||j[t]:e.height||j[t]}function M(i,o,r,s){function t(e){var t,n;return!!(e=function(e,t,n){var i,o=0===e.type.indexOf("touch"),r=0===e.type.indexOf("mouse"),s=0===e.type.indexOf("pointer");0===e.type.indexOf("MSPointer")&&(s=!0);if(o){o=function(e){return e.target===n||n.contains(e.target)};if("touchstart"===e.type){var a=Array.prototype.filter.call(e.touches,o);if(1<a.length)return!1;i=a[0].pageX,a=a[0].pageY}else{o=Array.prototype.find.call(e.changedTouches,o);if(!o)return!1;i=o.pageX,a=o.pageY}}t=t||pe(g),(r||s)&&(i=e.clientX+t.x,a=e.clientY+t.y);return e.pageOffset=t,e.points=[i,a],e.cursor=r||s,e}(e,s.pageOffset,s.target||o))&&(!(b.hasAttribute("disabled")&&!s.doNotReject)&&(t=b,n=h.cssClasses.tap,!((t.classList?t.classList.contains(n):new RegExp("\\b"+n+"\\b").test(t.className))&&!s.doNotReject)&&(!(i===d.start&&void 0!==e.buttons&&1<e.buttons)&&((!s.hover||!e.buttons)&&(L||e.preventDefault(),e.calcPoint=e.points[h.ort],void r(e,s))))))}var n=[];return i.split(" ").forEach(function(e){o.addEventListener(e,t,!!L&&{passive:!0}),n.push([e,t])}),n}function W(e){var t,n,i=ue(100*(e-(e=j,i=h.ort,t=e.getBoundingClientRect(),n=(e=e.ownerDocument).documentElement,e=pe(e),/webkit.*Chrome.*Mobile/i.test(navigator.userAgent)&&(e.x=0),i?t.top+e.y-n.clientTop:t.left+e.x-n.clientLeft))/U());return h.dir?100-i:i}function G(e,t){"mouseout"===e.type&&"HTML"===e.target.nodeName&&null===e.relatedTarget&&P(e,t)}function Y(e,t){if(-1===navigator.appVersion.indexOf("MSIE 9")&&0===e.buttons&&0!==t.buttonsProperty)return P(e,t);e=(h.dir?-1:1)*(e.calcPoint-t.startCalcPoint);Z(0<e,100*e/t.baseSize,t.locations,t.handleNumbers)}function P(e,t){t.handle&&(he(t.handle,h.cssClasses.active),--f),t.listeners.forEach(function(e){v.removeEventListener(e[0],e[1])}),0===f&&(he(b,h.cssClasses.drag),ee(),e.cursor&&(w.style.cursor="",w.removeEventListener("selectstart",ae))),t.handleNumbers.forEach(function(e){A("change",e),A("set",e),A("end",e)})}function H(e,t){if(1===t.handleNumbers.length){var n=a[t.handleNumbers[0]];if(n.hasAttribute("disabled"))return!1;n=n.children[0],f+=1,de(n,h.cssClasses.active)}e.stopPropagation();var i=[],o=M(d.move,v,Y,{target:e.target,handle:n,listeners:i,startCalcPoint:e.calcPoint,baseSize:U(),pageOffset:e.pageOffset,handleNumbers:t.handleNumbers,buttonsProperty:e.buttons,locations:p.slice()}),r=M(d.end,v,P,{target:e.target,handle:n,listeners:i,doNotReject:!0,handleNumbers:t.handleNumbers}),n=M("mouseout",v,G,{target:e.target,handle:n,listeners:i,doNotReject:!0,handleNumbers:t.handleNumbers});i.push.apply(i,o.concat(r,n)),e.cursor&&(w.style.cursor=getComputedStyle(e.target).cursor,1<a.length&&de(b,h.cssClasses.drag),w.addEventListener("selectstart",ae,!1)),t.handleNumbers.forEach(function(e){A("start",e)})}function q(e){e.stopPropagation();var n,i,o,t=W(e.calcPoint),r=(n=t,o=!(i=100),a.forEach(function(e,t){e.hasAttribute("disabled")||((e=Math.abs(p[t]-n))<i||100===e&&100===i)&&(o=t,i=e)}),o);if(!1===r)return!1;h.events.snap||le(b,h.cssClasses.tap,h.animationDuration),D(r,t,!0,!0),ee(),A("slide",r,!0),A("update",r,!0),A("change",r,!0),A("set",r,!0),h.events.snap&&H(e,{handleNumbers:[r]})}function Q(e){var e=W(e.calcPoint),e=y.getStep(e),t=y.fromStepping(e);Object.keys(_).forEach(function(e){"hover"===e.split(".")[0]&&_[e].forEach(function(e){e.call(l,t)})})}function X(e,t){_[e]=_[e]||[],_[e].push(t),"update"===e.split(".")[0]&&a.forEach(function(e,t){A("update",t)})}function A(n,i,o){Object.keys(_).forEach(function(e){var t=e.split(".")[0];n===t&&_[e].forEach(function(e){e.call(l,m.map(h.format.to),i,m.slice(),o||!1,p.slice())})})}function E(e,t,n,i,o,r){return 1<a.length&&(i&&0<t&&(n=Math.max(n,e[t-1]+h.margin)),o&&t<a.length-1&&(n=Math.min(n,e[t+1]-h.margin))),1<a.length&&h.limit&&(i&&0<t&&(n=Math.min(n,e[t-1]+h.limit)),o&&t<a.length-1&&(n=Math.max(n,e[t+1]-h.limit))),h.padding&&(0===t&&(n=Math.max(n,h.padding[0])),t===a.length-1&&(n=Math.min(n,100-h.padding[1]))),!((n=ue(n=y.getStep(n)))===e[t]&&!r)&&n}function K(e,t){var n=h.ort;return(n?t:e)+", "+(n?e:t)}function Z(e,n,i,t){var o=i.slice(),r=[!e,e],s=[e,!e],a=(t=t.slice(),e&&t.reverse(),1<t.length?t.forEach(function(e,t){t=E(o,e,o[e]+n,r[t],s[t],!1);!1===t?n=0:(n=t-o[e],o[e]=t)}):r=s=[!0],!1);t.forEach(function(e,t){a=D(e,i[e]+n,r[t],s[t])||a}),a&&t.forEach(function(e){A("update",e),A("slide",e)})}function J(e,t){return h.dir?100-e-t:e}function ee(){o.forEach(function(e){var t=50<p[e]?-1:1,t=3+(a.length+t*e);a[e].style.zIndex=t})}function D(e,t,n,i){return!1!==(t=E(p,e,t,n,i,!1))&&(n=t,p[i=e]=n,m[i]=y.fromStepping(n),n="translate("+K(J(n,0)-N+"%","0")+")",a[i].style[h.transformRule]=n,te(i),te(i+1),!0)}function te(e){var t,n;s[e]&&(n=100,t="translate("+K(J(t=(t=0)!==e?p[e-1]:t,n=(n=e!==s.length-1?p[e]:n)-t)+"%","0")+")",n="scale("+K(n/100,"1")+")",s[e].style[h.transformRule]=t+" "+n)}function I(e,t){var n=ce(e),e=void 0===p[0];t=void 0===t||!!t,h.animate&&!e&&le(b,h.cssClasses.tap,h.animationDuration),o.forEach(function(e){var t;D(e,(t=n[e],e=e,null===t||!1===t||void 0===t||("number"==typeof t&&(t=String(t)),t=h.format.from(t),!1===(t=y.toStepping(t))||isNaN(t))?p[e]:t),!0,!1)}),o.forEach(function(e){D(e,p[e],!0,!0)}),ee(),o.forEach(function(e){A("update",e),null!==n[e]&&t&&A("set",e)})}function ne(){var e=m.map(h.format.to);return 1===e.length?e[0]:e}de(e=b,h.cssClasses.target),0===h.dir?de(e,h.cssClasses.ltr):de(e,h.cssClasses.rtl),0===h.ort?de(e,h.cssClasses.horizontal):de(e,h.cssClasses.vertical);var j=k(e,h.cssClasses.base),ie=h.connect,oe=j,re=k(oe,h.cssClasses.connects);a=[],(s=[]).push(R(re,ie[0]));for(var t,n,F,O=0;O<h.handles;O++)a.push((n=O,F=void 0,t=k(t=oe,h.cssClasses.origin),(F=k(t,h.cssClasses.handle)).setAttribute("data-handle",n),h.keyboardSupport&&F.setAttribute("tabindex","0"),F.setAttribute("role","slider"),F.setAttribute("aria-orientation",h.ort?"vertical":"horizontal"),0===n?de(F,h.cssClasses.handleLower):n===h.handles-1&&de(F,h.cssClasses.handleUpper),t)),o[O]=O,s.push(R(re,ie[O+1]));return(c=h.events).fixed||a.forEach(function(e,t){M(d.start,e.children[0],H,{handleNumbers:[t]})}),c.tap&&M(d.start,j,q,{}),c.hover&&M(d.move,j,Q,{hover:!0}),c.drag&&s.forEach(function(e,t){var n,i,o;!1!==e&&0!==t&&t!==s.length-1&&(n=a[t-1],i=a[t],o=[e],de(e,h.cssClasses.draggable),c.fixed&&(o.push(n.children[0]),o.push(i.children[0])),o.forEach(function(e){M(d.start,e,H,{handles:[n,i],handleNumbers:[t-1,t]})}))}),I(h.start),l={destroy:function(){for(var e in h.cssClasses)h.cssClasses.hasOwnProperty(e)&&he(b,h.cssClasses[e]);for(;b.firstChild;)b.removeChild(b.firstChild);delete b.noUiSlider},steps:function(){return p.map(function(e,t){var n=y.getNearbySteps(e),t=m[t],i=n.thisStep.step,o=null,t=(!1!==i&&t+i>n.stepAfter.startValue&&(i=n.stepAfter.startValue-t),o=t>n.thisStep.startValue?n.thisStep.step:!1!==n.stepBefore.step&&t-n.stepBefore.highestStep,100===e?i=null:0===e&&(o=null),y.countStepDecimals());return null!==i&&!1!==i&&(i=Number(i.toFixed(t))),[o=null!==o&&!1!==o?Number(o.toFixed(t)):o,i]})},on:X,off:function(e){var i=e&&e.split(".")[0],o=i&&e.substring(i.length);Object.keys(_).forEach(function(e){var t=e.split(".")[0],n=e.substring(t.length);i&&i!==t||o&&o!==n||delete _[e]})},get:ne,set:I,reset:function(e){I(h.start,e)},__moveHandles:function(e,t,n){Z(e,t,p,n)},options:r,updateOptions:function(t,e){var n=ne(),i=["margin","limit","padding","range","animate","snap","step","format"],o=(i.forEach(function(e){void 0!==t[e]&&(r[e]=t[e])}),fe(r));i.forEach(function(e){void 0!==t[e]&&(h[e]=o[e])}),y=o.spectrum,h.margin=o.margin,h.limit=o.limit,h.padding=o.padding,h.pips&&x(h.pips),p=[],I(t.start||n,e)},target:b,removePips:z,pips:x},h.pips&&x(h.pips),h.tooltips&&(i=a.map(V),X("update",function(e,t,n){i[t]&&(e=e[t],!0!==h.tooltips[t]&&(e=h.tooltips[t].to(n[t])),i[t].innerHTML=e)})),X("update",function(e,t,r,n,s){o.forEach(function(e){var t=a[e],n=E(p,e,0,!0,!0,!0),i=E(p,e,100,!0,!0,!0),o=s[e],e=h.ariaFormat.to(r[e]),n=y.fromStepping(n).toFixed(1),i=y.fromStepping(i).toFixed(1),o=y.fromStepping(o).toFixed(1);t.children[0].setAttribute("aria-valuemin",n),t.children[0].setAttribute("aria-valuemax",i),t.children[0].setAttribute("aria-valuenow",o),t.children[0].setAttribute("aria-valuetext",e)})}),l}return{__spectrum:o,version:se,create:function(e,t){if(!e||!e.nodeName)throw new Error("noUiSlider ("+se+"): create requires a single element, got: "+e);if(e.noUiSlider)throw new Error("noUiSlider ("+se+"): Slider was already initialized.");return t=I(e,fe(t),t),e.noUiSlider=t}}}),define("text",["module"],function(e){var l,o,r,s,a,i=["Msxml2.XMLHTTP","Microsoft.XMLHTTP","Msxml2.XMLHTTP.4.0"],n=/^\s*<\?xml(\s)+version=[\'\"](\d)*.(\d)*[\'\"](\s)*\?>/im,u=/<body[^>]*>\s*([\s\S]+)\s*<\/body>/im,c="undefined"!=typeof location&&location.href,d=c&&location.protocol&&location.protocol.replace(/\:/,""),h=c&&location.hostname,p=c&&(location.port||void 0),f={},m=e.config&&e.config()||{};function _(e,t){return void 0===e||""===e?t:e}return l={version:"2.0.15",strip:function(e){var t;return e?(t=(e=e.replace(n,"")).match(u))&&(e=t[1]):e="",e},jsEscape:function(e){return e.replace(/(['\\])/g,"\\$1").replace(/[\f]/g,"\\f").replace(/[\b]/g,"\\b").replace(/[\n]/g,"\\n").replace(/[\t]/g,"\\t").replace(/[\r]/g,"\\r").replace(/[\u2028]/g,"\\u2028").replace(/[\u2029]/g,"\\u2029")},createXhr:m.createXhr||function(){var e,t,n;if("undefined"!=typeof XMLHttpRequest)return new XMLHttpRequest;if("undefined"!=typeof ActiveXObject)for(t=0;t<3;t+=1){n=i[t];try{e=new ActiveXObject(n)}catch(e){}if(e){i=[n];break}}return e},parseName:function(e){var t,n,i=!1,o=e.lastIndexOf("."),r=0===e.indexOf("./")||0===e.indexOf("../");return-1!==o&&(!r||1<o)?(t=e.substring(0,o),n=e.substring(o+1)):t=e,-1!==(o=(r=n||t).indexOf("!"))&&(i="strip"===r.substring(o+1),r=r.substring(0,o),n?n=r:t=r),{moduleName:t,ext:n,strip:i}},xdRegExp:/^((\w+)\:)?\/\/([^\/\\]+)/,useXhr:function(e,t,n,i){var o,r,e=l.xdRegExp.exec(e);return!e||(o=e[2],r=(e=(e=e[3]).split(":"))[1],e=e[0],(!o||o===t)&&(!e||e.toLowerCase()===n.toLowerCase())&&(!r&&!e||function(e,t,n,i){if(t===i)return!0;if(e===n){if("http"===e)return _(t,"80")===_(i,"80");if("https"===e)return _(t,"443")===_(i,"443")}return!1}(o,r,t,i)))},finishLoad:function(e,t,n,i){n=t?l.strip(n):n,m.isBuild&&(f[e]=n),i(n)},load:function(t,e,n,i){var o,r,s;i&&i.isBuild&&!i.inlineText||(m.isBuild=i&&i.isBuild,i=(o=l.parseName(t)).moduleName+(o.ext?"."+o.ext:""),r=e.toUrl(i),s=m.useXhr||l.useXhr,0===r.indexOf("empty:"))?n():!c||s(r,d,h,p)?l.get(r,function(e){l.finishLoad(t,o.strip,e,n)},function(e){n.error&&n.error(e)}):e([i],function(e){l.finishLoad(o.moduleName+"."+o.ext,o.strip,e,n)})},write:function(e,t,n,i){var o;f.hasOwnProperty(t)&&(o=l.jsEscape(f[t]),n.asModule(e+"!"+t,"define(function () { return '"+o+"';});\n"))},writeFile:function(n,e,t,i,o){var e=l.parseName(e),r=e.ext?"."+e.ext:"",s=e.moduleName+r,a=t.toUrl(e.moduleName+r)+".js";l.load(s,t,function(e){function t(e){return i(a,e)}t.asModule=function(e,t){return i.asModule(e,a,t)},l.write(n,s,t,o)},o)}},"node"===m.env||!m.env&&"undefined"!=typeof process&&process.versions&&process.versions.node&&!process.versions["node-webkit"]&&!process.versions["atom-shell"]?(o=require.nodeRequire("fs"),l.get=function(e,t,n){try{var i=o.readFileSync(e,"utf8");t(i="\ufeff"===i[0]?i.substring(1):i)}catch(e){n&&n(e)}}):"xhr"===m.env||!m.env&&l.createXhr()?l.get=function(n,i,o,e){var t,r=l.createXhr();if(r.open("GET",n,!0),e)for(t in e)e.hasOwnProperty(t)&&r.setRequestHeader(t.toLowerCase(),e[t]);m.onXhr&&m.onXhr(r,n),r.onreadystatechange=function(e){var t;4===r.readyState&&(399<(t=r.status||0)&&t<600?((t=new Error(n+" HTTP status: "+t)).xhr=r,o&&o(t)):i(r.responseText),m.onXhrComplete&&m.onXhrComplete(r,n))},r.send(null)}:"rhino"===m.env||!m.env&&"undefined"!=typeof Packages&&"undefined"!=typeof java?l.get=function(e,t){var n,i,e=new java.io.File(e),o=java.lang.System.getProperty("line.separator"),r=new java.io.BufferedReader(new java.io.InputStreamReader(new java.io.FileInputStream(e),"utf-8")),e="";try{for(n=new java.lang.StringBuffer,null!==(i=(i=r.readLine())&&i.length()&&65279===i.charAt(0)?i.substring(1):i)&&n.append(i);null!==(i=r.readLine());)n.append(o),n.append(i);e=String(n.toString())}finally{r.close()}t(e)}:("xpconnect"===m.env||!m.env&&"undefined"!=typeof Components&&Components.classes&&Components.interfaces)&&(r=Components.classes,s=Components.interfaces,Components.utils.import("resource://gre/modules/FileUtils.jsm"),a="@mozilla.org/windows-registry-key;1"in r,l.get=function(t,e){var n,i,o={};a&&(t=t.replace(/\//g,"\\")),t=new FileUtils.File(t);try{(n=r["@mozilla.org/network/file-input-stream;1"].createInstance(s.nsIFileInputStream)).init(t,1,0,!1),(i=r["@mozilla.org/intl/converter-input-stream;1"].createInstance(s.nsIConverterInputStream)).init(n,"utf-8",n.available(),s.nsIConverterInputStream.DEFAULT_REPLACEMENT_CHARACTER),i.readString(n.available(),o),i.close(),n.close(),e(o.value)}catch(e){throw new Error((t&&t.path||"")+": "+e)}}),l}),define("text!External/noUiSlider/nouisliderStyle.css",[],function(){return'/*! nouislider - 12.0.0 - 9/14/2018*/\n\n/*\n.noUi-target, .noUi-target * {\n\t-webkit-touch-callout: none;\n\t-webkit-tap-highlight-color: transparent;\n\t-webkit-user-select: none;\n\t-ms-touch-action: none;\n\ttouch-action: none;\n\t-ms-user-select: none;\n\t-moz-user-select: none;\n\tuser-select: none;\n\t-moz-box-sizing: border-box;\n\tbox-sizing: border-box\n}\n\n.noUi-target {\n\tposition: relative;\n\tdirection: ltr\n}\n\n.noUi-base, .noUi-connects {\n\twidth: 100%;\n\theight: 100%;\n\tposition: relative;\n\tz-index: 1\n}\n\n.noUi-connects {\n\toverflow: hidden;\n\tz-index: 0\n}\n\n.noUi-connect, .noUi-origin {\n\twill-change: transform;\n\tposition: absolute;\n\tz-index: 1;\n\ttop: 0;\n\tleft: 0;\n\theight: 100%;\n\twidth: 100%;\n\t-ms-transform-origin: 0 0;\n\t-webkit-transform-origin: 0 0;\n\ttransform-origin: 0 0\n}\n\nhtml:not([dir=rtl]) .noUi-horizontal .noUi-origin {\n\tleft: auto;\n\tright: 0\n}\n\n.noUi-vertical .noUi-origin {\n\twidth: 0\n}\n\n.noUi-horizontal .noUi-origin {\n\theight: 0\n}\n\n.noUi-handle {\n\tposition: absolute\n}\n\n.noUi-state-tap .noUi-connect, .noUi-state-tap .noUi-origin {\n\t-webkit-transition: transform .3s;\n\ttransition: transform .3s\n}\n\n.noUi-state-drag * {\n\tcursor: inherit !important\n}\n\n.noUi-horizontal {\n\theight: 18px\n}\n\n.noUi-horizontal .noUi-handle {\n\twidth: 34px;\n\theight: 28px;\n\tleft: -17px;\n\ttop: -6px\n}\n\n.noUi-vertical {\n\twidth: 18px\n}\n\n.noUi-vertical .noUi-handle {\n\twidth: 28px;\n\theight: 34px;\n\tleft: -6px;\n\ttop: -17px\n}\n\nhtml:not([dir=rtl]) .noUi-horizontal .noUi-handle {\n\tright: -17px;\n\tleft: auto\n}\n\n.noUi-target {\n\tbackground: #FAFAFA;\n\tborder-radius: 4px;\n\tborder: 1px solid #D3D3D3;\n\tbox-shadow: inset 0 1px 1px #F0F0F0, 0 3px 6px -5px #BBB\n}\n\n.noUi-connects {\n\tborder-radius: 3px\n}\n\n.noUi-connect {\n\tbackground: #3FB8AF\n}\n\n.noUi-draggable {\n\tcursor: ew-resize\n}\n\n.noUi-vertical .noUi-draggable {\n\tcursor: ns-resize\n}\n\n.noUi-handle {\n\tborder: 1px solid #D9D9D9;\n\tborder-radius: 3px;\n\tbackground: #FFF;\n\tcursor: default;\n\tbox-shadow: inset 0 0 1px #FFF, inset 0 1px 7px #EBEBEB, 0 3px 6px -3px #BBB\n}\n\n.noUi-active {\n\tbox-shadow: inset 0 0 1px #FFF, inset 0 1px 7px #DDD, 0 3px 6px -3px #BBB\n}\n\n.noUi-handle:after, .noUi-handle:before {\n\tcontent: "";\n\tdisplay: block;\n\tposition: absolute;\n\theight: 14px;\n\twidth: 1px;\n\tbackground: #E8E7E6;\n\tleft: 14px;\n\ttop: 6px\n}\n\n.noUi-handle:after {\n\tleft: 17px\n}\n\n.noUi-vertical .noUi-handle:after, .noUi-vertical .noUi-handle:before {\n\twidth: 14px;\n\theight: 1px;\n\tleft: 6px;\n\ttop: 14px\n}\n\n.noUi-vertical .noUi-handle:after {\n\ttop: 17px\n}\n\n[disabled] .noUi-connect {\n\tbackground: #B8B8B8\n}\n\n[disabled] .noUi-handle, [disabled].noUi-handle, [disabled].noUi-target {\n\tcursor: not-allowed\n}\n\n.noUi-pips, .noUi-pips * {\n\t-moz-box-sizing: border-box;\n\tbox-sizing: border-box\n}\n\n.noUi-pips {\n\tposition: absolute;\n\tcolor: #999\n}\n\n.noUi-value {\n\tposition: absolute;\n\twhite-space: nowrap;\n\ttext-align: center\n}\n\n.noUi-value-sub {\n\tcolor: #ccc;\n\tfont-size: 10px\n}\n\n.noUi-marker {\n\tposition: absolute;\n\tbackground: #CCC\n}\n\n.noUi-marker-sub {\n\tbackground: #AAA\n}\n\n.noUi-marker-large {\n\tbackground: #AAA\n}\n\n.noUi-pips-horizontal {\n\tpadding: 10px 0;\n\theight: 80px;\n\ttop: 100%;\n\tleft: 0;\n\twidth: 100%\n}\n\n.noUi-value-horizontal {\n\t-webkit-transform: translate(-50%, 50%);\n\ttransform: translate(-50%, 50%)\n}\n\n.noUi-rtl .noUi-value-horizontal {\n\t-webkit-transform: translate(50%, 50%);\n\ttransform: translate(50%, 50%)\n}\n\n.noUi-marker-horizontal.noUi-marker {\n\tmargin-left: -1px;\n\twidth: 2px;\n\theight: 5px\n}\n\n.noUi-marker-horizontal.noUi-marker-sub {\n\theight: 10px\n}\n\n.noUi-marker-horizontal.noUi-marker-large {\n\theight: 15px\n}\n\n.noUi-pips-vertical {\n\tpadding: 0 10px;\n\theight: 100%;\n\ttop: 0;\n\tleft: 100%\n}\n\n.noUi-value-vertical {\n\t-webkit-transform: translate(0, -50%);\n\ttransform: translate(0, -50%, 0);\n\tpadding-left: 25px\n}\n\n.noUi-rtl .noUi-value-vertical {\n\t-webkit-transform: translate(0, 50%);\n\ttransform: translate(0, 50%)\n}\n\n.noUi-marker-vertical.noUi-marker {\n\twidth: 5px;\n\theight: 2px;\n\tmargin-top: -1px\n}\n\n.noUi-marker-vertical.noUi-marker-sub {\n\twidth: 10px\n}\n\n.noUi-marker-vertical.noUi-marker-large {\n\twidth: 15px\n}\n\n.noUi-tooltip {\n\tdisplay: block;\n\tposition: absolute;\n\tborder: 1px solid #D9D9D9;\n\tborder-radius: 3px;\n\tbackground: #fff;\n\tcolor: #000;\n\tpadding: 5px;\n\ttext-align: center;\n\twhite-space: nowrap\n}\n\n.noUi-horizontal .noUi-tooltip {\n\t-webkit-transform: translate(-50%, 0);\n\ttransform: translate(-50%, 0);\n\tleft: 50%;\n\tbottom: 120%\n}\n\n.noUi-vertical .noUi-tooltip {\n\t-webkit-transform: translate(0, -50%);\n\ttransform: translate(0, -50%);\n\ttop: 50%;\n\tright: 120%\n}\n*/'}),define("Modules/TableFilters/SliderFilterView",["underscore","jquery","Backbone","Displayable","Moment","Toolset","External/noUiSlider/nouislider","text!External/noUiSlider/nouisliderStyle.css"],function(n,t,e,i,o,r,s,a){var l,u="is-error",c="timestamp",d="short_numeric",h=(_defineProperty(l={},c,{validator:function(e){return o.isValidDate(e)},formatToRawValue:function(e){return o.localFormattedToUTCUnix(e)/1e3},formatToDisplayText:function(e){return o.utcUnixToLocalFormatted(1e3*e)}}),_defineProperty(l,d,{validator:function(e){return r.FinancialData.is(d,e)},formatToRawValue:function(e){return r.FinancialData.getValue(d,e)},formatToDisplayText:function(e){return n.formatToBigNumber(n.roundDecimal(e))}}),l);return t.injectCSS(a),i.extend({_stepsObj:null,_isTimestamp:null,_functionsSet:null,_noUiSliderElm:null,_markupScheme:{filterIconButton:".js-column-filter-button",popup:".js-column-filter-popup",slider:".js-slider-input",maxInput:".js-max-input",minInput:".js-min-input",clearButton:".js-clear-filter",applyButton:".js-slider-filter-apply"},events:{"keyup .js-min-input":"_indicateInvalidity","keyup .js-max-input":"_indicateInvalidity","blur .js-min-input":"_setSliderValuesIfValid","blur .js-max-input":"_setSliderValuesIfValid"},initialize:function(e,t,n){i.prototype.initialize.call(this,e),this._stepsObj=t,this._isTimestamp=n.is(c),this._functionsSet=h[this._isTimestamp?c:d],this.render()},render:function(){var e=this;i.prototype.render.call(this),this._createSlider(),this._bindSliderEvents(),this._bindClickEvents(),this.setupPopup(this._dom.filterIconButton,this._dom.popup,{beforeOpen:function(){return e.trigger("filterOpen")},onClose:function(){return e._clearErrors()},overrideAlwaysTop:!0}),this._isTimestamp&&this._dom.maxInput.add(this._dom.minInput).aCl("is-wide")},destroy:function(){this._noUiSliderElm.destroy()},updateSteps:function(e){this._stepsObj=e,this._hackRanges(),this._noUiSliderElm.updateOptions({range:e})},setValues:function(e){this._noUiSliderElm.set(e)},_filterModified:function(e){this.$el.tCl("is-column-active",!!e),this.closePopupFromElement(this._dom.popup),this.trigger("filterModified",e)},_hackRanges:function(){this._stepsObj.min===this._stepsObj.max&&(14e8<this._stepsObj.max?this._stepsObj.max++:this._stepsObj.max+=1e-10)},_createSlider:function(){this._hackRanges(),this._noUiSliderElm=s.create(this._dom.slider[0],{start:[this._stepsObj.min,this._stepsObj.max],connect:!0,range:this._stepsObj})},_bindSliderEvents:function(){var i=this,o=[this._dom.minInput,this._dom.maxInput];this._noUiSliderElm.on("update",function(e,t,n){return o[t].val(i._functionsSet.formatToDisplayText(n[t]))})},_bindClickEvents:function(){var e=this;this._dom.clearButton.on("click",this._clearFilter.bind(this)),this._dom.applyButton.on("click",function(){return e._filterModified(e._noUiSliderElm.get())})},_indicateInvalidity:function(e){e=t(e.currentTarget);e.tCl(u,!this._functionsSet.validator(e.val())),this._dom.applyButton.disable(!this._isSelectionValid())},_setSliderValuesIfValid:function(){var e,t=this;this._isSelectionValid()&&(e=n.map([this._dom.minInput.val(),this._dom.maxInput.val()],function(e){return!e||e.is("-")?null:t._functionsSet.formatToRawValue(e)}),this.setValues(e))},_isSelectionValid:function(){return!this._dom.minInput.add(this._dom.maxInput).hCl(u)},_clearFilter:function(){this._noUiSliderElm.set([this._stepsObj.min,this._stepsObj.max]),this._filterModified()},_clearErrors:function(){this._dom.minInput.add(this._dom.maxInput).rCl(u),this._dom.applyButton.enable()}})}),define("Modules/TableFilters/SliderFilter",["underscore","jquery","Backbone","Toolset","./SliderFilterView"],function(u,e,i,t,n){function o(e,t){return e-t}return i.EModel.extend({_columnSettings:null,_minMaxValues:null,_stepsObj:null,_view:null,_values:null,initialize:function(e){var t=e.columnSettings,n=e.columnName,e=e.columnData;i.EModel.prototype.initialize.call(this),this._columnSettings=u.extend(t,{columnName:n}),this._minMaxValues=[],this._stepsObj={},this._setMinMaxValues(e),this._assignStepsObj(e),this._values=_toConsumableArray(this._minMaxValues),this._initView()},updateColumnData:function(e){this._setMinMaxValues(e.concat(this._minMaxValues)),this._assignStepsObj(e),this._view.updateSteps(this._stepsObj)},getName:function(){return this._columnSettings.columnName},validate:function(e,t){return e.between.apply(e,_toConsumableArray(t))},destroy:function(){this._view&&(this._view.unbindDOMEvents("filterIconButton"),this._view.destroy())},_initView:function(){var t=this;this._minMaxValues[0]<this._minMaxValues[1]?(this._view=new n(this._columnSettings.$th,this._stepsObj,this._columnSettings.dataType),this._view.on("filterModified",function(e){t._values=e,t.trigger("filterModified",t._columnSettings.columnName,e)}),this._view.on("filterOpen",function(){t._view.setValues(t._values),t.trigger("filterOpen")})):this._columnSettings.$th.mF(".js-column-filter-wrapper").hideEl()},_assignStepsObj:function(e){var t=_slicedToArray(this._minMaxValues,2),n=t[0],t=t[1],e=_toConsumableArray(new Set(e.sort(o)));this._stepsObj=this._buildStepsObject(e,n,t)},_setMinMaxValues:function(e){this._minMaxValues=[Math.floor(u.min(e)),Math.ceil(u.max(e))]},_buildStepsObject:function(e,t,n){for(var i=u.filter(e,u.isNu),o=Math.min(i.length,100),r=100/o,s=i.length/o,a={min:t,max:n},l=1;l<o;l++)a[l*r+"%"]=i[Math.floor(s*l)];return a}})}),define("Modules/TableFilters/MultiSelectFilterView",["underscore","jquery","Backbone","Displayable"],function(e,n,t,i){return i.extend({_markupScheme:{filterIconButton:".js-column-filter-button",popup:".js-column-filter-popup",saveButton:".js-save-filter-button",clearButton:".js-clear-button",checkboxes:".js-filter-checkbox"},initialize:function(e){i.prototype.initialize.call(this,e)},render:function(){i.prototype.render.call(this),this.setupPopup(this._dom.filterIconButton,this._dom.popup,{overrideAlwaysTop:!0}),this._bindClickEvents()},_bindClickEvents:function(){this._dom.saveButton.on("click",this._saveFilter.bind(this)),this._dom.clearButton.on("click",this._clearFilter.bind(this))},_saveFilter:function(){var t=[];e.e(this._dom.checkboxes,function(e){e=n(e);e.isChecked()&&t.push(e.data("value"))}),this._filterModified(!e.isE(t)&&t)},_clearFilter:function(){this._dom.checkboxes.uncheck()},_filterModified:function(e){this.$el.tCl("is-column-active",!!e),this.closePopupFromElement(this._dom.popup),this.trigger("filterModified",e)}})}),define("Modules/TableFilters/MultiSelectFilter",["underscore","jquery","Backbone","Toolset","./MultiSelectFilterView"],function(n,e,i,t,o){return i.EModel.extend({_columnSettings:null,_view:null,initialize:function(e){var t=e.columnSettings,e=e.columnName;i.EModel.prototype.initialize.call(this),this._columnSettings=n.extend(t,{columnName:e}),this._initView()},validate:function(e,t){return n.contains(t,e)},_initView:function(){var t=this;this._view=new o(this._columnSettings.$th),this._view.render(),this._view.on("filterModified",function(e){return t.trigger("filterModified",t._columnSettings.columnName,e)})}})}),define("Modules/TableFilters/TableFilters",["underscore","jquery","Backbone","Modules/TableFilters/SliderFilter","Modules/TableFilters/MultiSelectFilter"],function(s,e,t,n,i){var r={validate:function(e,t){return s.containsText(e,t)}},a={slider:n,multiSelect:i};return t.EModel.extend({_filterStates:null,_visibleRowsMap:null,_filterModels:null,initialize:function(e,t){var o=this;this.setToObjects("_visibleRowsMap","_filterModels","_filterStates"),this._tableData=e,s.e(t,function(e,t){var n,i=e.features.filterable;i.is("text")?o._filterModels[t]=r:i&&(s.isSizeGreaterThanOne(o._tableData)?(n=s.pluck(o._tableData,t),(n=new a[i]({columnSettings:e,columnName:t,columnData:n})).onMultiple({filterModified:o._filterModified.bind(o,i),filterOpen:o._openFilter.bind(o,t)}),o._filterModels[t]=n):e.$th.mF(".js-column-filter-wrapper").hideEl())}),this._visibleRowsMap=s.mapObject(this._tableData,function(){return!0})},destroy:function(){s.e(this._filterModels,function(e){return e.destroy&&e.destroy()})},hasActiveFilters:function(){return s.isntE(this._filterStates)},filterByText:function(e,t){this._filterModified("text",e,t)},_openFilter:function(e){var t,n=this;this._filterStates[e]||(t=s.pluck(s.filter(this._tableData,function(e,t){return n._visibleRowsMap[t]}),e),this._filterModels[e].updateColumnData(t))},_filterModified:function(e,t,n){n?this._filterStates[t]={type:e,filterValues:n}:delete this._filterStates[t],this._visibleRowsMap=this._getRowsToShowByFilterSettings(this._filterStates),this.trigger("applyFilterInViewEv",this._visibleRowsMap)},_getRowsToShowByFilterSettings:function(){var o=this,t=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{},r={};return s.e(this._tableData,function(n,e){var i=!0;s.e(t,function(e,t){n[t]&&(i&=o._filterModels[t].validate(n[t],e.filterValues))}),r[e]=i}),r}})}),define("Modules/Alerts/EventAlertsView",["underscore","jquery","Backbone","Displayable","EventBus","DataChest"],function(r,o,e,i,t,s){return i.extend({_tabs:null,_selectedEvents:null,_existingAlertsSettings:null,_existingAlertsCount:null,_preReminderDropdown:null,_$popupOpener:null,_markupScheme:{popupWrapper:".js-alert-popup-wrapper",searchWrapper:".js-search-wrapper","?alertsWrapper":'[data-screen-name="my-alerts"]',"?editAlertWrapper":'[data-screen-name="edit-alert"]',"?selectedEventTable":".js-selected-events-table","?selectedEventClone":".js-selected-event-clone","?popularEventTable":".js-popular-events-table","?existingAlertsTable":".js-existing-alerts-table","?tabButtons":".js-tab-button","?tabsContent":".js-tab-content","?alertsNumber":".js-alerts-number",createNumber:".js-create-number","?editAlertEventName":".js-edit-alert-event-name","?frequencyButtons":".js-frequency-button","?frequencyOnce":".js-frequency-once","?frequencyRecurring":".js-frequency-recurring","?remainderCheckbox":".js-mail-notification"},events:{"click .js-create-event-alert":"_createAlertInView","?click .js-add-alert-button":"_switchToAddAlertTab","click .js-alert-popup-closer":"closeAlertPopup","?click .js-edit-alert-save":"_updateAlertInView","?click .js-edit-alert-back":"_hideEditAlert","?click .js-edit-alert-delete":"_deleteAlertInView"},initialize:function(e,t){var n=2<arguments.length&&void 0!==arguments[2]?arguments[2]:[];i.prototype.initialize.call(this,e),this._existingAlertsSettings=s.get("alertsList"),this._selectedEvents=new Set(n),o.is$elem(t)&&(this._$popupOpener=t)},render:function(){var n=this;return i.prototype.render.call(this),this._dom.popularEventTable.exists()&&this._initPopularEventsTable(),this._dom.existingAlertsTable.exists()&&this._initExistingAlertsTable(),this._dom.selectedEventTable.exists()&&this._initSelectedEventsTable(),this.setupInstrumentSearch(this._dom.searchWrapper,function(e){var t=+e.dataID;n._selectedEvents.has(t)||(n._dom.selectedEventTable.mF("tbody").append(n._buildEconomicEventRow(e)),n._selectedEvents.add(t),n._updateCreateAlertCount(),n._dom.popupWrapper.f(".js-common-message")._hide())},"ec_event"),this._tabs=this.setupTabs(this._dom.tabButtons,this._dom.tabsContent),this.firePopup(this.$el,["modal"]),this.$el},closeAlertPopup:function(){this.closePopupFromElement(this.$el)},_initPopularEventsTable:function(){var i=this;r.e$(this._dom.popularEventTable.mF("tr"),function(e){var t=e.mF(".js-row-mark-checkbox"),n=e.data("event-id");t.isChecked()&&(i._selectedEvents.add(n),t.on("click",function(){return i._markEventRow(n)}))}),this._updateCreateAlertCount()},_initExistingAlertsTable:function(){var o=this,e=this._dom.existingAlertsTable.mF(".js-event-alert-row");this._existingAlertsCount=r.size(e),r.e$(e,function(e){var t=e.data(),n=t.alertId,i=t.eventId;e.mF(".js-event-alert-edit").on("click",function(){return o._openEditAlert(i,e)}),e.mF(".js-event-alert-toggle").on("click",function(e){return o._toggleAlertInView(n,i,e)}),e.mF(".js-event-alert-delete").on("click",function(){return o._deleteAlertInView(n,e)})})},_initSelectedEventsTable:function(){var i=this;r.e$(this._dom.selectedEventTable.mF("tr"),function(e){var t=e.mF(".js-row-mark-checkbox"),n=e.data("event-id");t.on("click",function(){return i._markEventRow(n)})})},_markEventRow:function(e){this._selectedEvents.has(e)?this._selectedEvents.delete(e):this._selectedEvents.add(e),this._updateCreateAlertCount()},_updateAlertsCount:function(e){this._dom.alertsNumber.textT(e)},_updateCreateAlertCount:function(){this._dom.createNumber.textT(this._selectedEvents.size)},_createAlertInView:function(){this._existingAlertsCount+=this._selectedEvents.size,this.trigger.apply(this,[this.isLoggedIn()?"createEventAlertEv":"saveEventAlertLoggedOutEv"].concat(_toConsumableArray(this._selectedEvents))),this.isLoggedIn()||this.popLoginSystemAlert(),this.isLoggedIn()&&this._$popupOpener&&this._setOpenerButtonText()},_setOpenerButtonText:function(){var e=0<this._existingAlertsCount;e&&this._existingAlertsCount<=9&&this._$popupOpener.mF(".js-alerts-sum").textT(this._existingAlertsCount),this._$popupOpener.mF(".js-my-alerts-title")._toggleShow(e),this._$popupOpener.mF(".js-alerts-sum")._toggleShow(e),this._$popupOpener.mF(".js-add-alert-title")._toggleShow(!e),this._$popupOpener.tCl("common-button",!e),this._$popupOpener.tCl("common-button-1",e)},_openEditAlert:function(e,t){var n=this._existingAlertsSettings[e];this._initEditAlert(n,e,t),this._showEditAlert()},_initEditAlert:function(e,t,n){var i=e.Name,o=e.Frequency,r=e.PreReminderTime,e=e.row_ID;this._dom.editAlertEventName.textT(i),this._dom.frequencyButtons.uncheck(),this._dom["Once"===o?"frequencyOnce":"frequencyRecurring"].check(),this._preReminderDropdown=this.setupDropdown(this._dom.editAlertWrapper.mF(".js-dropdown-container")),r&&"none"!==r?(this._dom.remainderCheckbox.check(),this._preReminderDropdown.setValue(r)):this._dom.remainderCheckbox.uncheck(),this._currentEventAlert={eventId:t,$tr:n,alertId:e}},_showEditAlert:function(){this._dom.alertsWrapper._hide(),this._dom.editAlertWrapper._show()},_hideEditAlert:function(){this._dom.alertsWrapper._show(),this._dom.editAlertWrapper._hide()},_updateAlertInView:function(){var e={alertId:this._currentEventAlert.alertId,active:1,frequency:this._dom.frequencyButtons.getChecked().val(),reminder:this._dom.remainderCheckbox.isChecked()?this._preReminderDropdown.getValue():"none"};this._updateExistingAlertSettings(this._currentEventAlert.eventId,e),this.trigger("updateEventAlertEv",e),this._hideEditAlert()},_updateExistingAlertSettings:function(e,t){e=this._existingAlertsSettings[e];e.Frequency=t.frequency,e.PreReminderTime=t.reminder},_toggleAlertInView:function(e,t,n){var n=o(n.currentTarget).isChecked(),t=this._existingAlertsSettings[t],i=t.Frequency,t=t.PreReminderTime;this.trigger("updateEventAlertEv",{alertId:e,active:+n,frequency:i,reminder:t})},_deleteAlertInView:function(e,t){(t||this._currentEventAlert.$tr).remove(),this._existingAlertsCount--,this.trigger("deleteEventAlertEv",r.isNu(e)?e:this._currentEventAlert.alertId),this._updateAlertsCount(this._existingAlertsCount),this._hideEditAlert(),this._$popupOpener&&this._setOpenerButtonText()},_buildEconomicEventRow:function(e){var t=this,n=this._dom.selectedEventClone.clone().rCl("js-selected-event-clone");return n.data("event-id",e.dataID),n.mF(".js-item-flag").aCl("flag-".concat(r.toLowerCase(e.flag))),n.mF(".js-item-name").textT(e.name).attr("title",e.name),n.mF(".js-item-star").slice(+e.importance,3).remove(),n.mF(".js-row-mark-checkbox").on("click",function(){return t._markEventRow(+e.dataID)}),n._show(),n},_switchToAddAlertTab:function(){var e=this._dom.tabButtons.filter('[data-tab-name="add"]'),e=this._dom.tabButtons.index(e);this._tabs.switchToTab(e)}})}),define("Modules/Alerts/EventAlerts",["underscore","jquery","Backbone","Server","DataChest","ActionQueue","./EventAlertsView"],function(o,e,t,r,s,i,a){return t.EModel.extend({initialize:function(e,t,n){e&&(this._view=new a(e,t,n),this._view.onMultiple({createEventAlertEv:this.createAlert.bind(this),saveEventAlertLoggedOutEv:this._savePreLoginAlert.bind(this),updateEventAlertEv:this.updateAlert.bind(this),deleteEventAlertEv:this.deleteAlert.bind(this)}))},render:function(){this._view.render()},createAlert:function(){for(var t=this,e=arguments.length,n=new Array(e),i=0;i<e;i++)n[i]=arguments[i];r.EconomicCalendarAlerts.Add(n).then(function(){var e=s.getTranslation("EC_ALERT_CONFIRMATION");t.popSystemAlert(e,2e3),o.tryRunProp(t._view,"closeAlertPopup")})},updateAlert:function(e){var t=e.alertId,n=e.active,i=e.frequency,e=e.reminder;r.EconomicCalendarAlerts.Update(t,n,i,e)},deleteAlert:function(e){r.EconomicCalendarAlerts.Delete(e)},_savePreLoginAlert:function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];i.pushAction({eventTrigger:"afterDynamicPage",eventName:"createEventAlertFromQueueEv",eventParams:[[].concat(t)]})}})}),define("Modules/Alerts/AlertActionsFormView",["underscore","jquery","Backbone","Displayable"],function(i,e,t,n){return n.extend({_tabName:null,_params_to_option_map:{price:{change_percent:{both:1,over:2,under:3},price:{over:4,under:5}}},_option_to_params_map:{price:{1:{threshold:"both",trigger:"change_percent"},2:{threshold:"over",trigger:"change_percent"},3:{threshold:"under",trigger:"change_percent"},4:{threshold:"over",trigger:"price"},5:{threshold:"under",trigger:"price"}}},initialize:function(e){n.prototype.initialize.call(this,e)},render:function(){return n.prototype.render.call(this),this.$el},prepareAlertParamsForSubmit:function(e){var t=this._getCommonParams(),n=this.getTabParams();return e&&(t.existingAlertId=e),i.extend({},t,n)},fillExistingAlertDataInForm:function(e){this._fillExistingAlertData(e),this._setDeliveryCheckboxes(e.deliveryMail),this.$el.showEl()},_setDeliveryCheckboxes:function(e){i.isntUn(e)&&this._dom.deliveryMail.toggleCheck(e)},_getCommonParams:function(){return{alertType:this._tabName,deliveryMail:this._dom.deliveryMail.isChecked()?"Yes":"No",deliveryApp:this._dom.deliveryApp.isChecked()?"Yes":"No"}}})}),define("Modules/Alerts/AlertActionsPriceFormView",["underscore","jquery","Backbone","Modules/Alerts/AlertActionsFormView"],function(i,e,t,n){var o=[3,4],r=[0],s=[1,2,3];return n.extend({_tabDefaults:null,_conditionDropdown:null,_markupScheme:{frequencyButtons:".js-frequency-button",frequencyOnce:".js-frequency-once",frequencyRecurring:".js-frequency-recurring",deliveryMail:".js-mail-notification",deliveryApp:".js-app-notification",dropdown:".js-dropdown-popup",dropdownList:".js-dropdown-popup li",conditionDropdownButton:".js-alert-dropdown-button",alertValueInput:".js-alert-value",inputsWrapper:".js-fields-container",percentSign:".js-percent-sign",frequencyWrapper:".js-frequency-wrapper"},initialize:function(e){n.prototype.initialize.call(this,e),this._tabName="price",this._tabDefaults={}},render:function(){return n.prototype.render.call(this),this._setTabDefaults(),this._initConditionDropdown(),this.$el},setupFormSinglePairStandard:function(){this._prepareStandardTab(),this.$el.showEl()},setupFormMultiPair:function(){this._prepareStandardTab(),this._dom.alertValueInput.val(this._dom.dropdownList.first().data("defaultValue")),this._dom.conditionDropdownButton.text(this._tabDefaults.dropdownButtonText),this.$el.showEl()},toggleDropdownOptions:function(e,t){this._conditionDropdown.toggleOptions(t?[]:e.is("singleMulti")?o:r)},getTabParams:function(){var e=this._conditionDropdown.getValue();return{alertDirection:e,threshold:this._option_to_params_map[this._tabName][e].threshold,alertTrigger:this._option_to_params_map[this._tabName][e].trigger,alertValue:this._dom.alertValueInput.valT(),frequency:this._dom.frequencyButtons.getChecked().val()}},_setTabDefaults:function(){var e=this._dom.dropdown.data("default-option");this._tabDefaults.dropdownButtonText=this._dom.inputsWrapper.mF('[data-value="'.concat(e,'"]')).textT(),this._tabDefaults.dropdownDefaultValue=e},_initConditionDropdown:function(){this._conditionDropdown=this.setupDropdown(this._dom.inputsWrapper.mF(".js-dropdown-container")),this._conditionDropdown.on("dropdownChangeEv",this._editConditionInput.bind(this))},_editConditionInput:function(e,t,n){this._dom.frequencyWrapper.toggleEl(i.isIn(s,e)),this._dom.percentSign._toggleShow("percent"===n.inputType),this._dom.alertValueInput.tCl("is-percent","percent"===n.inputType),this._dom.alertValueInput.val(n.defaultValue||this.ask("getLastNumericQ"))},_prepareStandardTab:function(){this._dom.deliveryMail.toggleEl(this.isLoggedIn()),this._setDeliveryCheckboxes(!1),this._conditionDropdown.setValue(this._tabDefaults.dropdownDefaultValue,!0);var e=this._dom.dropdownList.first();this._editConditionInput(this._tabDefaults.dropdownDefaultValue,e.textT(),e.data()),this._dom.frequencyRecurring.check(),this._dom.dropdown._hide()},_fillExistingAlertData:function(e){var t=this._params_to_option_map.price[e.alert_trigger][e.conditionType],n=(this._conditionDropdown.setValue(t,!0),this._dom.dropdownList.getSelected());this._editConditionInput(t,n.textT(),n.data()),this._dom.alertValueInput.val(Math.abs(+e.conditionValue)),this._dom[e.frequency?"frequencyOnce":"frequencyRecurring"].check()}})}),define("Modules/Alerts/AlertActionsEarningsFormView",["underscore","jquery","Backbone","Modules/Alerts/AlertActionsFormView"],function(t,e,n,i){return i.extend({_markupScheme:{deliveryMail:".js-mail-notification",deliveryApp:".js-app-notification",toggleFollow:".js-toggle-follow",followTypes:".js-earnings-follow-types input",followOnce:".js-follow-once",followRecurring:".js-follow-recurring",reminder:".js-earnings-reminder",disabilityToggleElements:".js-earnings-toggle-disability"},events:{"change .js-toggle-follow":"_toggleEarningsDisability"},initialize:function(e){i.prototype.initialize.call(this,e),this._tabName="earnings"},render:function(){return i.prototype.render.call(this),this.$el},setupFormSinglePairEarnings:function(e){this.fillExistingAlertDataInForm(t.omit(e,"deliveryMail")),this._toggleEarningsDisability(),this.$el.showEl()},getTabParams:function(){return{alertStatus:+this._dom.toggleFollow.isChecked(),followType:this._dom.followTypes.getChecked().val(),reminder:this._dom.reminder.isChecked()}},_fillExistingAlertData:function(e){this._dom[e.followType?"followOnce":"followRecurring"].check(),this._dom.reminder.toggleCheck(e.reminder),this._dom.toggleFollow.toggleCheck(e.alertStatus)},_toggleEarningsDisability:function(){this._dom.deliveryMail.toggleEl(this.isLoggedIn()),this._dom.disabilityToggleElements.disable(!this._dom.toggleFollow.isChecked())}})}),define("Modules/Alerts/AlertActionsManageView",["underscore","jquery","Backbone","Displayable"],function(n,t,e,i){return i.extend({_markupScheme:{alertListContent:".js-alert-list-content",noAlertsExistContent:".js-no-alerts-content",existingAlertItem:".js-alert-table tbody tr",alertListTableBody:".js-alert-list-content .js-alert-table tbody"},events:{"click .js-first-alert-button":"_triggerCreateSingleAlert","click .js-alert-status input":"_toggleAlertLineStatus","click .js-edit-alert":"_editAlertLine"},initialize:function(e){i.prototype.initialize.call(this,e)},render:function(){return i.prototype.render.call(this),this.$el},showExistingAlertsList:function(e){this._populateExistingAlertsTable(e),this._dom.alertListContent.showEl(),this._dom.noAlertsExistContent._hide(),this.$el.showEl()},showNoExistingAlerts:function(){this._dom.alertListContent._hide(),this._dom.noAlertsExistContent.showEl(),this.$el.showEl()},highlightNewLines:function(e){this._dom.alertListTableBody.mF("tr").slice(0,e?1:2).blinkClass("u-new-highlight",2e3)},_populateExistingAlertsTable:function(e){var t=this;this._dom.alertListTableBody.empty(),n.e(e,function(e){return t._dom.alertListTableBody.append(t._prepareAlertTableRow(e))})},_prepareAlertTableRow:function(e){var t=this._dom.existingAlertItem.clone();return t.mF(".js-edit-alert, .js-alert-status input").attr("data-alert-id",e.alertId),t.mF(".js-description").text(e.alertDescription),t.mF(".js-last-triggered").text(e.lastUpdate),t.mF(".js-alert-status input").prop("checked",!!e.alertStatus),t},_editAlertLine:function(e){this.trigger("alertLineEditButtonClicked",t(e.currentTarget).data("alert-id"))},_toggleAlertLineStatus:function(e){e=t(e.currentTarget);this.trigger("toggleAlertStatusEv",{alertId:e.data("alert-id"),isToggled:+e.isChecked()})},_triggerCreateSingleAlert:function(){this.trigger("createFirstAlertClicked")}})}),define("Modules/Alerts/AlertActionsHeaderView",["underscore","jquery","Backbone","Displayable"],function(e,t,n,i){return i.extend({_currentDirectionClass:null,_markupScheme:{headerTitle:".js-alerts-header-title",tabs:".js-popup-tabs",singlePairHeader:".js-single-header",pairName:".js-alert-popup-pair-name .js-text",pairData:".js-alert-single-pair-data",price:".js-price .js-text",priceChange:".js-change .js-text",priceChangePercent:".js-change-percent .js-text",flag:".js-alert-popup-pair-name .js-flag"},events:{},initialize:function(e){i.prototype.initialize.call(this,e)},render:function(){return i.prototype.render.call(this),this.$el},toggleSinglePairHeader:function(e,t){this.toggleHeaderTitle(e,!e),this._dom.singlePairHeader.toggleEl(e),t&&this._dom.singlePairHeader.text(t)},toggleHeaderTitle:function(e,t){this._dom.headerTitle.toggleEl(e).tCl("u-no-sep",t)},toggleTabs:function(e){this._dom.tabs.toggleEl(e)},populateSinglePairHeader:function(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{},t=e.name,n=e.flag,i=e.last,o=e.change,e=e.change_percent,r=0<e;this._dom.pairName.text(t),this._setHeaderFlag(n),this._setHeaderColorClass(r?"green":"red"),this._dom.price.text(i),this._dom.priceChange.text(o),this._dom.priceChangePercent.text("(".concat(e,"%)"))},_setHeaderFlag:function(e){e=e.toLowerCase();this._dom.flag.removeFlagClass().aCl("flag-"+e).attr("aria-label",e)},_setHeaderColorClass:function(e){this._dom.pairData.removeAddClass(this._currentDirectionClass,e),this._currentDirectionClass=e}})}),define("Modules/Alerts/AlertActionsView",["underscore","jquery","Backbone","Modules/Alerts/AlertActionsPriceFormView","Modules/Alerts/AlertActionsEarningsFormView","Modules/Alerts/AlertActionsManageView","Modules/Alerts/AlertActionsHeaderView","Displayable"],function(n,e,t,i,o,r,s,a){var l="Create Price Alert";return a.extend({_alertForms:null,_manageAlerts:null,_isSinglePair:null,_selectedTab:null,_existingAlerts:null,_deletePopupInit:null,_currentEditedAlert:null,_defaultTab:null,_defaultTabIndex:null,_alertsPopupHeader:null,_tabsController:null,_existingEarningsAlertId:null,_defaultFollowText:null,_numericLastPrice:null,_bubbleEvents:{_manageAlerts:"toggleAlertStatusEv"},_markupScheme:{allTabInnerContainers:".js-alert-popup-form-container, .js-manage-alerts",deleteAlertPopup:".js-alert-delete-popup",header:".js-alerts-header",mainContent:".js-alert-popup-form-container",allFooters:".js-alerts-footer",mainFooter:".js-alerts-main-footer",earningsFooter:".js-earnings-footer",addNewAlertFooter:".js-add-new-footer",editAlertFooter:".js-edit-alert-footer",editAlertButton:".js-save-edited-alert",backButtonCreate:".js-alerts-main-footer .js-alert-back-button",createSingleEarningsButton:".js-create-single-earnings-button",singlePairElements:"[data-single-alert]",bulkAlertElements:"[data-multi-alert]",cancelDeleteButton:".js-alert-delete-popup .js-cancel-delete",confirmDeleteButton:".js-alert-delete-popup .js-confirm-delete",mainTabs:".js-alert-popup-tab",mainTabLabels:".js-alert-popup-tab .js-tab-label",followText:".js-follow-text"},events:{"click .js-alert-popup-closer, .js-cancel-alert-button":"_closeAlertsPopup","click .js-alert-back-button":"_hideCreateAlert","click .js-create-multi-button, .js-create-single-button, .js-create-single-earnings-button":"_saveAlert","click .js-create-new-alert":"_showCreateSingleAlert","click .js-save-edited-alert":"_saveExistingAlertChanges","click .js-delete-alert":"_showDeleteDialog","?change .js-toggle-follow":"_toggleEarningsButtonDisability"},initialize:function(e){a.prototype.initialize.call(this,e),this._defaultTab=this.$el.data("default-tab"),this._defaultTabIndex=this.$el.mF('.js-alert-popup-tab[data-tab-name="'.concat(this._defaultTab,'"]')).index()},render:function(){return a.prototype.render.call(this),this._initHeader(),this._initAlertForms(),this._initManageAlerts(),this._tabsController=this.setupTabs(this._dom.mainTabLabels,null,{customHandler:this._switchToTabByIndex.bind(this)}),this._defaultFollowText=this._dom.followText.text(),this._existingAlerts={},this._dom.cancelDeleteButton.on("click",this._cancelDelete.bind(this)),this._dom.confirmDeleteButton.on("click",this._confirmDelete.bind(this)),this.delegateBubbling(),this.$el.detach()},highlightNewAlerts:function(e){this._manageAlerts.highlightNewLines(e)},initSingleAlert:function(e){this._updateExistingAlerts(e),this._isSinglePair=!0,this.switchToDefaultTab(),this._toggleSingleState(!0),this._defaultTab.is("earnings")?this._showEarningsAlert():this.showAlertsList(this._defaultTab),this._alertsPopupHeader.populateSinglePairHeader(e.pairData),this._alertsPopupHeader.toggleTabs(!0),this._instrumentNames=e.pairData.name,this._numericLastPrice=e.pairData.last_numeric,this._dom.followText.text(this._defaultFollowText),this._dom.followText.replaceDefine(this._instrumentNames),this._dom.mainTabs.filter('[data-tab-name="earnings"]')._toggleShow("Equities"===e.pairData.type),this.firePopup(this.$el,["modal"])},initMultiAlert:function(e){this._isSinglePair=!1,this.switchToDefaultTab(),this._toggleSingleState(!1),this._alertsPopupHeader.toggleHeaderTitle(!0,!0),this._alertsPopupHeader.toggleTabs(!0),this.setupMultiAlertTab(this._defaultTab),this._instrumentNames=e.sort().join(","),this._populateMultiPairList(e),this.firePopup(this.$el,["modal"])},updateEarningsAlert:function(e){var t=e.existingAlertId,n=e.alertStatus,i=e.followType,e=e.reminder;this._existingAlerts.earnings={alertId:t,alertStatus:n,deliveryApp:1,deliveryMail:1,followType:+("Recurring"!==i),reminder:e}},setupMultiAlertTab:function(e){this._selectedTab=e,this._hideFootersAndContainers(),this._dom.mainFooter.showEl(),this._getForm(e).setupFormMultiPair()},switchToDefaultTab:function(){this._tabsController.switchToTab(this._defaultTabIndex),this._selectedTab=this._defaultTab},showAlertsList:function(e,t){return this._selectedTab=e,t&&this._updateExistingAlerts(t),this._hideFootersAndContainers(),this._alertsPopupHeader.toggleSinglePairHeader(!1),t=this._existingAlerts[e],n.isntE(t)?(this._dom.addNewAlertFooter.showEl(),this._manageAlerts.showExistingAlertsList(t)):this._manageAlerts.showNoExistingAlerts(),this},updateToggledAlert:function(e){n.findWhere(this._existingAlerts[this._selectedTab],{alertId:""+e.alertId}).alertStatus=e.isToggled},getInstrumentNames:function(){return this._instrumentNames},_updateExistingAlerts:function(e){this._existingAlerts.price=e.price,this._existingAlerts.pairData=e.pairData,this._existingAlerts.earnings||(this._existingAlerts.earnings=e.earnings)},_switchToTabByIndex:function(e){e=this._dom.mainTabs.eq(e).data("tab-name");this._isSinglePair?e.is("earnings")?this._showEarningsAlert():this.showAlertsList(e):this.setupMultiAlertTab(e)},_closeAlertsPopup:function(){this.closePopupFromElement(this.$el)},_initHeader:function(){this._alertsPopupHeader=new s(this._dom.header),this._alertsPopupHeader.render()},_hideFootersAndContainers:function(){this._alertsPopupHeader.toggleTabs(!0),this._dom.allFooters._hide(),this._dom.allTabInnerContainers._hide()},_initAlertForms:function(){var e=this;this._alertForms={price:new i(this._dom.mainContent.filter('[data-tab-name="price"]')),earnings:new o(this._dom.mainContent.filter('[data-tab-name="earnings"]'))},this._alertForms.price.answer("getLastNumericQ",function(){return e._numericLastPrice}),n.e(this._alertForms,function(e){return e.render()})},_initManageAlerts:function(){this._manageAlerts=new r(this.$el.mF(".js-manage-alerts")),this._manageAlerts.render(),this._manageAlerts.onMultiple({createFirstAlertClicked:this._showCreateSingleAlert.bind(this),alertLineEditButtonClicked:this._showEditAlert.bind(this)})},_showCreateSingleAlert:function(){var e=this._getForm(this._selectedTab);this._hideFootersAndContainers(),this._selectedTab.is("price")&&e.toggleDropdownOptions("",!0),this._dom.mainFooter.mF(".js-create-single-button").text(l),this._showAndEditCommonActions(l,"mainFooter",!0,!1),e.setupFormSinglePairStandard(),this.trigger("createNewAlertGTMEv")},_showEditAlert:function(e){var t=this._getForm(this._selectedTab);this._selectedTab.is("price")&&t.toggleDropdownOptions("editCreate",!1),this._currentEditedAlert=e,this._dom.editAlertButton.text("Save Price Alert"),this._hideFootersAndContainers(),this._showAndEditCommonActions("Edit Price Alert","editAlertFooter",!0,!1),t.fillExistingAlertDataInForm(this._getAlertDataById(e))},_showEarningsAlert:function(){var e;this._selectedTab="earnings",this._hideFootersAndContainers(),e=this._existingAlerts.earnings||this._getInitialEarningAlert(),this._existingEarningsAlertId=e.alertId,this._showAndEditCommonActions("Save Earnings Alert","earningsFooter",!1,!0),this._getForm("earnings").setupFormSinglePairEarnings(e),this._toggleEarningsButtonDisability()},_showAndEditCommonActions:function(e,t,n,i){this._alertsPopupHeader.toggleSinglePairHeader(n,e),this._alertsPopupHeader.toggleTabs(i),this._dom[t].showEl()},_getForm:function(e){return this._alertForms[e]},_getInitialEarningAlert:function(){return{alertId:null,followType:0,reminder:!1,deliveryMail:0,deliveryApp:0,alertStatus:0}},_toggleSingleState:function(e){this._dom.singlePairElements._toggleShow(e),this._dom.bulkAlertElements._toggleShow(!e),this._selectedTab.is("price")&&this._alertForms.price.toggleDropdownOptions("singleMulti",e)},_populateMultiPairList:function(e){var t=3<e.length&&e.length-3;this._dom.mainContent.mF(".js-pair-names").text(e.slice(0,3).join(", ")),this._dom.mainContent.mF(".js-more-than-limit")._toggleShow(!!t),this._dom.mainFooter.mF(".js-create-number").text(e.length),t&&(this._dom.mainContent.mF(".js-more-pairs-number").text(t),this._dom.mainContent.mF(".js-more-pairs-names").text(e.slice(3).join(", ")))},_hideCreateAlert:function(){this._cancelDelete(),this.showAlertsList(this._selectedTab)},_getAlertDataById:function(e){return n.findWhere(this._existingAlerts[this._selectedTab],{alertId:""+e})},_confirmDelete:function(){this._cancelDelete(),this.trigger("deleteAlertEv",this._currentEditedAlert,this._selectedTab)},_cancelDelete:function(){this._deletePopupInit&&this.closePopupFromElement(this._dom.deleteAlertPopup)},_showDeleteDialog:function(e){this._deletePopupInit=!0,this.firePopup(this._dom.deleteAlertPopup),e.stopPropagation()},_saveAlert:function(){this._selectedTab.is("earnings")?this.trigger(this.isLoggedIn()?"saveEarningsAlertEv":"saveEarningsAlertLoggedOutEv",this._getForm("earnings").prepareAlertParamsForSubmit(this._existingEarningsAlertId),this._existingEarningsAlertId):(this.trigger(this.isLoggedIn()?"createNewAlertEv":"savePriceAlertLoggedOutEv",this._getForm(this._selectedTab).prepareAlertParamsForSubmit()),this._isSinglePair||this._closeAlertsPopup()),this.isLoggedIn()||this.popLoginSystemAlert()},_saveExistingAlertChanges:function(){this._cancelDelete(),this.trigger("editAlertEv",this._getForm(this._selectedTab).prepareAlertParamsForSubmit(this._currentEditedAlert))},_toggleEarningsButtonDisability:function(){this._dom.createSingleEarningsButton.disable(!this._getForm("earnings").getTabParams().alertStatus)}})}),define("AlertActions",["underscore","jquery","Backbone","Server","TemplateManager","DataChest","EventBus","ActionQueue","Modules/Alerts/EventAlerts","Modules/Alerts/AlertActionsView"],function(o,e,t,r,s,a,n,i,l,u){return new(t.EModel.extend({_selectedPairIds:null,_popupOpenedFrom:null,_currentTriggerSource:null,_eventAlertsPopup:null,initialize:function(){n.onMultiple({createNewAlertFromQueueEv:this._createPriceAlertFromQueue.bind(this),createEarningsAlertFromQueueEv:this._createEarningsAlertFromQueue.bind(this),createEventAlertFromQueueEv:this._createEventAlertFromQueueEv.bind(this)})},render:function(e){return this._view=new u(e),this._view.render(),this._view.onMultiple({createNewAlertEv:this._createNewAlert.bind(this),savePriceAlertLoggedOutEv:this._savePreLoginPriceAlert.bind(this),saveEarningsAlertEv:this._saveEarningsAlert.bind(this),toggleAlertStatusEv:this._toggleAlertStatus.bind(this),deleteAlertEv:this._deleteExistingAlert.bind(this),editAlertEv:this._editExistingAlert.bind(this),saveEarningsAlertLoggedOutEv:this._savePreLoginEarningsAlert.bind(this),createNewAlertGTMEv:this._createNewAlertGTM.bind(this)}),this},openSinglePairPopup:function(e,t){var n=this;this._popupOpenedFrom=t,this._selectedPairIds=[e],r.Alerts.Fetch(e).then(function(e){e=e.data;return n._view.initSingleAlert(e)})},openMultiPairPopup:function(e,t,n){this._popupOpenedFrom=n,this._selectedPairIds=e,this._view.initMultiAlert(t)},openEventAlertPopup:function(t){for(var n=this,e=arguments.length,i=new Array(1<e?e-1:0),o=1;o<e;o++)i[o-1]=arguments[o];r.Render.EventsAlertsPopup(i).then(function(e){s.render({body:e}).then(function(e){e=e.body;n._eventAlertsPopup=new l(e,t,i),n._eventAlertsPopup.render()})})},_getInstrumentData:function(e){var t=a.get("instrumentData");return t?t[e]:"NA"},_generateGTMObject:function(){var e=0<arguments.length&&void 0!==arguments[0]&&arguments[0];return{triggerSource:1<arguments.length&&void 0!==arguments[1]?arguments[1]:this._popupOpenedFrom,instrumentName:this._getInstrumentData("instrumentName"),instrumentType:this._getInstrumentData("instrumentType"),pairIds:this._selectedPairIds,eventLabel:e?"Alert Edited":"Alert Created"}},_createNewAlertGTM:function(){this.GTM("CreateNewAlert",this._generateGTMObject())},_createPriceAlertFromQueue:function(e,t,n){this._selectedPairIds=t,this._createNewAlert(e,n)},_createEarningsAlertFromQueue:function(e,t,n,i){this._selectedPairIds=n,this._saveEarningsAlert(e,t,i)},_createEventAlertFromQueueEv:function(e){var t;(t=l.prototype.createAlert).call.apply(t,[this].concat(_toConsumableArray(e)))},_createNewAlert:function(n,e){var i=this;r.Alerts.Add(this._selectedPairIds,n.alertType,n.deliveryMail,n.deliveryApp,n.alertValue,n.frequency,n.threshold,n.alertTrigger,this._generateGTMObject(!1,e)).then(function(e){var t=a.getTranslation("INST_PRICE_ALERT_CREATED");o.isSizeOne(i._selectedPairIds)&&i._view.showAlertsList(n.alertType,e.data[i._selectedPairIds[0]]).highlightNewAlerts(1!==n.alertDirection),i.popSystemAlert(t,2e3)})},_saveEarningsAlert:function(t,n,e){var i=this;r.Alerts.SaveEarnings(n,this._selectedPairIds,t.alertStatus,t.deliveryMail,t.deliveryApp,t.followType,t.reminder,this._generateGTMObject(!1,e)).then(function(){var e=a.getTranslation(n?"INST_EARNINGS_ALERT_UPDATED":"INST_EARNINGS_ALERT_CREATED");i._view.switchToDefaultTab(),i._view.updateEarningsAlert(t),i.popSystemAlert(e,2e3)})},_savePreLoginEarningsAlert:function(e,t){i.pushAction({eventTrigger:"afterDynamicPage",eventName:"createEarningsAlertFromQueueEv",eventParams:[e,t,this._selectedPairIds,this._popupOpenedFrom]})},_savePreLoginPriceAlert:function(e){i.pushAction({eventTrigger:"afterDynamicPage",eventName:"createNewAlertFromQueueEv",eventParams:[e,this._selectedPairIds,this._popupOpenedFrom]})},_editExistingAlert:function(n){var i=this;r.Alerts.Update(this._selectedPairIds,n.alertType,n.deliveryMail,n.deliveryApp,n.alertValue,n.frequency,n.existingAlertId,n.threshold,n.alertTrigger,this._generateGTMObject(!0)).then(function(e){var t=a.getTranslation("INST_PRICE_ALERT_UPDATED");i._view.showAlertsList(n.alertType,e.data[i._selectedPairIds[0]]),i.popSystemAlert(t,2e3)})},_toggleAlertStatus:function(e){var t=this;r.Alerts.Toggle(e.alertId,e.isToggled).then(function(){return t._view.updateToggledAlert(e)})},_deleteExistingAlert:function(e,t){var n=this;r.Alerts.Delete(e,this._selectedPairIds[0]).then(function(e){return n._view.showAlertsList(t,e.data[n._selectedPairIds[0]])})}}))}),define("Modules/Portfolios/PortfolioActionsView",["underscore","jquery","Backbone","DataChest","Displayable"],function(s,e,t,n,i){return i.extend({_selectedPairIds:null,_portfolioPopup:null,_markupScheme:{portfolioUL:".js-portfolio-list",portfolioItemLI:".js-portfolio-list-item",saveChangesButton:".js-save-portfolio-changes",addNewPortfolioWrapper:".js-add-new-portfolio-wrapper",popupListWrapper:".js-portfolio-popup-list-wrapper",popupListScroller:".js-portfolio-popup-list-scroller"},events:{"click .js-save-portfolio-changes":"_savePortfoliosChangesInView","click .js-cancel-portfolio-popup":"_closePortfolioPopup"},_currentListCBs:null,initialize:function(e){i.prototype.initialize.call(this,e)},render:function(){var t=this;return i.prototype.render.call(this),this._portfolioPopup=this.instantiatePopup(this.$el,["global"]).on("close",function(){return t.trigger("portfolioPopupClosed")}),this.initializeCreateNew(this._dom.addNewPortfolioWrapper,function(e){return t.trigger(t.isLoggedIn()?"createPortfolioEv":"createPreLoginPortfolioEv",e)},this._dom.saveChangesButton),this.$el},populatePortfolioPopup:function(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{};return this._selectedPairIds=1<arguments.length?arguments[1]:void 0,this._populatePortfoliosList(e),this},addNewPortfolioToList:function(e,t){this._portfolioPopup.isOpen&&(this._dom.portfolioUL.append(this._preparePortfolioLI(t,e,!0)),this._dom.popupListScroller.scrollToBottom())},showPortfolioPopup:function(e,t){return!this.fireRelocate(this.$el,e,{skipDocumentCloseAll:!0,openLeftwards:t})},notifyUpdateSuccess:function(){this.popSystemAlert(n.getTranslation("WATCHLISTS_UPDATED_SUCCESSFULLY"))},initializeCreateNew:function(e,t,n){function i(){var e=r.valT();e&&(c(),t(e))}var o=this,r=e.mF(".js-new-portfolio-input"),s=e.mF(".js-show-create-portfolio"),a=e.mF(".js-add-new-portfolio-input-wrapper"),l=e.mF(".js-cancel-new-portfolio"),u=e.mF(".js-save-new-portfolio"),c=function(){s.showEl(),a._hide(),u.enable(),n&&n.enable()};u.on("click",i),r.onEnter(i).onEsc(c,!0).onKeyUp(function(){return u.disable(!r.valT())}),l.on("click",c),s.on("click",function(){s._hide(),a.showEl(),r.val("").focus(),u.disable(),o.trigger("NewPortfolioButtonClickedEv"),n&&n.disable()})},_trigDeletePortfolio:function(e){this.trigger("deletePortfolioEv",e)},_closePortfolioPopup:function(){this.closePopupFromElement(this.$el)},_populatePortfoliosList:function(e){var n=this;this._dom.portfolioUL.empty(),this._currentListCBs={},s.e(e,function(e,t){return n._dom.portfolioUL.append(n._preparePortfolioLI(e,t))})},_preparePortfolioLI:function(e,t,n){var i=this,o=this._dom.portfolioItemLI.clone().attr("data-portfolio-id",t),r=o.mF(".js-watchlist-checkbox");return o.mF(".js-text").textT(e.name),this._currentListCBs[t]=r,this._configPortfolioLI(t,e,r,o.mF(".js-full-label")),n&&r.check(),o.mF(".js-edit-portfolio-button").on("click",function(){return i.outerNavigate("/portfolio/?portfolioID=".concat(e.hash),!0)}),o},_configPortfolioLI:function(e,t,n,i){var t=t.pairIds,o=this._selectedPairIds,o=s.difference(o,t),r=s.isE(o),t=10<s.size(t)+s.size(o);n.toggleCheck(r).disable(!r&&t),i._toggleShow(t)},_savePortfoliosChangesInView:function(){var t=this;this.loginOrImmediate(function(){var e=t._getPortfolioCheckboxStates();t.closePopupFromElement(t.$el),t.trigger("savePortfoliosChangesEv",e)})},_getPortfolioCheckboxStates:function(){return s.mapObject(this._currentListCBs,function(e){return e.isChecked()})}})}),define("PortfolioActions",["underscore","jquery","Backbone","Server","Toolset","DataChest","EventBus","ActionQueue","Modules/Portfolios/PortfolioActionsView"],function(l,t,e,u,a,r,c,n,s){var i=l.oneHour,d=6;return new(e.EModel.extend({_currentlySavedP2P:null,_popupOpenedFrom:null,_bubbleEvents:{_view:"portfolioPopupClosed"},initialize:function(){var i=this;this._fetchP2P(),c.onMultiple({addingAlreadyAddedPairEv:function(){return i.popSystemAlert(r.getTranslation("_TM_YOUVE_ALREADY_ADDED_THIS_ITEM"))},P2PChangedEv:function(e){return i._updateCurrentlySavedP2P(e)}}),c.on("createAndUpdatePortfolioEv",function(t,e,n){i._createNewPortfolio(e,function(e){i._applyChangesToSavedP2PMap({addTo:[e],removeFrom:[]},t),i._updatePortfolio(t,[e],[],n)},t,n)})},render:function(e){return this._view=new s(e),this._view.render(),this._view.onMultiple({NewPortfolioButtonClickedEv:this._sendPortfolioButtonClickedGTM.bind(this),savePortfoliosChangesEv:this._savePortfoliosChanges.bind(this),createPortfolioEv:this._createNewPortfolio.bind(this),createPreLoginPortfolioEv:this.createPreLoginPortfolio.bind(this),deletePortfolioEv:this._trigDeletePortfolio.bind(this)}),this.delegateBubbling(),this},openPortfolioPopup:function(e,t,n,i){var o=this;this._popupOpenedFrom=i,r.get("user")?(i=a.ClientStorage.P2P())?(this._selectedPairIds=l.array(e),this._currentlySavedP2P=i,this._view.showPortfolioPopup(t,n)&&this._view.populatePortfolioPopup(l.filterObject(this._currentlySavedP2P.portfolios,function(e){e=e.portfolioType;return"watchlist".is(e)}),this._selectedPairIds)):d--&&setTimeout(function(){return o.openPortfolioPopup(e,t)},250):this.popLoginSystemAlert()},isPairInPortfolios:function(e){return a.ClientStorage.isPairInPortfolios(e)},bindCreatePortfolio:function(e,t,n,i){var o=this;s.prototype.initializeCreateNew(e,this.loginOr(function(e){return o._createNewPortfolio(e,t,o._selectedPairIds,i)}),n)},_updateCurrentlySavedP2P:function(e){this._currentlySavedP2P=e},_fetchP2P:function(){var e=(r.get("user")||{}).user_ID;a.ClientStorage.cache("userId",e),t.later(function(){return u.Portfolio.Fetch().then(function(e){a.ClientStorage.P2P(e.data),a.ClientStorage.cache("P2P",Date.now()+i)})},128)},_sendPortfolioButtonClickedGTM:function(){this.GTM("NewPortfolioButtonClicked",{triggerSource:this._popupOpenedFrom,pairIds:this._selectedPairIds})},_applyChangesToSavedP2PMap:function(e,t){var n=this,i=e.addTo,e=e.removeFrom;l.e(i,function(e){return n._updatePortfolioObject(!0,t,n._currentlySavedP2P.portfolios[e])}),l.e(e,function(e){return n._updatePortfolioObject(!1,t,n._currentlySavedP2P.portfolios[e])}),a.ClientStorage.P2P(this._currentlySavedP2P)},_updatePortfolioObject:function(n,e,i){l.e(e,function(e){var t=l.isIn(i.pairIds,e);n&&!t&&i.pairIds.push(e),!n&&t&&(t=i.pairIds.indexOf(e),i.pairIds[t]=null)}),i.pairIds=l.clean(i.pairIds)},_getInstrumentData:function(e){return r.get("instrumentData")?r.get("instrumentData")[e]:"NA"},_savePortfoliosChanges:function(e){e=this._calculatePortfolioChanges(e);l.allEmpty(e)||(this._applyChangesToSavedP2PMap(e,this._selectedPairIds),this._updatePortfolio(this._selectedPairIds,e.addTo,e.removeFrom))},_updatePortfolio:function(t,n,i){var o=this,r=3<arguments.length&&void 0!==arguments[3]?arguments[3]:this._popupOpenedFrom,s=this._getInstrumentData("instrumentName"),a=this._getInstrumentData("instrumentType");u.Portfolio.Update(t,n,i).then(function(e){e.success&&o._view.notifyUpdateSuccess(),l.isntE(n)&&o.GTM("InstrumentAddedToPortfolio",{triggerSource:r,instrumentName:s,instrumentType:a,eventValue:t.length,pairIds:t})}).then(function(){var e=l.size(n)+l.size(i),t=l.array(n,i);1===e?c.trigger("portfolioModifiedEv",t[0],o._selectedPairIds,!0):c.trigger("portfoliosModifiedEv",t,o._selectedPairIds,!0),o.trigger("updateInstrumentToolsButtonsEv",o._selectedPairIds)})},_traceChangedPortfolios:function(){var t=this;return l.mapObject(this._currentlySavedP2P.portfolios,function(e){e=e.pairIds;return l.isE(l.difference(t._selectedPairIds,e))})},_calculatePortfolioChanges:function(e){var n=this._traceChangedPortfolios(this._selectedPairIds),i={addTo:[],removeFrom:[]};return l.e(e,function(e,t){e^n[t]&&i[e?"addTo":"removeFrom"].push(t)}),i},createPreLoginPortfolio:function(e){this._view.addNewPortfolioToList(0,{name:e,pairIds:[],display:!1,portfolioType:"watchlist"}),n.pushAction({eventTrigger:"afterDynamicPage",eventName:"createAndUpdatePortfolioEv",eventParams:[this._selectedPairIds,e,this._popupOpenedFrom]})},_createNewPortfolio:function(n,i,o){var r=this,s=3<arguments.length&&void 0!==arguments[3]?arguments[3]:this._popupOpenedFrom;u.Portfolio.Add(n).then(function(e){var e=e.response,t=e.portfolioId,e=e.portfolioData;r._view.addNewPortfolioToList(t,e),a.ClientStorage.addToP2P(t,e),r._currentlySavedP2P=a.ClientStorage.P2P(),i&&i(t,n),c.trigger("portfolioCreatedEv",t,n),r.GTM("NewPortfolioCreated",{triggerSource:s,pairIds:o})})},_trigDeletePortfolio:function(e){u.Portfolio.Delete(e).then(function(){})}}))}),define("External/dragtable/dragtable",["jquery"],function(h){h.widget("akottr.dragtable",{options:{revert:!1,dragHandle:".table-handle",maxMovingRows:40,excludeFooter:!1,onlyHeaderThreshold:100,dragAccept:null,persistState:null,restoreState:null,exact:!0,clickDelay:10,containment:null,cursor:"move",cursorAt:!1,distance:0,tolerance:"pointer",axis:"x",beforeStart:h.noop,beforeMoving:h.noop,beforeReorganize:h.noop,beforeStop:h.noop},originalTable:{el:null,selectedHandle:null,sortOrder:null,startIndex:0,endIndex:0},sortableTable:{el:h(),selectedHandle:h(),movingRow:h()},persistState:function(){var t=this;this.originalTable.el.find("th").each(function(e){""!==this.id&&(t.originalTable.sortOrder[this.id]=e)}),h.ajax({url:this.options.persistState,data:this.originalTable.sortOrder})},_restoreState:function(e){for(var t in e)this.originalTable.startIndex=h("#"+t).closest("th").prevAll().length+1,this.originalTable.endIndex=parseInt(e[t],10)+1,this._bubbleCols()},_bubbleCols:function(){var e,t,n,i,o=this.originalTable.startIndex,r=this.originalTable.endIndex,s=this.originalTable.el.children();if(this.options.excludeFooter&&(s=s.not("tfoot")),o<r)for(e=o;e<r;e++)for(n=s.find("> tr > td:nth-child("+e+")").add(s.find("> tr > th:nth-child("+e+")")),i=s.find("> tr > td:nth-child("+(e+1)+")").add(s.find("> tr > th:nth-child("+(e+1)+")")),t=0;t<n.length;t++)a(n[t],i[t]);else for(e=o;r<e;e--)for(n=s.find("> tr > td:nth-child("+e+")").add(s.find("> tr > th:nth-child("+e+")")),i=s.find("> tr > td:nth-child("+(e-1)+")").add(s.find("> tr > th:nth-child("+(e-1)+")")),t=0;t<n.length;t++)a(n[t],i[t])},_rearrangeTableBackroundProcessing:function(){var e=this;return function(){e._bubbleCols(),e.options.beforeStop(e.originalTable),e.sortableTable.el.remove(),h("#__dragtable_disable_text_selection__").remove(),t?h(document.body).attr("onselectstart",t):h(document.body).removeAttr("onselectstart"),n?h(document.body).attr("unselectable",n):h(document.body).removeAttr("unselectable"),null!==e.options.persistState&&(h.isFunction(e.options.persistState)?e.options.persistState(e.originalTable):e.persistState())}},_rearrangeTable:function(){var e=this;return function(){e.originalTable.selectedHandle.removeClass("dragtable-handle-selected"),e.sortableTable.el.sortable("disable"),e.sortableTable.el.addClass("dragtable-disabled"),e.options.beforeReorganize(e.originalTable,e.sortableTable),e.originalTable.endIndex=e.sortableTable.movingRow.prevAll().length+1,setTimeout(e._rearrangeTableBackroundProcessing(),50)}},_generateSortable:function(e){e.cancelBubble||(e.cancelBubble=!0);for(var i=this,t=this.originalTable.el[0].attributes,o="",n=0;n<t.length;n++)t[n].nodeValue&&"id"!=t[n].nodeName&&"width"!=t[n].nodeName&&(o+=t[n].nodeName+'="'+t[n].nodeValue+'" ');var r=[],s=[],a=(this.originalTable.el.find("tr").slice(0,this.options.maxMovingRows).each(function(e,t){for(var n=this.attributes,i="",o=0;o<n.length;o++)n[o].nodeValue&&"id"!=n[o].nodeName&&(i+=" "+n[o].nodeName+'="'+n[o].nodeValue+'"');r.push(i),s.push(h(this).height())}),[]),l=0,u=i.originalTable.el.children(),c=((u=this.options.excludeFooter?u.not("tfoot"):u).find("> tr > th").each(function(e,t){var n=h(this).is(":visible")?h(this).outerWidth():0;a.push(n),l+=n}),i.options.exact&&(d=l-i.originalTable.el.outerWidth(),a[0]-=d),'<ul class="dragtable-sortable" style="position:absolute; width:'+(l+=2)+'px;">'),d=(u.find("> tr > th").each(function(e,t){var n=h(this).is(":visible")?h(this).outerWidth():0,n=(c=c+('<li style="width:'+n+'px;">')+("<table "+o+">"),u.find("> tr > th:nth-child("+(e+1)+")"));(n=1<i.options.maxMovingRows?n.add(u.find("> tr > td:nth-child("+(e+1)+")").slice(0,i.options.maxMovingRows-1)):n).each(function(e){var t=h(this).clone().wrap("<div></div>").parent().html();0===t.toLowerCase().indexOf("<th")&&(c+="<thead>"),c=c+("<tr "+r[e]+'" style="height:'+s[e])+'px;">'+t,0===t.toLowerCase().indexOf("<th")&&(c+="</thead>"),c+="</tr>"}),c+="</table></li>"}),c+="</ul>",this.sortableTable.el=this.originalTable.el.before(c).prev(),this.sortableTable.el.find("> li > table").each(function(e,t){h(this).css("width",a[e]+"px")}),this.sortableTable.selectedHandle=this.sortableTable.el.find("th .dragtable-handle-selected"),this.options.dragAccept?"li:has("+this.options.dragAccept+")":"li"),e=(this.sortableTable.el.sortable({items:d,stop:this._rearrangeTable(),revert:this.options.revert,tolerance:this.options.tolerance,containment:this.options.containment,cursor:this.options.cursor,cursorAt:this.options.cursorAt,distance:this.options.distance,axis:this.options.axis}),this.originalTable.startIndex=h(e.target).closest("th").prevAll().length+1,this.options.beforeMoving(this.originalTable,this.sortableTable),this.sortableTable.movingRow=this.sortableTable.el.find("> li:nth-child("+this.originalTable.startIndex+")"),d=h('<style id="__dragtable_disable_text_selection__" type="text/css">body { -ms-user-select:none;-moz-user-select:-moz-none;-khtml-user-select:none;-webkit-user-select:none;user-select:none; }</style>'),h(document.head).append(d),h(document.body).attr("onselectstart","return false;").attr("unselectable","on"),window.getSelection?window.getSelection().removeAllRanges():document.selection.empty(),this.sortableTable.movingRow.trigger(h.extend(h.Event(e.type),{which:1,clientX:e.clientX,clientY:e.clientY,pageX:e.pageX,pageY:e.pageY,screenX:e.screenX,screenY:e.screenY})),this.sortableTable.el.find(".ui-sortable-placeholder"));!e.height()<=0&&e.css("height",this.sortableTable.el.find(".ui-sortable-helper").height()),e.html('<div class="outer" style="height:100%;"><div class="inner" style="height:100%;"></div></div>')},bindTo:{},_create:function(){this.originalTable={el:this.element,selectedHandle:h(),sortOrder:{},startIndex:0,endIndex:0},this.bindTo=this.originalTable.el.find("th"),this.options.dragAccept&&(this.bindTo=this.bindTo.filter(this.options.dragAccept)),0<this.bindTo.find(this.options.dragHandle).length&&(this.bindTo=this.bindTo.find(this.options.dragHandle)),null!==this.options.restoreState&&(h.isFunction(this.options.restoreState)?this.options.restoreState(this.originalTable):this._restoreState(this.options.restoreState));var t=this;this.bindTo.mousedown(function(e){1===e.which&&!1!==t.options.beforeStart(t.originalTable)&&(clearTimeout(this.downTimer),this.downTimer=setTimeout(function(){t.originalTable.selectedHandle=h(this),t.originalTable.selectedHandle.addClass("dragtable-handle-selected"),t._generateSortable(e)},t.options.clickDelay))}).mouseup(function(e){clearTimeout(this.downTimer)})},redraw:function(){this.destroy(),this._create()},destroy:function(){this.bindTo.unbind("mousedown"),h.Widget.prototype.destroy.apply(this,arguments)}});var t=h(document.body).attr("onselectstart"),n=h(document.body).attr("unselectable");function a(e,t){var n=e.parentNode,i=e.nextSibling===t?e:e.nextSibling;t.parentNode.insertBefore(e,t),n.insertBefore(t,i)}}),define("text!External/dragtable/dragtableStyle.css",[],function(){return"/*\n * dragtable\n *\n * @Version 2.0.15\n *\n * default css\n *\n */\n/*##### the dragtable stuff #####*/\n/*\n.dragtable-sortable {\n    list-style-type: none; margin: 0; padding: 0; -moz-user-select: none;\n    z-index: 2;\n}\n.dragtable-sortable li {\n    margin: 0; padding: 0; float: left; font-size: 1em; background: white;\n}\n\n.dragtable-sortable th, .dragtable-sortable td{\n    border-left: 0px;\n}\n\n.dragtable-sortable .common-table tbody tr td:first-child {\n    font-weight: inherit;\n}\n\n/*.dragtable-sortable li:first-child th, .dragtable-sortable li:first-child td {*/\n    /*border-left: 1px solid #CCC;*/\n/*}*/\n/*\n.ui-sortable-helper {\n    opacity: 0.7;\n    filter: alpha(opacity=70);\n}\n.ui-sortable-placeholder {\n    -moz-box-shadow: 4px 5px 4px #C6C6C6 inset;\n    -webkit-box-shadow: 4px 5px 4px #C6C6C6 inset;\n    box-shadow: 4px 5px 4px #C6C6C6 inset;\n    border-bottom: 1px solid #CCCCCC;\n    border-top: 1px solid #CCCCCC;\n    visibility: visible !important;\n    background: #EFEFEF !important;\n    visibility: visible !important;\n}\n.ui-sortable-placeholder * {\n    opacity: 0.0; visibility: hidden;\n}*/"}),define("Modules/Table/TableView",["underscore","jquery","Backbone","Displayable","Toolset","EventBus","DataChest","External/dragtable/dragtable","text!External/dragtable/dragtableStyle.css"],function(m,d,e,t,o,n,i,r,s){var a=["small","medium","high"],l=[,"u-sort-down","u-sort-up"],u="data-column-hover",c="table.js-table",h="u-visibility-hidden",p=1;function f(e,t){e.removeAddClass(a.join(" "),a[t])}return d.injectCSS(s),n.on("newMainContentInjection",function(e){return f(e.f(c),p)}),t.extend({_markupScheme:{mainTable:c,"?tbody":"".concat(c," > tbody"),ths:"".concat(c," > thead > tr > th"),"?trs":"".concat(c," > tbody > tr"),"?tableInfoWrapper":"".concat(c," > tbody > tr.js-table-info-wrapper"),"?optionsTableRow":"tr.js-options-table-bar-tr","?markCheckboxes":"".concat(c," > tbody > tr .js-row-mark-checkbox"),"?tableTitleWrapper":".js-table-title-wrapper","?bulkPanel":".js-bulk-panel","?showMoreRows":".js-table-show-more-rows","?columnSelector":".js-table-column-selector","?showMoreEquities":".js-show-more-equities"},_skipInit:null,tableTitle:null,_columnSettings:null,_markedRows:null,_lastMarkedRowIndex:null,_currentOrder:null,_columnNameToSortButton:null,_isCustomView:null,_isCollapsible:null,_maxMarkedRowsAllowed:null,_tableInfoEnabled:!1,_currentlyShownInfoIndex:-1,events:{},initialize:function(e){t.prototype.initialize.call(this,e.$tableWrapper),this.setToObjects("_markedRows","_columnNameToSortButton"),this.loadSettings(e),this._pageType=i.get("GTMData").pageType},render:function(){var e=this;return t.prototype.render.call(this),this._appendRowsOnLoad(),!this._skipInit&&(this._initializeDraggability(),this._loadCurrentSpacing(),this._extractTableInfoWrapper(),this._initColumnSelector(),this._isCustomView=this._dom.mainTable.hasData("custom-view"),this._isCollapsible=this._dom.mainTable.hasData("collapsible-table"),this._maxMarkedRowsAllowed=this._dom.mainTable.data("max-mark-checkboxes"),this.tableTitle=this._dom.tableTitleWrapper.textT()||null,this._isCollapsible&&this._bindAccordions(),this._dom.showMoreRows.on("click",function(){return e.trigger("fetchAndShowMoreRowsEv",e._dom.mainTable.data("show-more-key"))}),this._dom.mainTable.hCl("js-streamable-table")&&this.subscribeTableToSocket(this._dom.mainTable,this._settings.streamCallback),this._dom.showMoreEquities.on("click",function(){return e.GTM("ShowMoreTableEquities")}),this.$el)},reorder:function(e,t){var n=this._dom.trs,i=[];this._currentOrder=e,m.e(e,function(e){return i.push(n.eq(e)[0])}),n.detach(),this._dom.tbody.html(i),this._lastMarkedRowIndex=null,t&&(this._currentOrder=null)},destroy:function(){this.unbindDOMEvents()},setVisibleRows:function(t){m.e$(this._dom.trs,function(e){return e.toggleEl(!!t[e.index()])})},colorRows:function(e){var t=this;m.e(e,function(e){return t._dom.trs.eq(e).addClass("sticky")})},setTHSortState:function(e){m.e(this._columnNameToSortButton,function(e){return d(e).rCl(l.join(" "))}),this._columnNameToSortButton[e.colName].aCl(l[e.dir]),this._dom.ths.rCl("is-sorted"),e.dir&&this._columnSettings[e.colName].$th.aCl("is-sorted")},absorbColumns:function(){var c=this;return this._columnSettings={},m.e(this._dom.ths,function(e,t){var n,e=d(e),i=e.data("type"),o=e.hasAttr("col-name")?e.attr("col-name").toLowerCase():"",r=e.data("stream-prefix"),s=e.data("stream-key"),a=e.data("filterable")||"",l=!m.isUn(e.attr("draggable")),u=e.f(".js-table-sort-button").exists();o&&(i&&(c._columnSettings[o]={currentIndex:t,dataType:i,finType:s,streamerType:r,$th:e,features:{filterable:a,draggable:l,sortable:u}}),u&&(c._columnNameToSortButton[o]=e.mF(".js-table-sort-button"),e.hover(function(){return c._columnNameToSortButton[o].rCl(h)},function(){return c._columnNameToSortButton[o].aCl(h)}),e.aCl("is-sortable").on("click",function(){return c.trigger("columnSortEv",o)})),a.is("text")&&o.is(["name","event"])&&(n=c._dom.ths.f(".js-table-text-filter-input")).on("search keyup",m.debounce(function(){return c.trigger("textFilterModifiedEv",o,n.val())},30))),o.is("checkbox")&&(c._markColumnIndex=t),c._toggleThHoverClass(e)}),this._columnSettings},generateTableIterator:_regeneratorRuntime().mark(function e(){var u,c,d,h,p,t,f=this;return _regeneratorRuntime().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:d=this._dom.trs,h=[],p=!this._dom.mainTable.hasData("disable-row-clicks"),m.e$(this._dom.ths,function(e){return h[e.index()]=e.hasAttr("col-name")?e.attr("col-name").toLowerCase():""}),t=_regeneratorRuntime().mark(function e(){var t,n,i,o,r,s,a,l;return _regeneratorRuntime().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return a=d.eq(u),t=a.mF("td"),s=+a.data("s"),n=+a.data("e-id"),n=n||s||u,i=a.f(".js-instrument-page-link"),o=f.GTM.bind(f,"InstrumentClickedFromQuotesTable",s,f._pageType),r=p&&i.exists()&&a.onUndraggedClick(function(){o(),f.navigate(i.href(),!0)}),a.tCl("u-clickable",p),i.on("click",o),f._tableInfoEnabled?a.on("click",f._toggleTableInfo.bind(f,a,u)):s&&p&&a.f("a[href],input").on("mouseup",r),e.next=6,{startIndex:u,pId:n};case 6:c=0;case 7:if(c<t.length){if(s=t.eq(c),a=s.f(".js-row-mark-checkbox"),l=s.data("value"),a.exists()&&(a.on("click",function(t,n){return function(e){f._markRow(t,n,e)}}(u,n)),p&&s.on("mouseup",r)),f._columnSettings[h[c]])return e.next=13,{rowIndex:u,colName:h[c],customValue:l,labelValue:s.textT()};e.next=13}else e.next=16;break;case 13:c++,e.next=7;break;case 16:case"end":return e.stop()}},e)}),u=0;case 4:if(u<d.length)return e.delegateYield(t(),"t0",6);e.next=9;break;case 6:u++,e.next=4;break;case 9:case"end":return e.stop()}},e,this)}),toggle:function(e){this.$el._toggleShow(e)},appendMoreTableRows:function(e){var t=e.table,e=e.showAllSection;this._dom.tbody.append(t),this._dom.showMoreRows.replaceWith(e)},uncheckAll:function(){this._markedRows={},this._dom.mainTable.rCl("has-marked-rows"),this._dom.trs.unmark(),this._dom.markCheckboxes.uncheck().enable()},getMarkedRows:function(){return m.keys(this._markedRows)},getSeparatorsIndices:function(){return m.getIndicesByPredicate(this._dom.trs,function(e){return d(e).hCl("js-table-separator")})},isIndexVisible:function(e){return this._dom.trs.eq(e).isVisible()},markAllPreviouslyMarked:function(){var n=this;m.e$(this._dom.markCheckboxes,function(e,t){return e.isChecked()&&n._markRow(t)})},getMainTableElem:function(){return this._dom.mainTable},changeLineSpacing:function(e){f(this._dom.mainTable,e),p=e},getPlainData:function(){return{$ths:m.map$(this._dom.ths,function(e){return e.textT()}),$trs:m.map$(this._dom.trs,function(e){return m.map$(e.mF("td:visible"),function(e){return e.visibleTextT()||e.printableValue()})})}},_appendRowsOnLoad:function(){var t=this,n=this.$el.mF(c),e=n.data("append-on-load");e&&(this._skipInit=!0,n.rData("append-on-load"),this.ask("rowsToAppendOnLoadQ",e).then(function(e){e=e.rowsToAppend;n.mF(">tbody").append(e),t.trigger("initializeTableEv")}))},_initColumnSelector:function(){var e=this;this._dom.columnSelector.on("change",function(){return e._dom.mainTable.attr("data-column-show-only",e._dom.columnSelector.numVal())})},_toggleThHoverClass:function(e){var t=this;e.hover(function(){return t.$el.attr(u,e.index())},function(){return t.$el.attr(u)===""+e.index()&&t.$el.removeAttr(u)})},_loadCurrentSpacing:function(){var n=this;m.e(a,function(e,t){n._dom.mainTable.hasClass(e)&&(p=t)})},_extractTableInfoWrapper:function(){this._dom.tableInfoWrapper.exists()&&(this._tableInfoEnabled=!0,this._dom.tableInfoWrapper.remove().removeFromSet(this._dom.trs)._show()),this._dom.optionsTableRow.exists()&&this._dom.optionsTableRow.removeFromSet(this._dom.trs)},_toggleTableInfo:function(e,n,t){var i=this;d(t.target).isChildOf(".js-line-actions-wrapper")||(this._dom.trs.rOpen(),this._currentlyShownInfoIndex!==n?(m.e$(this._dom.tableInfoWrapper.mF(".js-table-info-content"),function(e){var t=i.ask("tableInfoDataChunkQ",n,e.data("client-data-key"));m.e$(e.mF("[data-key]"),function(e){return e.text(t[e.data("key")])}),t.class&&t.change&&e.mF('[data-key="change"]').removeAddClass("u-down u-up",t.class),t.exp&&e.mF(".js-options-table-extra-info-expiry").textT(o.Dates.getFutureTime(t.exp))}),this._dom.trs.eq(n).after(this._dom.tableInfoWrapper),this._currentlyShownInfoIndex=n,e.aOpen()):(this._dom.tableInfoWrapper.remove(),this._currentlyShownInfoIndex=-1))},_initializeDraggability:function(){this._dom.mainTable.dragtable({dragHandle:".js-grabber-button",dragAccept:"[draggable]",maxMovingRows:void 0,persistState:this._updateCurrentIndices.bind(this)})},_updateCurrentIndices:function(e){var t=e.startIndex,e=e.endIndex;m.e(this._columnSettings,function(e){return e.currentIndex=e.$th.index()}),this._isCustomView&&t!==e&&n.trigger("customViewColumnReorder",t,e)},_currentToOriginalIndex:function(e){return this._currentOrder?this._currentOrder[e]:e},_markRow:function(e,t,n){var i=this,o=this._dom.trs.eq(e),r=this._isCollapsible?m.indexOf(this._dom.trs,o[0]):o.index(),s=this._markedRows[e],a=o.data();s?(d(n.target).blur(),this._lastMarkedRowIndex=null,delete this._markedRows[e],o.removeClass("marked")):n&&n.shiftKey&&m.isNu(this._lastMarkedRowIndex)?m.e(this._getMarkedRange(this._lastMarkedRowIndex,r),function(e){i._addToMarked(e,!0)}):this._addToMarked(r),this.trigger("markTableRowsEv",t,s,a),this._dom.mainTable.tCl("has-marked-rows",!!m.size(this._markedRows)),this._maxMarkedRowsAllowed&&this._dom.markCheckboxes.getUnchecked().disable(m.size(this._markedRows)>=this._maxMarkedRowsAllowed)},_addToMarked:function(e,t){var n=this._currentToOriginalIndex(e);this._lastMarkedRowIndex=e,this._markedRows[n]=!0,this._dom.trs.eq(n).mark(),t&&this._dom.markCheckboxes.eq(n).check()},_getMarkedRange:function(e,t){for(var n,i=[],o=e<t?(n=e+1,t):(n=t,e-1),r=n;r<=o;r++)this._markedRows[this._currentToOriginalIndex(r)]||i.push(r);return i},_bindAccordions:function(){var e=this._dom.mainTable.f(".js-accordion-row");m.e$(e,function(e){return e.mF(".js-accordion-opener").on("click",function(){return e.tOpen()})})}})}),define("Modules/Table/Table",["underscore","jquery","Backbone","Toolset","Socket","Server","DataChest","TemplateManager","Modules/TableFilters/TableFilters","AlertActions","PortfolioActions","./TableView"],function(p,e,t,f,n,i,o,r,s,a,l,u){return t.EModel.extend({_data:null,_view:null,_settings:null,_renderResult:null,_tableLineActions:null,_columnSettings:null,_filters:null,_stickyIndices:null,_currentToStartIndex:null,_startIndexToCurrent:null,_sortState:null,initialize:function(e){t.EModel.prototype.initialize.call(this),this._initView(e),this._renderResult?(this._initColumns(),this._data=this._loadDataFromDOM(),this._initializeSocketAttachment(),this._initializeColumnFilters(),this._initializeTableFeatures(e),this._sortState={dir:0}):this._settings=e},destroy:function(){this._view.destroy(),this._filters.destroy()},refreshTable:function(){this._view.render(),this._data=this._loadDataFromDOM()},sortTable:function(e){Date.now();var t=this._getNewDir(e),n=p.extractByIndices(this._data,this._stickyIndices);this._data.sort(this._makeComparisonFunction(t,e)),p.injectByIndices(this._data,this._stickyIndices,n),this._sortState={colName:e,dir:t},this._saveCurrentToStartIndexMap(),this._view.reorder(this._currentToStartIndex,!t),this._view.setTHSortState(this._sortState),Date.now();requestAnimationFrame(function(){})},getPairNamesByIds:function(t){return p.pluckName(p.filter(this._data,function(e){e=e.pId;return p.isIn(t,e)}))},toggle:function(e){return this._view.toggle(e),this},getElement:function(){return this._view.getMainTableElem()},changeLineSpacing:function(e){this._view.changeLineSpacing(e)},unmarkAll:function(){this._view.uncheckAll()},getDataForExport:function(n){var e,t=this,i=n&&this._view.getMarkedRows(!0),o=this._view.getSeparatorsIndices(),r=null,s=[],a=this._loadDataFromDOM(!0);return this._tableTitle&&s.push(this._tableTitle),p.size(p.keys(a[0]))<4?(e=this._view.getPlainData(),s.push(e.$ths),p.e(e.$trs,function(e,t){!n||p.isIn(i,""+t)?(r&&s.push(p.map(r,function(e){return'"'.concat(e,'"')})),r=null,s.push(p.map(e,function(e){return'"'.concat(p.cleanLineBrakes(e," "),'"')}).join(","))):p.isIn(o,t)&&(r=e)})):(e=this._filters.hasActiveFilters()||n?p.filter(a,function(e){return t._view.isIndexVisible(e.startIndex)&&(!n||p.isIn(i,""+e.startIndex))}):a,a=p.map(e,function(e){return p.omit(e,["checkbox","pId","startIndex","flag"])}),s.push(p.clean(p.map(p.keys(p.first(a)),function(e){return t._columnSettings[e].$th.thTitle()})).join(",")),p.e(a,function(e){return s.push(p.values(e).join(","))})),s.push(""),s},getDataForChart:function(){var e=p.map(p.getByIndices(this._data,this._view.getMarkedRows()),function(e){return p.omit(e,["pId","startIndex","flag"])});return{sets:p.map(e,function(e,t){return{name:e.name,color:o.get("chartColor")[t%3],data:p.values(p.omit(e,["name"]))}}),xLabels:p.map(p.omit(this._columnSettings,["name"]),function(e){return e.$th.textT()})}},_initializeSocketAttachment:function(){n.attachTableData(this._data,this._getStreamableColumns())},_initializeTableFeatures:function(e){e=e.stickyIndices;e&&(this._stickyIndices=e,this._view.colorRows(this._stickyIndices)),this._view.markAllPreviouslyMarked()},_initializeColumnFilters:function(){var n=this;this._filters=new s(this._data,this._columnSettings),this._filters.on("applyFilterInViewEv",function(e){n._view.setVisibleRows(e),n.trigger("visibleTableRowsChangedEv",n.cid,p.pluck(p.getByIndices(n._data,p.keys(p.filterObject(e,function(e){return!e}))),"pId"))}),this._view.on("textFilterModifiedEv",function(e,t){return n._filters.filterByText(e,t)})},_initView:function(e){var t=this;this._view=new u(e),this._view.onMultiple({columnSortEv:this.sortTable.bind(this),initializeTableEv:function(){return t.initialize(t._settings)},markTableRowsEv:this._updateBulkOnMarkedRows.bind(this),fetchAndShowMoreRowsEv:this._fetchAndShowMoreRows.bind(this)}).answerMultiple({tableInfoDataChunkQ:this._fetchTableInfoDataChunk.bind(this),rowsToAppendOnLoadQ:this._getRenderedRowsToAppend.bind(this)}),this._renderResult=!!this._view.render(),this._tableTitle=e.tableTitle},_fetchAndShowMoreRows:function(e){var t=this;i.Table.fetchMoreRows(o.get("TableShowMoreData")[e]).then(function(e){return r.render(e)}).then(function(e){t._view.appendMoreTableRows(e),t.refreshTable()})},_getRenderedRowsToAppend:function(e){return r.render({rowsToAppend:o.get(e)})},_fetchTableInfoDataChunk:function(e,t){return o.get(t)[e]},_loadDataFromDOM:function(e){var t,n=[],i=_createForOfIteratorHelper(this._view.generateTableIterator());try{for(i.s();!(t=i.n()).done;){var o,r,s,a=(o=t.value).startIndex,l=o.colName,u=o.customValue,c=o.labelValue,d=o.rowIndex,h=p.valueOr(u,c);p.isNu(a)?n[a]=e?{startIndex:a}:o:e?n[d][l]='"'.concat(c,'"'):(r=this._columnSettings[l].dataType,s=void 0,s=f.FinancialData.is(r,h)?f.FinancialData.getValue(r,h):(announceWarnCode("jidw7f93",r,o),0),n[d][l]=s)}}catch(e){i.e(e)}finally{i.f()}return this._saveCurrentToStartIndexMap(),n},_saveCurrentToStartIndexMap:function(){this._currentToStartIndex=p.pluck(this._data,"startIndex"),this._startIndexToCurrent=p.invert(this._currentToStartIndex)},_initColumns:function(){this._columnSettings=this._view.absorbColumns()},_getStreamableColumns:function(){return p.pick(this._columnSettings,function(e){return e.finType&&e.streamerType})},_getNewDir:function(e){return this._sortState.colName===e?(this._sortState.dir+1)%3:1},_updateBulkOnMarkedRows:function(e,t,n){this.trigger("setMarkedRowsEv",e,t,n)},_makeComparisonFunction:function(e,n){return[[function(e,t){return e.startIndex-t.startIndex},function(e,t){return t[n]-e[n]},function(e,t){return e[n]-t[n]}],[function(e,t){return e.startIndex-t.startIndex},function(e,t){return e[n].localeCompare(t[n].trim())},function(e,t){return t[n].localeCompare(e[n].trim())}]][this._getComparisonTypeFromColName(n)][e]},_getComparisonTypeFromColName:function(e){return+p.isIn(["text"],this._columnSettings[e].dataType)}})}),define("Modules/TableControls/TableControlsView",["underscore","jquery","Backbone","Displayable","EventBus"],function(e,i,t,n,o){var r=["icon-tableX1","icon-tableX1-5","icon-tableX2"];return n.extend({_markupScheme:{"?spacingButton":".js-spacing-button","?spacingButtonIcon":".js-spacing-button-icon","?spacingPopup":".js-spacing-popup","?spacingOption":".js-spacing-option","?downloadButton":".js-download-button","?downloadPopup":".js-download-popup","?mobileFilter":".js-table-controls-mobile-filter","?mobileSort":".js-table-controls-mobile-sort","?mobileSortPopup":".js-table-controls-mobile-sort-popup"},events:{"?click .js-main-share-opener":"_fireShare"},initialize:function(e){n.prototype.initialize.call(this,e)},render:function(){return n.prototype.render.call(this),this._initializeControls(),this.setupPopup(this._dom.mobileSort,this._dom.mobileSortPopup),this._dom.mobileFilter.on("click",function(){return o.trigger("openMobileMajorFiltersEv")}),this.$el},updateSpacingIcon:function(e){this._dom.spacingButtonIcon.rAttr("class").aCl(r[e])},_initializeControls:function(){this._dom.spacingButton.exists()&&this._initSpacing(),this._dom.downloadButton.exists()&&this._initDownload()},_initSpacing:function(){var t=this;this.setupPopup(this._dom.spacingButton,this._dom.spacingPopup),this._dom.spacingPopup.f(".js-spacing-option").on("click",function(e){t.trigger("changeLineSpacingEv",i(e.currentTarget).data("value")),t.closePopupFromElement(t._dom.spacingPopup)})},_initDownload:function(){var e=this,t=this.closePopupFromElement.bind(this,this._dom.downloadPopup);this.setupPopup(this._dom.downloadButton,this._dom.downloadPopup),this._dom.downloadPopup.f(".js-download-image").on("click",this.loginOr(function(){return e.trigger("downloadImageEv"),t()})),this._dom.downloadPopup.f(".js-download-excel").on("click",this.loginOr(function(){return e.trigger("downloadCSVEv"),t()}))},_fireShare:function(e){var e=e.currentTarget,e=i(e).data(),t=e.url,n=e.title,e=e.desc;o.trigger("FireShareEv",t,n,e)}})}),define("Modules/TableControls/TableControls",["underscore","jquery","Backbone","Toolset","./TableControlsView"],function(t,e,n,i,o){return n.EModel.extend({initialize:function(e,t,n,i,o){this.bindReplications("_changeLineSpacing"),this._tablesCollection=e,this._$SectionContent=n,this._$mainContentContainer=i,this._initView(o)},render:function(){this._view.render()},_initView:function(e){this._view=new o(e),this._view.onMultiple({changeLineSpacingEv:this._changeLineSpacing.bind(this),downloadImageEv:this._downloadImage.bind(this),downloadCSVEv:this._downloadCSV.bind(this)})},_downloadImage:function(e){i.Export.downloadTableAsImage(this._$SectionContent,e)},_prepareDataArray:function(e){return e?t.clean(e):this._tablesCollection.reduce(function(e,t){return[].concat(_toConsumableArray(e),[t.getDataForExport().join("\n")])},[])},_downloadCSV:function(e){i.Export.downloadArrayAsCSV(this._prepareDataArray(e))},_changeLineSpacing:function(t){this._tablesCollection.each(function(e){return e.changeLineSpacing(t)}),this.replicate("_changeLineSpacing",t)}})}),define("ChartPresets",[],function(){var e={grid:"#eef3f7",chartBorder:"#e3eaf2",labelText:"#525f7f",volumeBorder:"#a7abb1",volumeAreaColor:"#88befc",up:"#00ca73",down:"#ff6960",fadedUp:"#84deb7",fadedDown:"#ffa5a0",blue:"#4b72e6",fadedBlue:"#9babc2",transparentBlue:"rgba(75, 114, 230, 0.8)",transparentFadedBlue:"rgba(155, 171, 194, 0.8)",crosshairColor:"#b9c6d7",lineColor:"#555f7a",markerColor:"#83acf7",white:"#fff",areaBorder:"#6da4f1",areaFill:"rgba(68,176,255,0.15)",negAreaFill:"rgba(255,128,123,0.15)",negAreaBorder:"#ffa5a0",grey:"#a2afcf"},t={labelStyle:{color:e.labelText,fontFamily:"Helvetica, Times",fontSize:"12px"}};return{_colors_:e,defaultChartConfig:{title:{text:null},chart:{plotBorderWidth:0,spacingRight:0,spacingLeft:1,spacingTop:0,spacingBottom:-10,style:{}},tooltip:{},rangeSelector:{enabled:!1},xAxis:[{ordinal:!0,dateTimeLabelFormats:{second:"%H:%M:%S",minute:"%H:%M",hour:"%H:%M",day:"%b %e",week:"%b %e",month:"%b %Y",year:"%b %Y"},gridLineColor:e.grid,gridLineWidth:0,gridZIndex:.5,labels:{align:"center",style:t.labelStyle,zIndex:7,y:-15,x:0,overflow:"allow"},lineWidth:0,tickWidth:0,type:"datetime",visible:!0,width:"100%"}],yAxis:[{gridLineColor:e.grid,gridLineWidth:1,gridZIndex:.5,labels:{align:"right",style:t.labelStyle,zIndex:7,y:0,x:-3,formatter:function(){return _.formatToBigNumber(this.value)}},opposite:!0,startOnTick:!0,endOnTick:!1,tickPixelInterval:40,type:"linear",title:{text:null},visible:!0,height:"100%"}],legend:{enabled:!1},plotOptions:{area:{animation:!1,fillColor:e.areaFill,lineColor:e.areaBorder,negativeFillColor:e.negAreaFill,negativeColor:e.negAreaBorder,lineWidth:1.3,fillOpacity:1,states:{hover:{lineWidth:2}}},candlestick:{lineWidth:1,lineColor:e.lineColor,upLineColor:e.lineColor,color:e.down,upColor:e.up,dataGrouping:{enabled:!1},pointPadding:.25},column:{animation:!1,pointPlacement:"on"},series:{groupPadding:.1,marker:{enabled:!1,radius:2}}},navigator:{enabled:!1},credits:{enabled:!1},exporting:{enabled:!1}},MiniChart:{xAxis:[{visible:!1}],yAxis:[{visible:!1}]},volumeAxis:{endOnTick:!1,startOnTick:!1,gridLineWidth:0,height:"20%",id:"volumes",labels:{enabled:!1},offset:0,opposite:!0,top:"80%",type:"column",title:{text:""}},volumeSeries:{data:[],enableMouseTracking:!0,marker:{states:{hover:{enabled:!1}}},name:"Volume",type:"column",yAxis:1,color:e.volumeAreaColor},columns:{chart:{type:"column",spacingBottom:0},borderWidth:.5,dataGrouping:{enabled:!1},enableMouseTracking:!1,marker:{states:{hover:{enabled:!1}}},xAxis:{},yAxis:[{labels:{align:"left",x:3}}],pointWidth:1},area:{chart:{type:"area",spacingBottom:0},borderWidth:.5,dataGrouping:{enabled:!1},enableMouseTracking:!1,marker:{states:{hover:{enabled:!1}}},plotOptions:{series:{marker:{enabled:!0,radius:2}}},xAxis:{},yAxis:[{labels:{align:"left",x:3}}],pointWidth:1},donut:{chart:{plotBackgroundColor:null,plotBorderWidth:null,marginTop:10,marginBottom:10,marginRight:10,marginLeft:10,type:"pie"},plotOptions:{pie:{size:"100%",innerSize:"90%",borderWidth:1,enableMouseTracking:!1,dataLabels:{enabled:!0,style:t.labelStyle,distance:5,padding:0,connectorPadding:0,connectorWidth:0,overflow:"allow",crop:!1,allowOverlap:!0,formatter:function(){return this.point.y||""}}}},tooltip:{enabled:!1},xAxis:null,yAxis:null},pie:{chart:{plotBackgroundColor:null,plotBorderWidth:null,marginTop:10,marginBottom:10,type:"pie"},plotOptions:{pie:{size:"100%",innerSize:"40%",borderWidth:1,enableMouseTracking:!1,dataLabels:{enabled:!0,style:t.labelStyle,distance:5,padding:0,connectorPadding:0,connectorWidth:0,overflow:"allow",crop:!1,allowOverlap:!0,formatter:function(){return this.point.y?"".concat(this.point.y.toFixed(2),"%"):""}}}},tooltip:{enabled:!1},xAxis:null,yAxis:null},dualLines:{chart:{marginRight:120,marginTop:10,marginBottom:30,events:{load:function(){_.e(this.series,function(e,t){t&&_.last(e.points).update({marker:{enabled:!0,radius:3,symbol:"circle"},dataLabels:{enabled:!0}})})}}},xAxis:{plotLines:[{color:e.grid,value:11,width:1}],tickLength:0,labels:{style:_.extend({},t.labelStyle,{whiteSpace:"nowrap"}),enabled:!0,step:1}},yAxis:{title:{text:null},labels:{enabled:!0,style:t.labelStyle},gridLineColor:e.grid},plotOptions:{series:{marker:{enabled:!1},animation:{duration:2e3},states:{hover:{enabled:!1,halo:{size:0}}},dataLabels:{align:"left",allowOverlap:!0,enabled:!1,style:t.labelStyle,formatter:function(){return'<span style="color:'.concat(e.labelText,'">').concat(this.point.y.toFixed(2),'</span><span style="color: ').concat(e.grey,';"> - ').concat(this.point.series.name,"</span>")},crop:!1,overflow:"allow",x:10,y:10}}},tooltip:{enabled:!1}},rendererPlotLine:{color:"#77a2d5",width:1,label:{verticalAlign:"bottom",textAlign:"center",style:{fontSize:10,fontFamily:"Arial, sans-serif"},rotation:0},zIndex:7},innerAxes:{chart:{spacingBottom:0},xAxis:[{labels:{style:{color:"#A0A0A0"},y:-5},visible:!0}],yAxis:[{labels:{align:"right",style:{color:"#A0A0A0"},x:-8,y:-15},visible:!0,height:"100%"}]},overviewChart:{chart:{spacingRight:0,spacingLeft:0,marginRight:54,marginBottom:30,style:{fontSize:"10px"},alignTicks:!1,plotBorderColor:e.chartBorder,plotBorderWidth:1},xAxis:[{labels:{style:t.labelStyle,enabled:!0,zIndex:1,y:20},gridLineWidth:1,gridLineColor:e.grid,gridLineDashStyle:"solid",tickWidth:0,lineWidth:0,crosshair:!1,type:"datetime",dateTimeLabelFormats:{second:"%H:%M:%S",minute:"%H:%M",hour:"%H:%M",day:"%b %e",week:"%b %e",month:"%b %Y",year:"%b %Y"}}],yAxis:[{height:"100%",labels:{style:t.labelStyle,align:"left",x:5,y:0,zIndex:5,formatter:function(){return _.formatNumber(this.value)}},crosshair:!1,gridLineWidth:1,gridLineColor:e.grid,gridLineDashStyle:"solid",opposite:!0,startOnTick:!1,endOnTick:!1,type:"linear",tickPixelInterval:40,plotLines:[]}],tooltip:{enabled:!1},plotOptions:{area:{lineWidth:2},candlestick:{lineWidth:1,states:{hover:{lineWidth:1.5}}},column:{borderWidth:0,states:{hover:{borderWidth:1.5,borderColor:e.lineColor}}},series:{marker:{enabled:!1,states:{hover:{enabled:!1}}}}},exporting:{enabled:!1,allowHTML:!0,type:"image/jpeg",sourceWidth:1040,sourceHeight:400}},chartName:{eventHistoricalDataChart:{xAxis:{tickWidth:0},plotOptions:{column:{pointPlacement:"between"}},tooltip:{useHTML:!0},navigator:{enabled:!0,series:{negativeFillColor:e.areaFill,negativeColor:e.blue}}}}}}),define("Modules/Charts/InstrumentChartView",["underscore","jquery","Backbone","Displayable","Highcharts"],function(s,n,e,i,o){var t,r,a,l,u;return t=o.getOptions().plotOptions,r=o.seriesTypes,a=o.merge,l=o.extendClass,u=o.each,t.coline=a(t.column,{height:2}),r.coline=l(r.column,{type:"coline",drawPoints:function(){var n=this;u(this.points,function(e){var t;e.y<0&&(t=e.shapeArgs.height,e.shapeArgs.y+=t-n.options.height),e.shapeArgs.height=n.options.height,--e.shapeArgs.width}),r.column.prototype.drawPoints.call(this)}}),i.extend({_markupScheme:{},_chart:null,events:{},_renderImage:null,initialize:function(e,t){i.prototype.initialize.call(this,e),this._renderImage=t,this._setupHighchartsDefaults()},render:function(){return i.prototype.render.call(this),this.$el},drawAreaChart:function(e){var t=this._setYAxisBorders,n=this;e.chart.renderTo=this.$el.get(0),e.chart.events={load:function(){t.call(n,this)}},this._chart=o.chart(e),this._renderImage&&this._paintWatermark()},_paintWatermark:function(){var e=n.getWatermark(),t=s.isNu(this._renderImage)?this._renderImage:96;this._chart.renderer.image(e,24,t,160,27).attr({zIndex:99}).add()},_setYAxisBorders:function(e){var t=1<arguments.length&&void 0!==arguments[1]?arguments[1]:0,n=2<arguments.length?arguments[2]:void 0,i=e.yAxis[0],o=this._yesterdaysLast,t=t/e.yAxis[0].height,r=s.isNu(o)?s.minV(o,i.dataMin):i.dataMin,o=s.isNu(o)?s.maxV(o,i.dataMax):i.dataMax,t=(o-r)*t,r=r-t,o=o+t;r-=.25*Math.abs(o-r),i.setExtremes(r,o,!0,!!n&&{duration:100}),this._optionsObj&&e.xAxis[0]},_setupHighchartsDefaults:function(){o.setOptions({lang:{decimalPoint:".",thousandsSep:","},time:{timezoneOffset:0}})},_downloadChartImage:function(){this._chart.exportChartLocal()}})}),define("InstrumentChart",["underscore","jquery","Backbone","Server","ChartPresets","Modules/Charts/InstrumentChartView"],function(i,e,t,n,o,r){var s={filterDataByRange:!0,buildXAxisCategories:!1};return t.EModel.extend({_preset:null,_jsonHash:null,_instrumentId:null,_defaultPeriod:null,_renderImage:null,_chartSettings:null,initialize:function(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{},t=e.preset,n=e.jsonHash,i=e.period,e=e.renderImage;this._preset=t,this._jsonHash=n,this._defaultPeriod=i,this._renderImage=e},render:function(e){return this._view=new r(e,this._renderImage),this._view.render(),this._fetchDataAndRedraw(),this},downloadChartImage:function(){return this._view._downloadChartImage()},initChartSettings:function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];this._chartSettings=i.deepCopy.apply(i,[s].concat(t))},_fetchDataAndRedraw:function(){n.Charts.FetchAggregatedData(this._jsonHash,this._defaultPeriod).then(this._drawChart.bind(this))},_drawChart:function(e){var t=i.deepCopy(o.defaultChartConfig,o[this._preset]);t.series=this._buildDataSeries(e,"area"),this._view.drawAreaChart(t)},_buildDataSeries:function(e,t){return[{name:"Last",type:t,dataGrouping:{enabled:!1},data:e.candles},{name:"News",type:"flags",onSeries:"candles",shape:"squarepin",zIndex:10,data:[]},{name:"Economic Events",type:"flags",onSeries:"candles",shape:"squarepin",zIndex:11,data:[]}]}})}),define("Modules/Charts/ChartToolsView",["underscore","jquery","Backbone","Displayable"],function(e,t,n,i){return i.extend({_markupScheme:{rangeButtons:".js-chart-tools-range-list button",typeButtons:".js-chart-tools-type-button"},events:{},initialize:function(e){i.prototype.initialize.call(this,e)},render:function(){var t=this;i.prototype.render.call(this),e.e$(this.$el.mF(".js-chart-tools-range-list li"),function(e){return e.on("click",t._switchRange.bind(t,e))}),e.e$(this.$el.mF(".js-chart-tools-type-button"),function(e){return e.on("click",t._switchChartType.bind(t,e))})},getSelectedRange:function(){return this._dom.rangeButtons.getSelected().data("range")},clearRange:function(){this._dom.rangeButtons.unselect().blur()},_switchRange:function(e){e=e.getButton();this._dom.rangeButtons.unselect(),e.setSelected(),this.trigger("changeChartRangeEv")},_switchChartType:function(e){var t=e.data("type");this._dom.typeButtons.unselect(),e.setSelected(),this.trigger("changeChartTypeEv",t)}})}),define("Modules/Charts/StandaloneChartView",["underscore","jquery","Backbone","ChartPresets","./InstrumentChartView","Highcharts","Moment"],function(n,t,e,i,o,r,s){function a(){return'<span style="font-size: 10px">'.concat(s.timestampToClientTimezone(this.x),'</span><br/>\n\t\t\t\t\t\t<span style="color:').concat(this.color,'">●</span><b> ').concat(this.y," </b><br/>")}function l(e){return e.defaultFormatter.call(this,e)}function u(e){return r.dateFormat(e?"%Y":"%b %Y",1e3*this.value)}var c=["BALMainTable","INCMainTable","CASMainTable","INCSummeryInfo","BALSummeryInfo","CASSummeryInfo"],d=["eventHistoricalDataChart"],h=["eventHistoricalDataChart"],p=["eventHistoricalDataChart"];return o.extend({_chart:null,_chartName:null,_markupScheme:{},initialize:function(e,t){this._chartName=t,o.prototype.initialize.call(this,e)},render:function(e){return o.prototype.render.call(this),this._initChartYaxis(e),e.chart.renderTo=this.$el.get(0),r.setOptions({lang:{numericSymbols:["K","M","B","T"]}}),t.isMobile()&&(e.navigator.enabled=!1),this._applyXAxisFormatter(e),this._applyTooltipFormatter(e),this._chart=r.chart(e),this.$el},redraw:function(){this._chart.reflow()},setXAxisExtremes:function(e,t){this._chart.xAxis[0].setExtremes(e,t,!0,!1)},updateChart:function(e){this._chart.update(e)},_initChartYaxis:function(e){n.isIn(c,this._chartName)&&n.e(e.series,function(e){e.data=n.map(e.data,function(e){return 1e6*e})}),n.isIn(d,this._chartName)&&this._manipulateSeriesColor(e),n.isIn(h,this._chartName)&&this._initPlotLine(e)},_manipulateSeriesColor:function(e){n.e(e.series,function(e){e.data=n.map(e.data,function(e){return e.color=n.isNegative(e.y)?i._colors_.fadedDown:i._colors_.blue,e})})},_applyXAxisFormatter:function(e){var t=this;n.isIn(p,this._chartName)&&(e.xAxis.labels={formatter:function(){return u.call(this,"max"===t.ask("selectedRangeQ"))}},e.navigator.xAxis={labels:{formatter:function(){return u.call(this,!0)}}})},_initPlotLine:function(e){e.yAxis[0].plotLines=[{value:0,width:1,zIndex:10,color:i._colors_.blue}]},_applyTooltipFormatter:function(e){e.tooltip.formatter="eventHistoricalDataChart"===this._chartName?a:l},_downloadChartImage:function(){this._chart.exportChartLocal({type:"image/jpeg"})}})}),define("Modules/Charts/StandaloneChart",["underscore","jquery","Backbone","Server","DataChest","InstrumentChart","ChartPresets","Toolset","EventBus","Modules/Charts/ChartToolsView","Modules/Charts/StandaloneChartView"],function(l,e,t,n,u,i,c,o,r,s,d){var a={pie:"_makeDonutSeries",donut:"_makeDonutSeries",columns:"_makeColumnSeries",area:"_makeColumnSeries",dualLines:"_makeDualSeries"},h={5:"0",11:"1",18:"2"},p={"1-year":l.oneYear,"2-years":2*l.oneYear,"5-years":5*l.oneYear},f={buildXAxisCategories:!0},m={eventHistoricalDataChart:{filterDataByRange:!1,buildXAxisCategories:!1}};return i.extend({_chartData:null,_chartName:null,_chartType:null,_chartObj:null,_extraYAxis:null,_chartTools:null,initialize:function(){var t=this;i.prototype.initialize.call(this),r.on("redrawChartEv",function(e){return t._chartName.is(e)&&t._view.redraw()})},render:function(e,t){var n=e.data("chart-name"),i=e.data("chart-type"),o=l.deepCopy(c.defaultChartConfig,c[i],c.chartName[n]),t=t||u.get(n)||u.getClientData("virtualClientData")[n],r=e.mF(".js-chart-inner-container"),s=e.f(".js-chart-tools-wrapper"),a=s.exists();return this._chartName=n,this._chartType=i,this._chartObj=o,this._chartData=t,this._extraYAxis=!!e.data("extra-y-axis"),this.initChartSettings(f,m[n]),this._extraYAxis&&o.yAxis.push(l.deepCopy(o.yAxis[0],{opposite:!1})),this._setCategoriesAndSeries(),this._view=new d(r,this._chartName),a&&this._initializeChartTools(s),this._view.render(o),a&&this._setDataByRange(),this},_initializeChartTools:function(e){var t=this;this._chartTools=new s(e),this._chartTools.render(),this._chartTools.onMultiple({changeChartRangeEv:this._setDataByRange.bind(this),changeChartTypeEv:this._changeChartType.bind(this)}),this._view.answer("selectedRangeQ",function(){return t._chartTools.getSelectedRange()})},_changeChartType:function(e){this._chartType=e,this._chartObj=l.deepCopy(c.defaultChartConfig,c[e],c.chartName[this._chartName]),this._view.updateChart(this._chartObj)},_setCategoriesAndSeries:function(){var n=this;this._chartObj.series=this._chewChartData(this._chartData,this._chartType),l.isntE(this._chartData.xLabels)&&(this._chartSettings.buildXAxisCategories?this._chartObj.xAxis.categories=this._chartData.xLabels:this._chartObj.series[0].data=l.map(this._chartObj.series[0].data,function(e,t){return{x:n._chartData.xLabels[t],y:e}}))},_chewChartData:function(e,t){var e=e.sets,n=l.clean(l.pluck(e,"overlayData"));return this[a[t]](e).concat(l.map(n,this._makeOverlayLine.bind(this)))},_setDataByRange:function(){var t,e,n,i=this._chartTools.getSelectedRange();"max"!==i&&(t=Date.now()-p[i],i=l.indexOf(this._chartData.xLabels,l.find(this._chartData.xLabels,function(e){return t<=1e3*e})),e=this._chartData.xLabels[i],n=this._chartData.xLabels[this._chartData.xLabels.length-1]),this._view.setXAxisExtremes(e,n),this._bindNavigatorEvent()},_bindNavigatorEvent:function(){var t=this;this._view.updateChart({xAxis:{events:{setExtremes:function(e){"navigator"===e.trigger&&t._chartTools.clearRange()}}}})},_makeDualSeries:function(e){var n=this;return this._chartObj.xAxis.categories=l.map(Array(24),function(e,t){return h[t]?n._chartData.xLabels[h[t]]:""}),l.map(e,function(e,n){var t=e.name,i=e.data;return{name:t,color:e.color,data:l.map(i,function(e,t){return{x:t+(n?11:0),y:e}})}})},_makeColumnSeries:function(e){return l.map(e,this._makeColumn.bind(this))},_makeColumn:function(e,t){var n=e.name,i=e.data;return{name:n,color:e.color,yAxis:this._extraYAxis?t:0,data:l.map(i,function(e){return o.FinancialData.getAnyRawValue(e)})}},_makeDonutSeries:function(e){var i=[{data:[]}];return l.e(e,function(e){var t=e.data,n=e.name,e=e.color;i[0].data.push({y:t[0],name:n,color:e})}),i},_makeOverlayLine:function(e,t){return l.extend(this._makeColumn(e,t),{type:"coline",borderWidth:0,height:2})}})}),define("Modules/BulkActions/BulkActionsView",["underscore","jquery","Backbone","Displayable"],function(t,e,n,i){return i.extend({exportPopup:null,_markupScheme:{markedCounter:".js-marked-row-counter","?portfolioPopupWrapper":".js-bulk-portfolio-popup-wrapper","?downloadsPopupButton":".js-bulk-button-downloads","?downloadsPopup":".js-bulk-downloads-popup","?chartPopup":".js-bulk-create-chart-popup","?chartContainer":".js-bulk-chart-content","?chartLegendItems":".js-chart-legend-item-wrapper","?exportPopupButton":".js-export-button"},events:{"?click .js-bulk-button-portfolio":"_openPortfolioPopup","?click .js-bulk-button-alerts":"_openAlertsPopup","?click .js-bulk-button-event-alerts":"_openEventAlertsPopup","?@click .js-bulk-download-excel":"_downloadExcel","?@click .js-bulk-download-image":"_downloadImage","?click .js-bulk-create-chart":"_openChartPopup","?click .js-download-chart-button":"#downloadChartEv","?click .js-export-button":"_openExportPopup","click .js-clear-all-selected":"#clearMarkedRowsEv"},initialize:function(e){i.prototype.initialize.call(this,e)},render:function(){return i.prototype.render.call(this),this.setupPopup(this._dom.downloadsPopupButton,this._dom.downloadsPopup),this.$el},destroy:function(){this.unsetupPopup(this._dom.downloadsPopupButton),this.unsetupPopup(this._dom.exportPopupButton)},updateMarkedRows:function(e){this._dom.markedCounter.text(e),this._dom.exportPopupButton.exists()&&this._toggleExportButton(e),this.$el.toggleEl(!!e)},updateChartLegend:function(e){var n=this;this._dom.chartLegendItems.hideEl(),t.e(e,function(e,t){t=n._dom.chartLegendItems.eq(t).showEl();t.mF(".text").textT(e.name),t.mF(".graph-legend-item-color").css({"background-color":e.color})})},showExportPopup:function(e){this.exportPopup=e,this.fireRelocate(e,this._dom.exportPopupButton,{onClose:this._closeExportPopup.bind(this)})},_toggleExportButton:function(){var e=this.ask("hasExportButtonQ");this._dom.exportPopupButton.toggleEl(e)},_openExportPopup:function(){this.exportPopup?this.closePopupFromElement(this.exportPopup):this.trigger("fetchExportPopupEv")},_closeExportPopup:function(){this.unsetupPopup(this._dom.exportPopupButton),this.exportPopup=null},_downloadExcel:function(){this.trigger("bulkDownloadCSVViewEv"),this.closePopupFromElement(this._dom.downloadsPopup)},_downloadImage:function(){this.closePopupFromElement(this._dom.downloadsPopup),this.trigger("bulkDownloadImageViewEv")},_openPortfolioPopup:function(){this.trigger("openPortfolioPopupEv",this._dom.portfolioPopupWrapper)},_openChartPopup:function(){this.trigger("createChartPopupEv",this._dom.chartPopup,this._dom.chartContainer)},_openAlertsPopup:function(){this.trigger("openAlertsPopupEv")},_openEventAlertsPopup:function(){this.trigger("openEventAlertsPopupEv")}})}),define("Modules/BulkActions/BulkActions",["underscore","jquery","Backbone","Http","Toolset","EventBus","AlertActions","PortfolioActions","DataChest","Server","TemplateManager","Modules/Charts/StandaloneChart","./BulkActionsView"],function(i,n,o,e,t,r,s,a,l,u,c,d,h){var p="Quotes Table";return o.EModel.extend({_view:null,_bulkSettings:null,_markedRowsData:null,_hiddenInstrumentIds:null,_chart:null,_$SectionContent:null,events:{},initialize:function(e,t){o.EModel.prototype.initialize.call(this),this.initTables(e),this._$SectionContent=t,this._markedPairIds=new Set,this._markedRowsData={},this._hiddenInstrumentIds={}},render:function(e){var o=this;this._view=new h(e),this._view.render(),this._view.onMultiple({openPortfolioPopupEv:this._openPortfolioPopup.bind(this),openAlertsPopupEv:this._openAlertsPopup.bind(this),openEventAlertsPopupEv:this._openEventAlertsPopup.bind(this),createChartPopupEv:function(e,t){var n=new d,i=o._tablesCollection.models[0].getDataForChart();o.firePopup(e,["modal"]),n.render(t,i),o._chart=n,o._view.updateChartLegend(i.sets)},downloadChartEv:function(){return o._chart.downloadChartImage()},clearMarkedRowsEv:function(){return o._clearMarkedRows()},bulkDownloadCSVViewEv:this.loginOr(this._downloadTableAsCsv.bind(this)),bulkDownloadImageViewEv:this.loginOr(this._downloadTableAsImage.bind(this)),fetchExportPopupEv:this._fetchExportPopup.bind(this)}).answer("hasExportButtonQ",this._hasExportButton.bind(this)),r.on("resetBulkActionsEv",function(){return o._clearMarkedRows()})},initTables:function(e){this._tablesCollection=e,this._tablesCollection.onMultiple({setMarkedRowsEv:this._setMarkedRows.bind(this),visibleTableRowsChangedEv:this._applyTableFilterOnSelected.bind(this)})},destroy:function(){this._view.destroy()},_clearMarkedRows:function(){this._tablesCollection.each(function(e){return e.unmarkAll()}),this._setMarkedRows()},_applyTableFilterOnSelected:function(e,t){this._hiddenInstrumentIds[e]=t,this._updateMarkCount()},_setMarkedRows:function(e,t,n){this._markedPairIds[i.isNu(e)?t?"delete":"add":"clear"](e),t?delete this._markedRowsData[e]:this._markedRowsData[e]=n,this._updateMarkCount()},_getMarkedIdsArray:function(){var e=_toConsumableArray(this._markedPairIds),t=i.flatten(i.values(this._hiddenInstrumentIds));return i.arentE(e,t)?i.difference(e,t):e},_getRowData:function(e){return this._markedRowsData[e]},_updateMarkCount:function(){this._view.updateMarkedRows(i.size(this._getMarkedIdsArray()))},_getGtmPageType:function(){return l.get("GTMData").pageType},_openPortfolioPopup:function(e){a.openPortfolioPopup(this._getMarkedIdsArray(),e,!1,p),this.GTM("BulkActionsWatchButton",i.convertToArray(this._markedPairIds),this._getGtmPageType())},_openAlertsPopup:function(){var t,n=this._getMarkedIdsArray();i.isSizeOne(this._markedPairIds)?s.openSinglePairPopup(n[0],p):(t=[],this._tablesCollection.each(function(e){return t.push.apply(t,_toConsumableArray(e.getPairNamesByIds(n)))}),s.openMultiPairPopup(n,t,p)),this.GTM("BulkActionsAddAlert",i.convertToArray(this._markedPairIds),this._getGtmPageType())},_openEventAlertsPopup:function(){s.openEventAlertPopup.apply(s,[null].concat(_toConsumableArray(this._getMarkedIdsArray())))},_hasExportButton:function(){var e=!1;return e=i.isSizeOne(this._markedPairIds)&&this._getRowData(this._getMarkedIdsArray()[0]).futureEvent?!0:e},_fetchExportPopup:function(){var t=this;u.Render.ExportEventPopup(this._getMarkedIdsArray()[0]).then(function(e){c.render({body:e}).then(function(e){e=e.body;t._view.showExportPopup(n(e))})})},_downloadTableAsImage:function(){t.Export.downloadTableAsImage(this._$SectionContent,!0)},_downloadTableAsCsv:function(){var e=i.reduce(this._tablesCollection.reduce(function(e,t){return[].concat(_toConsumableArray(e),[t.getDataForExport(!0)])},[]),function(e,t){return[].concat(_toConsumableArray(e),[t[1]?t.join("\n"):""])},[]);t.Export.downloadArrayAsCSV(i.clean(e))}})}),define("Modules/GlobalSearch/GlobalSearchView",["underscore","jquery","Backbone","Displayable","DataChest"],function(a,n,e,t,c){var o={instrument:"_buildInstrumentLI",ec_event:"_buildEconomicEventLI"},r={instrument:"instrumentResultsContainer",ec_event:"eventResultsContainer"};return t.extend({_lastFiredQuery:null,_currentFocusedItemIndex:null,_lastSearchContainer:null,_itemIndexToSelectionTrigger:null,_markupScheme:{resultWrapper:".js-instrument-search-results",instrumentResultsContainer:".js-instrument-search-results",resultClone:".js-instrument-search-result-clone",resultScroller:".js-instrument-search-scroller",noResults:".js-instrument-search-no-res","?eventResultsContainer":".js-event-search-results","?eventResultClone":".js-event-search-result-clone"},initialize:function(e){t.prototype.initialize.call(this,e)},render:function(){return t.prototype.render.call(this),this._dom.resultClone.remove(),this.$el},hideSearchResults:function(){this._dom.noResults.hideEl(),this._dom.resultWrapper.hideEl(),this.clearResultsInView(),this.$el.showEl()},populateSearchResults:function(e,t){var n=2<arguments.length&&void 0!==arguments[2]?arguments[2]:"instrument",i=a.isntE(e),t=this[o[n]].bind(this,t),n=this._dom[r[n]];this._dom.noResults.toggleEl(!i),this._dom.resultWrapper.toggleEl(i),n.toggleEl(i),this.$el.showEl(),i&&(this._currentFocusedItemIndex=0,this._itemIndexToSelectionTrigger=[],n.buildAndPopulate(e,t),this._navigateToListItem(0))},clearResultsInView:function(){this._dom.resultWrapper.empty()},bindGlobalSearchView:function(e,t,n){var i,o,r,s=this;e.exists()&&(i=e.mF(".js-instrument-search-results-wrapper"),r=function(){var e=o.valT();e&&o.isActive()?(i.showEl(),s.$el.showEl(),s.abortCall("Instrument Search"),s.trigger("fireGlobalInstrumentSearchEv",e,function(){return t.apply(void 0,arguments),o.val("")},n),s._lastSearchContainer!==i&&(s.fireRelocate(s.$el,i,["sticky"]),s._lastSearchContainer=i)):(i.hideEl(),s._lastSearchContainer=null)},(o=e.mF(".js-instrument-search-input")).on("keydown",function(e){return s.navigateResultsInView(e,o)}).on("input",a.debounce(r,500)).on("focus",r).onTimeoutBlur(function(){return i.hideEl()}))},navigateResultsInView:function(e,t){this._dom.resultWrapper.isVisible()&&(13===e.which?(t&&(t.val(""),n.blur()),this._itemIndexToSelectionTrigger[this._currentFocusedItemIndex](),a.pD(e)):38===e.which||9===e.which&&e.shiftKey?(this._navigateToListItem(Math.max(0,this._currentFocusedItemIndex-1)),a.pD(e)):a.isIn([9,40],e.which)&&(this._navigateToListItem(Math.min(this._itemIndexToSelectionTrigger.length-1,this._currentFocusedItemIndex+1)),a.pD(e)))},_navigateToListItem:function(e){var t=this._dom.resultWrapper.mF(">li");t.eq(this._currentFocusedItemIndex).rCl("is-marked"),this._dom.resultScroller.scrollElementIntoView(t.eq(e).aCl("is-marked")),this._currentFocusedItemIndex=e},_buildInstrumentLI:function(e,t){function n(){return e?e(i,u):announceWarn("No 'onSelect' Handler(s) attached")}var i=t.pair_ID,o=t.pair_type,r=t.name,s=t.flag,a=t.tab_ID,l=t.exchange_name_short,u=t.symbol,t=this._dom.resultClone.clone().rCl("js-instrument-search-result-clone");return this._itemIndexToSelectionTrigger.push(n),t.mF("[data-label]").textT(r),t.mF("[data-flag]").aCl("flag-"+s.toLowerCase()),t.mF("[data-a]").textT(a),t.mF("[data-b]").textT(l),t.mF("[data-c]").textT(u),t.on("click",n),c.loadInstrumentData({pId:i,name:r,type:o}),t},_buildEconomicEventLI:function(e,t){var n=this._dom.eventResultClone.clone().rCl("js-instrument-search-result-clone");return n.mF(".js-item-flag").aCl("flag-".concat(a.toLowerCase(t.flag))),n.mF(".js-item-symbol").textT(t.symbol),n.mF(".js-item-name").textT(t.name).attr("title",t.name),n.mF(".js-item-star").slice(+t.importance,3).remove(),n.on("click",function(){return e(t)}),n}})}),define("Modules/GlobalSearch/GlobalSearch",["underscore","jquery","Backbone","Server","./GlobalSearchView"],function(e,t,n,o,i){return n.EModel.extend({_bubbleEvents:{_view:"searchResultSelectedEv"},initialize:function(e){this._view=new i(e),this._view.on("fireGlobalInstrumentSearchEv",this.fireInstrumentSearch.bind(this))},render:function(){this._view.render(),this.delegateBubbling()},fireInstrumentSearch:function(e,t,n){var i=this;return this._view.hideSearchResults(),n?o.Search.All(e,n).then(function(e){return i._view.populateSearchResults(e[n],t,n)}):o.Instrument.Search(e).then(function(e){e=e.All;return i._view.populateSearchResults(e,t)})},bindGlobalSearch:function(e,t,n){this._view.bindGlobalSearchView(e,t,n)},navigateResults:function(e,t){this._view.navigateResultsInView(e,t)},clearResults:function(){this._view.clearResultsInView()}})}),define("Modules/Discussion/CommentInputView",["underscore","jquery","Backbone","Modules/GlobalSearch/GlobalSearch","Displayable"],function(i,r,e,n,o){var s={$:"_startInstrumentTagSearchMode","@":"_askForUsers"};return o.extend({_markupScheme:{postButton:".js-add-post-button",postBoxWrapper:".js-post-box-wrapper",postBoxContent:".js-post-box-content",postBoxFooter:".js-post-box-footer",remainingCharacters:".js-remaining-characters",guidelinesButton:".js-comment-input-guidelines-button",guidelinesPopup:".js-comment-input-guidelines-popup",chartPreviewWrapper:".js-attach-chart-box-wrapper",chartPreviewImage:".js-attach-chart-box-wrapper > img",attachImageWrapper:".js-attach-image-box-wrapper",attachImageErrorWrapper:".js-attach-image-box-error-wrapper",emojiButton:".js-attach-emoji-button",emojiPopup:".js-emoji-popup",cashTagButton:".js-comment-input-add-cashtag-button",searchPopupWrapper:".js-comment-input-instrument-search",searchPopup:".js-comment-input-instrument-search-popup",usersPopup:".js-comment-input-users-search",userLiClone:".js-comment-input-users-search-result-clone"},events:{"click .js-comment-input-guidelines-button":"_openGuidelinePopup","click .js-add-post-button":"_postCommentIfLoggedIn","click .js-attach-image-button":"_showAttachImageBox","click .js-attach-chart-button":"#openChartPopupEv","click .js-comment-input-add-cashtag-button":"_startInstrumentTagSearchMode","click .js-comment-input-add-mention-button":"_askForUsers","click .js-delete-preview-chart":"_deletePreviewChart"},initialize:function(e){o.prototype.initialize.call(this,e)},render:function(){var t=this;return o.prototype.render.call(this),this._bindCommentInput(),this._bindDropFilesBox(),this.setupPopup(this._dom.emojiButton,this._dom.emojiPopup),this._dom.emojiPopup.mF("li").on("click",function(e){e=e.currentTarget;return t._addTextToContent(r(e).textT())}),this._instrumentSearch=new n(this._dom.searchPopupWrapper.remove().showEl()),this._instrumentSearch.render(),this._dom.usersPopup.remove().showEl(),this.$el},addPreviewChartImage:function(e){this._dom.chartPreviewImage.attr("src",e),this._dom.chartPreviewWrapper.showEl()},addNewUserTagInView:function(e,t){this._trimLineBreak(),this._addElementAndFocusAfter('<span class="js-new-user-tag common-link" data-user-id="'.concat(t,'" contenteditable="false">').concat(e,"</span>")),this._validateComment()},startUserMentionMode:function(e){var n=this;i.isntE(e)&&(this._$currentSearchEl=r('<span class="js-edit-mode-user-tag common-link" contenteditable="true">').text("@"),this._dom.usersPopup.mF("ul").buildAndPopulate(e,this._buildUsersPopupLI.bind(this,function(e,t){n.addNewUserTagInView(t,e),n._stopSearchModes()})),this._trimLineBreak(),this._appendCurrentSearchEl(this._dom.usersPopup),this._dom.postBoxContent.on("keydown.searchUsers",i.debounce(this._fireUsersSearch.bind(this),500)),this._dom.postBoxContent.on("blur.searchUsers",function(e){return setTimeout(function(){return n._stopSearchModes(e)},200)}),this._$currentSearchEl.setCaretToEditablecontentEnd())},_openGuidelinePopup:function(){this.firePopup(this._dom.guidelinesPopup,["modal"])},_startInstrumentTagSearchMode:function(e){var t=this;this._$currentSearchEl=r('<span class="js-edit-mode-cash-tag common-link" contenteditable="true">').text("$"),this._instrumentSearch.clearResults(),this._dom.searchPopup.hideEl(),this._trimLineBreak(),this._appendCurrentSearchEl(this._dom.searchPopupWrapper),this._dom.postBoxContent.on("keydown.searchInstrument",i.debounce(this._fireInstrumentTagSearch.bind(this),500)),this._dom.postBoxContent.on("keydown.searchInstrumentNav",function(e){return t._instrumentSearch.navigateResults(e)}),this._dom.postBoxContent.on("blur.searchInstrument",function(e){return setTimeout(function(){return t._stopSearchModes(e)},200)}),this._$currentSearchEl.setCaretToEditablecontentEnd(),i.pD(e)},_addInstrumentTag:function(e,t){this._trimLineBreak(),this._addElementAndFocusAfter('<span class="js-new-cash-tag common-link" data-pair-id="'.concat(t,'" contenteditable="false">$').concat(e,"</span>")),this._validateComment()},_appendCurrentSearchEl:function(e){var t=window.getSelection(),n=t.focusOffset,t=t.focusNode,i=r(t),o=i.text();i.isChildOf(this._dom.postBoxContent)?(t.textContent=o.substr(0,n),i.after(e),e.before(this._$currentSearchEl).after(o.substr(n))):i.is(this._dom.postBoxContent)?(this._dom.postBoxContent.append(e),e.before(this._$currentSearchEl)):(lcl(i),announceWarn("Focus on non-editable element"))},_addElementAndFocusAfter:function(e){var e=r(e),t=e.html(e.text()+"&nbsp;");this._$currentSearchEl?this._$currentSearchEl.after(t):this._dom.postBoxContent.html(t),e.setCaretAfterNode()},_addTextToContent:function(e){this._dom.postBoxContent.append(e),this._dom.postButton.disable(!this._validateComment())},_fireUsersSearch:function(){var t;this._$currentSearchEl&&(t=this._$currentSearchEl.textT().substr(1),i.e$(this._dom.usersPopup.f("li"),function(e){return e.toggleEl(i.containsText(e.textT(),t))}))},_fireInstrumentTagSearch:function(e){var n=this,e=e.which;this._$currentSearchEl&&i.isntIn([37,38,39,40],e)&&((e=this._$currentSearchEl.textT().substr(1))&&this._instrumentSearch.fireInstrumentSearch(e,function(e,t){n._addInstrumentTag(t,e),n._stopSearchModes()}),this._dom.searchPopup.toggleEl(e))},_trimLineBreak:function(){var e=this._dom.postBoxContent[0].childNodes,e=e[e.length-1];e&&"BR"===e.tagName&&r(e).remove()},_buildUsersPopupLI:function(e,t){var n=t.userFullName,i=t.userNickname,o=t.userId,t=t.userImageSrc,r=this._dom.userLiClone.clone().rCl("js-comment-input-users-search-result-clone");return r.mF("img").attr("src",t),r.mF(".js-user-popup-full-name").textT(n),r.mF(".js-user-popup-nickname").textT(i),r.on("click",function(){return e(o,i)}),r},_askForUsers:function(e){i.pD(e),this.trigger("getAvailableUserToTag")},_replaceTags:function(){i.e$(this._dom.postBoxContent.f(".js-new-user-tag"),function(e){return e.replaceWith("{{uid:".concat(e.data("user-id"),"}}"))}),i.e$(this._dom.postBoxContent.f(".js-new-cash-tag"),function(e){return e.replaceWith("{{pid:".concat(e.data("pair-id"),"}}"))})},_attemptStop:function(){this._$currentSearchEl&&i.isSizeOne(this._$currentSearchEl.textT())&&this._stopSearchModes()},_stopSearchModes:function(e){this._$currentSearchEl&&(this._$currentSearchEl.remove(),this._$currentSearchEl=null,this._dom.searchPopupWrapper.remove(),this._dom.usersPopup.remove(),this._dom.postBoxContent.focus().off(".searchInstrument .searchUsers keydown.searchInstrumentNav"),i.pD(e))},_bindCommentInput:function(){var n=this;this._dom.postBoxContent.on("keydown",function(e){var t=s[e.key];t?n[t](e):i.isIn([27,32],e.which)?n._stopSearchModes(e):8===e.which&&n._attemptStop()}),this._dom.postBoxContent.on("input",function(){return n._dom.postButton.disable(!n._validateComment())}),this._dom.postBoxWrapper.on("click",function(e){e=e.target;r(e).isChildOf(n._dom.postBoxFooter)||document.activeElement===n._dom.postBoxContent[0]||(n._dom.postBoxContent.setCaretToEditablecontentEnd(),n._dom.postButton.disable(!n._validateComment()))})},_bindDropFilesBox:function(){var t=this._dom.attachImageWrapper.add(this._dom.attachImageErrorWrapper);i.e(["dragenter","dragover","dragleave","drop"],function(e){return t.on(e,i.pD)}),i.e(["dragenter","dragover"],function(e){return t.on(e,function(){return t.aCl("highlight")})}),i.e(["dragleave","drop"],function(e){return t.on(e,function(){return t.rCl("highlight")})}),t.mF(".js-close-attach-image-box").on("click",this._hideAttachImageBox.bind(this))},_deletePreviewChart:function(){this._dom.chartPreviewImage.rAttr("src"),this._dom.chartPreviewWrapper.hideEl()},_previewImage:function(e){var t=this,n=new FileReader;n.readAsDataURL(e),n.onloadend=function(){var e=r('<img src="'.concat(n.result,'">'));t._dom.attachImageWrapper.html(e)}},_showAttachImageBox:function(){this._dom.attachImageWrapper._show(),this._dom.attachImageErrorWrapper._hide()},_hideAttachImageBox:function(){this._dom.attachImageWrapper._hide(),this._dom.attachImageErrorWrapper._hide()},_showErrorAttachImageBox:function(){this._dom.attachImageErrorWrapper._show(),this._dom.attachImageWrapper._hide()},_validateComment:function(){var e=this._dom.postBoxContent.textT().length,t=300-e;return this._$currentSearchEl||this._dom.remainingCharacters.text(t).toggleEl(t<=100),e&&e<=300},_postCommentIfLoggedIn:function(){this.loginOrImmediate(this._postComment.bind(this))},_postComment:function(){this._replaceTags(),this.trigger("postNewCommentEv",this._dom.postBoxContent.textT(),this._dom.chartPreviewImage.attr("src")),this.clearAndFocus()},clearAndFocus:function(){this._deletePreviewChart(),this._dom.postBoxContent.text("").focus(),this._dom.postButton.disable()}})}),define("Modules/Discussion/CommentInput",["underscore","jquery","Backbone","./CommentInputView"],function(e,t,n,i){return n.EModel.extend({_bubbleEvents:{_view:["postNewCommentEv","getAvailableUserToTag","openChartPopupEv"]},initialize:function(e){return this._view=new i(e),this},render:function(){return this._view.render(),this.delegateBubbling(),this},startUserMentionMode:function(e){this._view.startUserMentionMode(e)},addNewUserTag:function(e,t){this._view.addNewUserTagInView(e,t)},addPreviewChartImage:function(e){this._view.addPreviewChartImage(e)},clearInput:function(){return this._view.clearAndFocus(),this}})}),define("Modules/Discussion/DiscussionView",["underscore","jquery","Backbone","Displayable","TemplateManager","Modules/Discussion/CommentInput","Server","Toolset"],function(f,r,e,n,s,a,t,i){var l="pressed",o=r(window);return n.extend({_commentsData:null,_$inputClone:null,_likedCommentsIds:null,_schemeFromServer:null,_activeCommentInput:null,events:{"?click .js-discussion-show-more-replies":"_showMoreReplies","?click .js-discussion-comment-reply-button":"_openReplyBox","@click .js-discussion-attach-graph":"_attachDiscussionChart"},debouncedEvents:{"?click .js-comment-like-button":["_triggerLike",512,!0]},_markupScheme:{commentsList:".js-discussion-comments-list",inputWrapper:".js-discussion-add-post-wrapper",chartPopup:".js-discussion-instrument-chart-popup",chartIframe:".js-discussion-instrument-chart-popup iframe"},initialize:function(e,t){n.prototype.initialize.call(this,e),this._likedCommentsIds=t,this._loadDatalessScheme(e)},render:function(){return n.prototype.render.call(this),this._initializeMainCommentInput(),this._initializeComments(),this.$el},renderNewComment:function(t){var n=this,e=this._buildCommentOrReplyScheme(t);s.render({body:e}).then(function(e){e=e.body,e=r(e);n._isNotRendered(t.id)&&(n._soakCommentItem(e),n._dom.commentsList.prepend(e))})},renderNewReply:function(n){var i=this,e=this._buildCommentOrReplyScheme(n,!0);s.render({body:e}).then(function(e){var e=e.body,e=r(e),t=i._commentsData[n.parent_id];t&&i._isNotRendered(n.id)&&(i._soakReplyItem(e,n.parent_id),t.$repliesList.prepend(e),t.$replyCounter.showEl().textT(+t.$replyCounter.textT()+1))})},renderCommentsBatchInView:function(e){var t=this,n=1<arguments.length&&void 0!==arguments[1]?arguments[1]:this._dom.commentsList,i=2<arguments.length?arguments[2]:void 0,o=3<arguments.length?arguments[3]:void 0,e=r(e);n[i?"prepend":"append"](e),f.e$(e,function(e){return o?t._soakReplyItem(e,o):t._soakCommentItem(e)})},toggleLikeComment:function(e,t){var e=e.status,n=this._commentsData[t],i=n.$likeButton,n=n.$likeCounter,o=this._isLiked(t);e.is("OK")&&(e=+n.textT()+(o?-1:1),n.textT(e).toggleEl(e),i.tCl(l,!o),o?delete this._likedCommentsIds[t]:this._likedCommentsIds[t]="like",this.trigger("storeLikesInStorageEv",this._likedCommentsIds))},_initializeComments:function(){var t=this;this._commentsData={},f.e$(this._dom.commentsList.f(".js-comment-item"),function(e){return t._soakCommentItem(e)}),setInterval(this._updateTimeAgo.bind(this),f.halfAMinute)},_initializeMainCommentInput:function(){var e=this._dom.inputWrapper.first();this._$inputClone=e.clone(),this._initializeCommentInput(e)},_loadDatalessScheme:function(e){var e=e.data("scheme-map"),t=e.parent,n=e.reply,e=e.viewPath;t.viewPath=e,n.viewPath=e,this._schemeFromServer={parent:t,reply:n}},_initializeCommentInput:function(e,t,n){var i=this,o=new a(e),r=t?"postNewReplyEv":"postNewCommentEv";return o.render(),o.onMultiple({postNewCommentEv:function(e,t){return i.trigger(r,e,t,n)},getAvailableUserToTag:function(){o.startUserMentionMode(f.uniq(f.filter(i._commentsData,function(e,t){return t.is(n)||e.parentId===n}),!1,function(e){return e.userId}))},openChartPopupEv:function(){f.isUn(i._dom.chartIframe.attr("src"))&&i._dom.chartIframe.attr("src",i._dom.chartIframe.data("src")),i.firePopup(i._dom.chartPopup,["modal"]),i._activeCommentInput=o}}),o},_attachDiscussionChart:function(){var t=this;o.trigger("attachSnapshotImage",function(e){return t._activeCommentInput.addPreviewChartImage(e)})},_isNotRendered:function(e){return!this._commentsData[e]},_initializeComment:function(e){var t=this._commentsData[e],n=t.$likeButton,i=t.$contentWrapper;this._updateTimeAgo(t),this._truncateIfNeeded(i),this._isLiked(e)&&n.aCl(l)},_soakCommentItem:function(e){var t=this,n=e.data("comment-id"),i=e.data("user-id"),o=e.f(".js-comment-replies-list"),r=e.mF(".js-comment-parent-wrapper"),s=r.mF(".js-comment-text"),a=r.mF(".js-comment-like-button"),l=r.mF(".js-comment-like-counter"),u=r.f(".js-comment-reply-counter"),c=r.mF(".js-comment-time"),d=r.mF(".js-comment-user-nickname").textT(),h=r.mF(".js-comment-user-full-name").textT(),r=r.mF(".js-comment-user-image").attr("src"),p=o.f(".js-discussion-add-post-wrapper");this._commentsData[n]={$wrapper:e,unixTimestamp:c.data("timestamp"),userNickname:d,userId:i,userFullName:h,userImageSrc:r,$contentWrapper:s,$likeButton:a,$likeCounter:l,$timeElem:c,$repliesList:o,$replyCounter:u},p.exists()&&(this._commentsData[n].commentInput=this._initializeCommentInput(p,!0,n)),this._initializeComment(n),f.e$(e.f(".js-reply-item"),function(e){return t._soakReplyItem(e,n)})},_soakReplyItem:function(e,t){var n=e.data("comment-id"),i=e.mF(".js-comment-like-button"),o=e.mF(".js-comment-like-counter"),r=e.mF(".js-comment-user-nickname").textT(),s=e.mF(".js-comment-user-full-name").textT(),a=e.mF(".js-comment-user-image").attr("src"),l=e.mF(".js-comment-text"),u=e.data("user-id"),c=e.mF(".js-comment-time");this._commentsData[n]={$wrapper:e,unixTimestamp:c.data("timestamp"),$contentWrapper:l,userNickname:r,userId:u,userFullName:s,userImageSrc:a,parentId:t,$likeButton:i,$likeCounter:o,$timeElem:c},this._initializeComment(n)},_buildCommentOrReplyScheme:function(e,t){return f.extend({},this._schemeFromServer[t?"reply":"parent"],{vars:e})},_openReplyBox:function(e){var t,e=e.currentTarget,e=r(e).data("comment-id"),n=this._commentsData[e].parentId||e,i=this._commentsData[n].$repliesList,e=this._commentsData[e],o=e.userNickname,e=e.userId;this._commentsData[n].commentInput||(t=this._$inputClone.clone(),i.append(t),this._commentsData[n].commentInput=this._initializeCommentInput(t,!0,n)),this._commentsData[n].commentInput.clearInput().addNewUserTag(o,e)},_triggerLike:function(e){e=e.currentTarget;this.trigger("LikeCommentEv",r(e).data("comment-id"),r(e).hCl(l))},_showMoreReplies:function(e){var t=this,e=e.currentTarget,n=r(e),i=n.data("comment-id"),o=this._commentsData[i].$repliesList;this.ask("FetchRepliesPromiseQ",i).then(function(e){e=f.map(e,function(e){return t._buildCommentOrReplyScheme(e,!0)});s.renderList(e,"repliesList").then(function(e){e=e.repliesList;return t.renderCommentsBatchInView(e,o,!0,i)}),n.remove()})},_truncateIfNeeded:function(e){var t,n=e.textT(),i=r('<button class="common-link">See More</button>');256<n.length&&(t=n.substring(0,256)+"...",i.click(function(){return e.html(n)}),e.html(t).append(i))},_updateTimeAgo:function(e){f.e(e?{cachedComment:e}:this._commentsData,function(e){return e.$timeElem.text(i.Dates.getTimeElapsed(e.unixTimestamp))})},_isLiked:function(e){return!!this._likedCommentsIds[e]}})}),define("Modules/Discussion/Discussion",["underscore","jquery","Backbone","Socket","Server","Toolset","DataChest","./DiscussionView"],function(t,e,n,o,s,i,r,a){var l="UserReactions";return n.EModel.extend({_typeId:null,_pairId:null,_triggerSource:null,_likedCommentsIds:null,initialize:function(e){this._triggerSource=e,this._getLikesAndStore()},render:function(e){var n,i=this,t=r.get("domainId");this._typeId=e.data("type-id"),this._pairId=e.data("target-id"),this._initView(e),t?(n="".concat(t,"-").concat(this._typeId,"-").concat(this._pairId),this.config.isProduction||(n="".concat(t,"-").concat(this._typeId,"-").concat(this._pairId+Math.pow(10,7))),o.subscribe("cmt",n,function(e,t){t===n&&(e.parent_id?i._view.renderNewReply(e):i._view.renderNewComment(e))})):throwError("Domain Id is not defined")},renderCommentsBatch:function(){var e;(e=this._view).renderCommentsBatchInView.apply(e,arguments)},getTypeId:function(){return this._typeId},getPairId:function(){return this._pairId},_getInstrumentData:function(){var e=r.getInstrumentData(this._pairId);return{instrumentName:e.name,instrumentType:e.type}},_initView:function(e){var r=this;this._view=new a(e,this._likedCommentsIds),this._view.render(),this._view.onMultiple({postNewCommentEv:function(e,t){var n=r._getInstrumentData(),i=n.instrumentName,n=n.instrumentType;s.Discussion.Add(e,r._typeId,r._pairId,t,null,{triggerSource:r._triggerSource,eventAction:"Left Panel"===r._triggerSource?"Social Panel":"Discussion page",instrumentName:i,instrumentType:n}).then(function(e){return r._view.renderNewComment(e)})},postNewReplyEv:function(e,t,n){var i=r._getInstrumentData(),o=i.instrumentName,i=i.instrumentType;s.Discussion.Add(e,r._typeId,r._pairId,t,n,{triggerSource:r._triggerSource,eventAction:"Left Panel"===r._triggerSource?"Social Panel":"Discussion page",instrumentName:o,instrumentType:i}).then(function(e){e.parent_id=n,r._view.renderNewReply(e)})},storeLikesInStorageEv:this._storeLikesInStorage.bind(this),LikeCommentEv:function(t,e){var n=r._getInstrumentData(),i=n.instrumentName,n=n.instrumentType;s.Discussion.Like(t,"comment","like",+e,{triggerSource:r._triggerSource,eventAction:"Left Panel"===r._triggerSource?"Social Panel":"Discussion page",instrumentName:i,instrumentType:n}).then(function(e){return r._view.toggleLikeComment(e,t)})}}),this._view.answerMultiple({FetchRepliesPromiseQ:function(e){return s.Discussion.FetchReplies(r._typeId,r._pairId,e)},AddReplyQ:function(e,t){var n=r._getInstrumentData(),i=n.instrumentName,n=n.instrumentType;s.Discussion.Add(e,r._typeId,r._pairId,t,{triggerSource:r._triggerSource,eventAction:"Left Panel"===r._triggerSource?"Social Panel":"Discussion page",instrumentName:i,instrumentType:n})}})},_getLikesAndStore:function(){var t=this,e=i.ClientStorage.getObj(l,!0);this._likedCommentsIds={},e?this._likedCommentsIds=e:s.Discussion.GetReactions().then(function(e){e=e.comment,e=void 0===e?{}:e;t._storeLikesInStorage(e),t._likedCommentsIds=e})},_storeLikesInStorage:function(e){i.ClientStorage.setObj(l,e,!0,t.halfAnHour)}})}),define("Modules/Sentiments/SentimentsView",["underscore","jquery","Backbone","TemplateManager","Displayable"],function(e,n,t,i,o){return o.extend({_markupScheme:{"?bull":".js-sentiments-bull","?bear":".js-sentiments-bear"},events:{"?click .js-sentiments-bull":"_voteBullish","?click .js-sentiments-bear":"_voteBearish","?click .js-sentiments-close":"#closeSentimentEv"},initialize:function(e){o.prototype.initialize.call(this,e)},render:function(){o.prototype.render.call(this)},rerender:function(e){var t=this;i.render({newSentimentsView:e}).then(function(e){e=e.newSentimentsView,e=n(e);t.$el.empty(),t.$el.html(e),t.render()})},_voteBullish:function(){var e=this;this.loginOrImmediate(function(){return e.trigger("voteSentimentEv","Bullish")})},_voteBearish:function(){var e=this;this.loginOrImmediate(function(){return e.trigger("voteSentimentEv","Bearish")})}})}),define("Modules/Sentiments/Sentiments",["underscore","jquery","Backbone","Server","./SentimentsView"],function(e,t,n,i,o){return n.EModel.extend({_pairId:null,_isSentimentPage:null,_triggerSource:null,initialize:function(e,t){this._triggerSource=t,this._pairId=e.data("pair-id"),this._isSentimentPage=e.data("is-sentimnet-page")},render:function(e){this._view=new o(e),this._view.onMultiple({voteSentimentEv:this._voteSentiment.bind(this),closeSentimentEv:this._closeSentiment.bind(this)}),this._view.render()},_voteSentiment:function(e){var t=this;i.Sentiments.Vote(this._pairId,e,this._isSentimentPage,{triggerSource:this._triggerSource,eventLabel:"Vote",eventValue:e}).then(function(e){return t._view.rerender(e)})},_closeSentiment:function(){var t=this;i.Sentiments.Delete(this._pairId,this._isSentimentPage,{triggerSource:this._triggerSource,eventLabel:"Vote",eventValue:"Close"}).then(function(e){return t._view.rerender(e)})}})}),define("Modules/InvMoney/CarouselView",["underscore","jquery","Backbone","Displayable"],function(e,u,t,n){return n.extend({_markupScheme:{},initialize:function(e){n.prototype.initialize.call(this,e)},render:function(){return n.prototype.render.call(this),lcl("Initialized"),this._init_carousel(),this.$el},_slide:function(e,t,n,i){this._slideIndex=t?e%this._slideCount:(this._slideIndex+e)%this._slideCount,this._slideIndex<0&&(this._slideIndex=(slideCount+index)%this._slideCount),n.removeClass("mn-is-active"),u(n[this._slideIndex]).addClass("mn-is-active");t=100*this._slideIndex*-1;i.animate({"margin-left":t+"%"},500)},_slideCount:0,_slideIndex:0,_interval:!1,_startSlider:function(){0!=this._interval&&clearInterval(this._interval),this._interval=setInterval(function(){},5e3)},_init_carousel:function(){var l=this;e.e$(this.$el,function(e){for(var n=u(".mn-js-carousel-items",e),t=u(".mn-js-carousel-slide",e),i=(u(t[0]),u(".mn-js-carousel-indicators",e)),o=u(".mn-js-carousel-indicator",i),r=u(".mn-js-carousel-prev",e),e=u(".mn-js-carousel-next",e),s=[],t=(l._slideIndex=0,l._slideCount=t.length,100*l._slideCount),a=(n.width(t+"%"),$cleanIndicator=o.clone(),o.remove(),0);a<l._slideCount;a++)!function(e){var t=$cleanIndicator.clone();t.click(function(){l._slide(e,!0,o,n)}),0==e&&t.addClass("mn-is-active"),s.push(t),i.append(t)}(a);o=u(".mn-js-carousel-indicator",i),e.click(function(){l._slide(1,!1,o,n),l._startSlider()}),r.click(function(){l._slide(-1,!1,o,n),l._startSlider()}),l._startSlider()})}})}),define("Modules/InvMoney/DetailsView",["underscore","jquery","Backbone","Displayable"],function(e,o,t,n){return n.extend({_markupScheme:{},initialize:function(e){n.prototype.initialize.call(this,e)},render:function(){return n.prototype.render.call(this),lcl("Initialized"),this._init_details(),this.$el},_init_details:function(){e.e$(this.$el,function(e){var t=o(".mn-js-details-open",e),n=o(".mn-js-details-close",e),i=o(".mn-js-details-content-container",e);o(".mn-js-details-content",e).click(function(e){e.stopPropagation()}),t.click(function(){i.removeClass("mn-no-mobile"),setTimeout(function(){i._show()},0)}),o(document.body).click(function(e){i._hide()}),n.click(function(){i._hide()})})}})}),define("Modules/InvMoney/InvMoneyView",["underscore","jquery","Backbone","Displayable","./CarouselView","./DetailsView"],function(e,t,n,i,o,r){return i.extend({_markupScheme:{"?carousel":".mn-js-carousel","?details":".mn-js-details","?redirect":".mn-js-redirect"},initialize:function(e){i.prototype.initialize.call(this,e)},render:function(){return i.prototype.render.call(this),lcl("Initialized"),this._init_carousel(),this._init_details(),this._init_redirect(),this.$el},_init_carousel:function(){this._dom.carousel.exists()&&new o(this._dom.carousel).render()},_init_details:function(){this._dom.details.exists()&&new r(this._dom.details).render()},_init_redirect:function(){var e;this._dom.redirect.exists()&&(e=this._dom.redirect.data("url"),setTimeout(function(){this.outerNavigate(e)},6e3))}})}),define("Modules/SearchableList/SearchableListView",["underscore","jquery","Backbone","Displayable"],function(l,e,t,n){return n.extend({_items:null,_itemChunks:null,_categoriesMode:null,_markupScheme:{"?filterWrappers":".js-filter-wrapper","?noResult":".js-simple-country-selection-no-res",input:'input[type="search"]'},events:{'keyup input[type="search"]':"_applySearch"},initialize:function(e){n.prototype.initialize.call(this,e)},render:function(){var e=this;return n.prototype.render.call(this),this._dom.input.on("search",function(){return e._applySearch()}),this.$el},destroy:function(){this.unbindDOMEvents()},loadListFromDOM:function(e){var t=this,n=e?".js-searchable-item":"li";this._dom.filterWrappers.exists()?(this._itemChunks=[],this._categoriesMode=!0,l.e$(this._dom.filterWrappers,function(e){t._itemChunks.push(l.map$(e.f(n),function(e){return{$li:e,textValue:e.textT().toLowerCase()}}))})):(this._items=[],l.e$(this.$el.f(n),function(e){t._items.push({textValue:e.textT().toLowerCase(),$el:e})}))},reset:function(){this._dom.input.val(""),l.e(this._itemChunks,function(e){return e.$li.showEl()})},_applySearch:function(){var o,r,s=this,a=this._dom.input.val().toLowerCase();this._categoriesMode?(r=0,l.e(this._itemChunks,function(e,t){var n,i=0;l.e(e,function(e){var t;(n=e.$li.mF(".js-dropdown-option-m").isValue("all"))?o=e.$li:(t=~e.textValue.indexOf(a),e.$li.toggleEl((t||!a)&&++i))}),r+=i,n||s._dom.filterWrappers.eq(t).toggleEl(i)}),this._dom.noResult.toggleEl(!r),o&&o.toggleEl(l.positiveNonZero(r))):l.e(this._items,function(e){var t=~e.textValue.indexOf(a);e.$el._toggleShow(t||!a)})}})}),define("Modules/Dropdown/DropdownView",["underscore","jquery","Backbone","Displayable","DataChest","Modules/SearchableList/SearchableListView"],function(o,i,e,n,r,t){var a=".js-dropdown-option-s",s=".js-dropdown-option-m";return n.extend({_sList:null,_settings:null,_selectedValue:null,_allOptionsLength:null,_valueToSingleOption:null,_groupValueToSingleOption:null,_$itemClone:null,_default$Option:null,_$allOption:null,_$regularOptions:null,_markupScheme:{popup:".js-dropdown-popup",listOptions:".js-dropdown-popup li",display:".js-dropdown-display"},initialize:function(e){var t=1<arguments.length&&void 0!==arguments[1]?arguments[1]:{};n.prototype.initialize.call(this,e),this._settings=t,e.hasData("max")&&(this._settings.max=e.data("max"))},render:function(){return n.prototype.render.call(this),o.isIn(this._settings.features,"MultiSelect")?this._initMulti():this._initSingle(),o.isIn(this._settings,"selectedOption")&&this.setValue(this._settings.selectedOption,!0),(o.isIn(this._settings.features,"Searchable")||this.$el.f(".js-searchable").exists())&&this._initSearchableList(),this.$el},rerender:function(){o.isIn(this._settings.features,"MultiSelect")?this._initMulti(!0):this._initSingle(!0)},getValue:function(){return this._selectedValue},setValue:function(e,t,n){var i=(n?this._groupValueToSingleOption:this._valueToSingleOption)[e];this._selectSingleOption(i.textT(),e,i.data(),t,n)},setValues:function(t){o.e(this._dom.multiCheckboxes,function(e){return i(e).toggleCheck(o.isIn(t,i(e).val()))})},toggleOptions:function(n){o.e(this._dom.listOptions,function(e,t){return i(e)._toggleShow(!o.isIn(n,t))})},toggleOptionsByPredicate:function(t){o.e$(this._dom.listOptions,function(e){return e._toggleShow(t(e))})},toggleListByPredicate:function(e,t){o.e$(e,function(e){return e._toggleShow(t(e))})},getAllValues:function(){return this._dom.multiCheckboxes.collectValues()},getMultipleSelectionText:function(){return r.getTranslation("FILTER_MULTI_SELECTED")},isAllChecked:function(){return this._allOptionsLength===o.size(this._selectedValue)},isAllUnchecked:function(){return o.isEmpty(this._selectedValue)},clearDropdown:function(){o.isIn(this._settings.features,"MultiSelect")?this._dom.multiCheckboxes.uncheck():this.setValue(this._default$Option.data("value"),!0,this._default$Option.is("[data-group]"))},checkAllMultiDropdown:function(){this._dom.multiCheckboxes.check()},setMultiDisplayText:function(){var e,t,n=this._dom.multiCheckboxes.getChecked(),i=o.size(this._selectedValue);i===this._allOptionsLength?e=r.getTranslation("FILTER_ALL_SELECTED"):1===i?(e=n.data("text"))||(t=n.next(".".concat(n.data("text-class"))).clone()):e=this.getMultipleSelectionText(),this._dom.display.textT(e),t&&this._dom.display.html(t)},closeDropdownPopup:function(){this._dom.popup.isVisible()&&this.closePopupFromElement(this._dom.popup)},resetDefault:function(){this._settings.defaultSelection&&(this.setValues(this._settings.defaultSelection),this._dom.multiCheckboxes.toggleCheck(this._$allOption.isChecked()),this._$allOption.toggleCheck(this._$regularOptions.areChecked()),this._selectedValue=this._getSelectedValues())},_initMulti:function(e){this._buildItems(!0),this.addToDOM("multiCheckboxes",this.$el.mF(s)),this._selectedValue=this._getSelectedValues(),this._allOptionsLength=o.size(this.getAllValues()),this.$el.f(".js-clear-button").on("click",this.clearDropdown.bind(this)),this.$el.f(".js-apply-button").on("click",this._applyMultipleOptions.bind(this)),e||this.setupPopup(this._dom.display,this._dom.popup,{onClose:(o.isIn(this._settings.features,"Group")?this._applyMultipleOptions:this._resetOptions).bind(this)}),this._setupAllOptionIfExists(),this._setupSelectionsLimits()},_setupAllOptionIfExists:function(){var e=this;this._$allOption=this._dom.multiCheckboxes.filter('[value="all"]'),this._$regularOptions=this._dom.multiCheckboxes.filter('[value!="all"]'),this._$allOption.exists()&&(this._$allOption.on("input",function(){return e._dom.multiCheckboxes.toggleCheck(e._$allOption.isChecked())}),this._$regularOptions.on("input",function(){return e._$allOption.toggleCheck(e._$regularOptions.areChecked())}))},_setupSelectionsLimits:function(){var i=this;this._settings.max&&o.e$(this._dom.multiCheckboxes,function(e){e.on("input",function(){var e=i._dom.multiCheckboxes.getUnchecked(),t=o.size(i._dom.multiCheckboxes.getChecked())>=i._settings.max,n=i._getUncheckedOptions();e.disable(t),n.tCl("is-disabled",t)})})},_getUncheckedOptions:function(){return this._dom.listOptions.filter(function(e,t){return!i(t).getInput().isChecked()})},_initSingle:function(e){var r=this,s=this._dom.display.textT();this._valueToSingleOption={},this._groupValueToSingleOption={},this.addToDOM("singleOptions",this.$el.mF(a)),this._buildItems(),o.e$(this._dom.singleOptions,function(e){var t=e.data("value"),n=e.textT(),i=e.data(),o=e.is("[data-group]");o?r._groupValueToSingleOption[t]=e:r._valueToSingleOption[t]=e,e.on("click",function(){return r.getValue()===t?r.closeDropdownPopup():r._selectSingleOption(n,t,i,null,o)}),n.is(s)&&(r.setValue(t,!0,o),r._default$Option=e)}),e||this.setupPopup(this._dom.display,this._dom.popup),e&&this._resetSingle()},_buildItems:function(e){var t;this._settings.itemsList&&(t=e?this._dom.multiCheckboxes:this._dom.singleOptions,this.toggleListByPredicate(t,function(e){return"all"===e.data("value")}),this._$itemClone=this.$el.mF(e?".js-dropdown-option-m-li":a).first().clone().unselect(),this.$el.mF("ul.common-list").buildAndPopulate(this._settings.itemsList,this._buildListItem.bind(this),!0),e||this.addToDOM("singleOptions",this.$el.mF(a)))},_buildListItem:function(e){var t=e.id,e=e.name,n=this._$itemClone.clone(),i=n.f(s);return n.data("value")?n.data("value",t):i.attr("value",t),i.data("text")&&i.data("text",e),n.mF(".js-dropdown-item-text").textT(e),n},_resetOptions:function(){this.setValues(this._selectedValue)},_resetSingle:function(){var e=this._dom.singleOptions.first();this._selectSingleOption(e.textT(),e.data("value"),e.data())},_initSearchableList:function(){this._sList=new t(this.$el),this._sList.render(),this._sList.loadListFromDOM()},_dispatchChangeEvent:function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];o.tryRun.apply(o,[this._settings.onChange].concat(t)),this.trigger.apply(this,["dropdownChangeEv"].concat(t))},_selectSingleOption:function(e,t,n,i,o){this._selectedValue=t,this._dom.display.text(e),this._dom.singleOptions.unselect(),(o?this._groupValueToSingleOption:this._valueToSingleOption)[t].setSelected(),i||(this.closeDropdownPopup(),this._dispatchChangeEvent(t,e,n))},_getSelectedValues:function(){return this._dom.multiCheckboxes.getChecked().collectValues()},_applyMultipleOptions:function(){var e=o.isntEqual(this._selectedValue,this._getSelectedValues());this._selectedValue=this._getSelectedValues(),this.setMultiDisplayText(),this.closeDropdownPopup(),this._dispatchChangeEvent(this._selectedValue,e)}})}),define("Modules/Dropdown/CountryDropdownView",["underscore","jquery","Backbone","./DropdownView"],function(s,r,e,a){return a.extend({_$worldwide:null,_regionsToCountriesMap:null,_isMultiSelected:!1,initialize:function(e){var t=1<arguments.length&&void 0!==arguments[1]?arguments[1]:{};t.features=["Searchable"],this._isMultiSelected=e.contains(".js-dropdown-option-m"),this._isMultiSelected&&t.features.push("MultiSelect"),t.isFiltersGroup&&t.features.push("Group"),a.prototype.initialize.call(this,e,t),this._regionsToCountriesMap={}},render:function(){var n=this;a.prototype.render.call(this,{},this._markupScheme),s.e$(this._dom.multiCheckboxes,function(e){e.on("click",function(e){var e=r(e.target),t=e.isChecked()?"select":"unselect";n.GTM("CountryDropdownCheckboxSelected",t,e.data("text"))})});var t,e=_slicedToArray(s.split$(this._isMultiSelected?this._dom.multiCheckboxes:this._dom.singleOptions,function(e){return e.is("[data-group], [value=all]")}),2),i=e[0],o=e[1];return s.e$(o,function(e){var t=n._isMultiSelected?e.val():e.data("value"),e=e.data("parent-group");n._regionsToCountriesMap[e]||(n._regionsToCountriesMap[e]=[]),n._regionsToCountriesMap[e].push(t)}),this._isMultiSelected&&(t=function(e){var t=o.filter('[data-parent-group="'.concat(e.data("parent-group"),'"]'));i.filter('[data-group][value="'.concat(e.data("parent-group"),'"]')).toggleCheck(t.areChecked()),n._$worldwide.toggleCheck(i.areChecked())},this._$worldwide=i.removeFromThis(i.filter("[value=all]")),this._$worldwide.on("input",function(e){e=e.currentTarget,e=r(e).isChecked();i.add(o).toggleCheck(e)}),s.map$(i,function(e){var t=o.filter('[data-parent-group="'.concat(e.val(),'"]'));e.isChecked()&&t.check()}),s.map$(o,t),i.on("input",function(e){var e=e.currentTarget;return e=r(e),o.filter('[data-parent-group="'.concat(e.val(),'"]')).toggleCheck(e.isChecked()),void n._$worldwide.toggleCheck(i.areChecked())}),o.on("input",function(e){e=e.currentTarget;return t(r(e))}),this._$worldwide.toggleCheck(i.areChecked())),this.$el},setValues:function(e){var e=_slicedToArray(e,2),i=e[0],o=e[1],r=s.isIn(i,"all");s.e$(this._dom.multiCheckboxes,function(e){var t=e.attr("data-parent-group"),n=e.val();e.toggleCheck(r||!t&&s.isIn(i,n)||s.isIn(i,t)||!!t&&s.isIn(o,n))}),this._$worldwide.toggleCheck(r)},getCountriesByRegion:function(e){return this._regionsToCountriesMap[e]},getSingleValue:function(){var e=this._dom.singleOptions.getSelected();return{id:e.data("value"),name:e.textT(),isGroup:e.is("[data-group]"),isAll:e.is("[data-value=all]")}},isMultiSelected:function(){return this._isMultiSelected},getRegions:function(){return s.keys(this._regionsToCountriesMap)},setMultiDisplayText:function(){var e=_slicedToArray(this._selectedValue,2),t=e[0],e=e[1],t=s.isIn(e,"all")?this._$worldwide.data("text"):s.size(t)+s.size(e)===1?this._dom.multiCheckboxes.getChecked().data("text"):this.getMultipleSelectionText();this._dom.display.textT(t)},isAllUnchecked:function(){var e=_slicedToArray(this._getSelectedValues(),2),t=e[0],e=e[1];return s.isEmpty(t)&&s.isEmpty(e)},resetDefault:function(){this._settings.defaultSelection&&(this.setValues(this._settings.defaultSelection),this._selectedValue=this._getSelectedValues(),this.setMultiDisplayText())},_getSelectedValues:function(){var n=[],i=[];return s.e$(this._dom.multiCheckboxes.getChecked(),function(e){var t=e.val();e.is("[data-group]")?n.push(t):s.isIn(n,e.attr("data-parent-group"))||i.push(t)}),[n,i]}})}),define("Modules/Dropdown/CategoryDropdownView",["underscore","jquery","Backbone","Toolset","DataChest","./DropdownView"],function(o,r,e,t,n,i){return i.extend({_singleToGroupMap:null,initialize:function(e){i.prototype.initialize.call(this,e,{features:["MultiSelect"]}),this._singleToGroupMap={}},render:function(){return i.prototype.render.call(this),this.addToDOM("categories",this.$el.mF(".js-dropdown-category-wrapper")),this._initOptions(),this._initSingleToGroupMap(),this._selectedValue=this._getSelectedValues(),this.$el},setValues:function(n){o.e$(this._singleToGroupMap,function(e,t){o.isIn(n.group,t)?e.toggleCheck(!0):o.e$(e,function(e){return e.toggleCheck(o.isIn(n[t],e.val()))})})},_initSingleToGroupMap:function(){var t=this;o.e$(this._dom.categories,function(e){return t._singleToGroupMap[e.data("group-key")]=e.f(".js-dropdown-option-m")})},_initOptions:function(){var e=_slicedToArray(o.split$(this._dom.multiCheckboxes,function(e){return e.is("[data-group]")}),2),n=e[0],i=e[1];n.on("input",function(e){var e=e.currentTarget;e=r(e),i.filter('[data-parent-group="'.concat(e.val(),'"]')).toggleCheck(e.isChecked())}),i.on("input",function(e){var t,e=e.currentTarget;e=r(e),t=i.filter('[data-parent-group="'.concat(e.data("parent-group"),'"]')),n.filter('[data-group][value="'.concat(e.data("parent-group"),'"]')).toggleCheck(t.areChecked())})},_getSelectedValues:function(){var n={group:[]};return o.e(this._singleToGroupMap,function(e,t){e.areChecked()?o.isIn(n.group,t)||n.group.push(t):(e=e.getChecked().collectValues(),o.isntE(e)&&(n[t]=e),o.isIn(n.group,t)&&n.group.splice(n.group.indexOf(t),1))}),o.isE(n.group)&&delete n.group,n}})}),define("Modules/MajorFilters/MajorFiltersView",["underscore","jquery","Backbone","Displayable","EventBus","Modules/Dropdown/CountryDropdownView","Modules/Dropdown/CategoryDropdownView"],function(s,e,t,n,i,a,l){return n.extend({_onFilters:null,_geoFilters:null,_parentLink:null,_dateFilters:null,_multiselectFilters:null,_markupScheme:{filterWrappers:".js-major-filter"},events:{"?click .js-major-filters-mobile-back":"_closeMobilePopup"},initialize:function(e){var t=1<arguments.length&&void 0!==arguments[1]?arguments[1]:{};n.prototype.initialize.call(this,e),this.loadSettings(t)},render:function(){var r=this;return n.prototype.render.call(this),i.on("openMobileMajorFiltersEv",function(){return r.$el.showElMobile()}),this._onFilters=[],this._geoFilters={},this._dateFilters={},this._multiselectFilters={},this._singleselectFilters={},this._categoryselectFilters={},s.e$(this._dom.filterWrappers,function(e){var t=e.data(),n=t.param,i=t.filterType,o=t.renderer,t=t.useEditionOffset,o=("client"===o?r._applyClientMajorFilters:r._applyServerMajorFilters).bind(r);i.is("singleSelect")?r._singleselectFilters[n]=r.setupDropdown(e.mF(".js-dropdown-container")).on("dropdownChangeEv",o):i.is("category")?(r._categoryselectFilters.category=new l(e.mF(".js-dropdown-container")),r._categoryselectFilters.category.render(),r._categoryselectFilters.category.on("dropdownChangeEv",o)):i.is("")||i.is("on")?(r._multiselectFilters[n]=r.setupDropdown(e.mF(".js-dropdown-container"),{features:["MultiSelect"]}).on("dropdownChangeEv",o),i.is("on")&&r._onFilters.push(n)):i.is("date")?r._dateFilters[n]=r.setupDateInput(e.mF(".js-dropdown-container"),{Range:!0,skipOffset:!t,displayDateOnButton:!0}).on("dateChangeEv",o):i.is("geo")&&(r._geoFilters[n]=new a(e.mF(".js-dropdown-container")),r._geoFilters[n].render(),r._geoFilters[n].on("dropdownChangeEv",o),e.hasData("parent-link")&&(r._parentLink=e.data("parent-link")))}),this._bindExchangeBehavior(),this.$el},_updateExchange:function(){var t=this,e=_slicedToArray(this._geoFilters.country.getValue(),2),n=e[0],i=e[1],o=s.isIn(this._multiselectFilters.pair_type.getValue(),"crypto");i.push.apply(i,_toConsumableArray(s.flatten(s.map(n,function(e){return t._geoFilters.country.getCountriesByRegion(e)})))),this._multiselectFilters.exchangeID.toggleOptionsByPredicate(function(e){return"Yes"===e.data("iscrypto")&&o||s.isIn(i,e.attr("data-countryid"))})},_bindExchangeBehavior:function(){var e=this;this._multiselectFilters.exchangeID&&(this._geoFilters.country.on("dropdownChangeEv",function(){e._updateExchange()}),this._multiselectFilters.pair_type.on("dropdownChangeEv",function(){e._updateExchange()}))},_closeMobilePopup:function(){this.$el.hideElMobile()},_applyServerMajorFilters:function(){var e,n=this,i=[];s.e(this._geoFilters,function(e){var e=_slicedToArray(e.getValue(),2),t=e[0],e=e[1];i.push.apply(i,_toConsumableArray(e.map(function(e){return["c_id[]",e]}).concat(s.without(t,"all").map(function(e){return["r_id[]",e]}))))}),s.e(this._dateFilters,function(e){var e=e.getValues(),t=e.from,e=e.to;t&&e&&i.push(["st_date",t],["end_date",e])}),s.e(this._categoryselectFilters,function(e){var e=e.getValue(),n=[];s.e(e,function(e,t){s.e(e,function(e){n.push([t+"[]",e])})}),i.push.apply(i,n)}),s.e(this._multiselectFilters,function(e,t){e=e.getValue().map(function(e){return s.isIn(n._onFilters,t)?[e,"on"]:[t+"[]",e]});i.push.apply(i,_toConsumableArray(e))}),s.e(this._singleselectFilters,function(e,t){i.push([t,e.getValue()])}),s.isFu(this._settings.applyFunction)?this._settings.applyFunction(i):(s.e((e=window.location.search.substr(1))?e.split("&").map(function(e){return e.split("=")}):[],function(e){var e=_slicedToArray(e,2),t=e[0],e=e[1];s.isE(s.filter(i,function(e){return e[0]===t}))&&i.push([t,e])}),this.navigate("".concat(this._parentLink||location.pathname).concat(s.size(i)?"?".concat(i.map(function(e){return e.join("=")}).sort().join("&")):"")))},_applyClientMajorFilters:function(){var o={};s.e(this._geoFilters,function(e){var e=_slicedToArray(e.getValue(),2),n=e[0],i=e[1];o.country=function(e,t){return s.isIn(n,"all")||s.isIn(i,""+t.countryID)||s.isIn(n,""+t.region)}}),s.e(this._dateFilters,function(e,t){var e=e.getValues(),n=e.from,i=e.to;o[t]=function(e){return(!n||n<+e)&&(!i||+e<i)}}),s.e(this._multiselectFilters,function(e,t){var n,e=e.getValue();o[t]=(n=e,function(e){return s.isE(n)||s.isIn(n,"all")||s.isIn(n,""+e)})}),i.trigger("applyMajorFiltersEv",o)}})}),define("Modules/FiltersGroup/FiltersGroupView",["underscore","jquery","Backbone","Displayable","EventBus","DataChest","Modules/Dropdown/CountryDropdownView"],function(r,e,t,n,i,a,l){return n.extend({_issuers:null,_categories:null,isApplyEnabled:null,_markupScheme:{filterWrappers:".js-major-filter",applyButton:".js-apply-button"},events:{"click .js-major-filters-mobile-back":"_closeMobilePopup","click .js-apply-button":"_applyServerGroupFilters","?click .js-clear-button":"_clearAllFilters","?click .js-restore-button":"_restoreAllFilters"},initialize:function(e){var t=1<arguments.length&&void 0!==arguments[1]?arguments[1]:{};n.prototype.initialize.call(this,e),this.loadSettings(t),this._isApplyEnabled=!1},render:function(){var s=this;n.prototype.render.call(this),i.on("openMobileMajorFiltersEv",function(){return s.$el.showElMobile()}),this._geoFilters={},this._singleselectFilters={},this._multiselectFilters={},r.e$(this._dom.filterWrappers,function(e){var t,n=e.data(),i=n.param,n=n.filterType,o=e.data().filterDataKey?a.get(e.data().filterDataKey):void 0,r=(a.get("filtersDefault")||{})[i];n.is("geo")?(s[t="_geoFilters"][i]=new l(e.mF(".js-dropdown-container"),{defaultSelection:r,isFiltersGroup:!0}),s[t][i].render(),e.hasData("parent-link")&&(s._parentLink=e.data("parent-link"))):n.is("singleSelect")?("issuer"===i&&(o=s._filterIssuersByCountry(o)),s[t="_singleselectFilters"][i]=s.setupDropdown(e.mF(".js-dropdown-container"),{itemsList:o})):n.is("")&&(s[t="_multiselectFilters"][i]=s.setupDropdown(e.mF(".js-dropdown-container"),{itemsList:o,defaultSelection:r,features:["MultiSelect","Group"]})),s[t][i].on("dropdownChangeEv",s._onFilterChange.bind(s))}),this._bindIssuerBehavior()},_filterIssuersByCountry:function(e){var t,n=this._geoFilters.country.getSingleValue();return e=n.isAll?e:n.isGroup?(t=this._geoFilters.country.getCountriesByRegion(n.id),r.filter(e,function(e){return e.countries.some(function(e){return t.includes(e)})})):r.filter(e,function(e){return r.isIn(e.countries,n.id)})},_updateIssuer:function(){var e;this._singleselectFilters.issuer&&(e=a.get("issuerFilterData"),e=this._filterIssuersByCountry(e),this._singleselectFilters.issuer._settings.itemsList=e,this._singleselectFilters.issuer.rerender())},_bindIssuerBehavior:function(){var e=this;this._singleselectFilters.issuer&&this._geoFilters.country.on("dropdownChangeEv",function(){e._updateIssuer()})},_onFilterChange:function(e,t){t&&this._enableApplyButton()},_enableApplyButton:function(){this._isApplyEnabled=this._dom.applyButton.enable()},_disableApplyButton:function(){this._dom.applyButton.disable(),this._isApplyEnabled=!1},_closeMobilePopup:function(){this.$el.hideElMobile()},_applyServerGroupFilters:function(){var o=[];r.e(this._geoFilters,function(e){var t,n,i;e.closeDropdownPopup(),e.isMultiSelected()?(e.isAllUnchecked()&&e.checkAllMultiDropdown(),n=(t=_slicedToArray(e.getValue(),2))[0],t=t[1],o.push.apply(o,_toConsumableArray(t.map(function(e){return["c_id[]",e]}).concat(r.without(n,"all").map(function(e){return["r_id[]",e]}))))):(n=(t=e.getSingleValue()).id,i=t.isGroup,t.isAll?(o.push(["c_id[]",n]),r.e(e.getRegions(),function(e){return o.push(["r_id[]",e])})):o.push([i?"r_id[]":"c_id[]",n]))}),r.e(this._singleselectFilters,function(e,t){e.closeDropdownPopup(),"all"!==e.getValue()&&o.push([t,e.getValue()])}),r.e(this._multiselectFilters,function(e,t){e.closeDropdownPopup(),e.isAllUnchecked()&&e.checkAllMultiDropdown(),e.isAllChecked()||o.push.apply(o,_toConsumableArray(e.getValue().map(function(e){return["".concat(t,"[]"),e]})))}),r.isFu(this._settings.applyFunction)?(this._settings.applyFunction(o),this._disableApplyButton()):this.navigate("".concat(this._parentLink||location.pathname,"?").concat(o.map(function(e){return e.join("=")}).sort().join("&"))),this._closeMobilePopup()},_clearAllFilters:function(){r.e(this._multiselectFilters,function(e){e.clearDropdown(),e.setMultiDisplayText()}),r.e(this._singleselectFilters,function(e){e.clearDropdown()}),r.e(this._geoFilters,function(e){e.clearDropdown()}),this._enableApplyButton()},_restoreAllFilters:function(){r.e(this._multiselectFilters,function(e){e.resetDefault(),e.setMultiDisplayText()}),r.e(this._singleselectFilters,function(e){e.clearDropdown()}),r.e(this._geoFilters,function(e){e.resetDefault()}),this._enableApplyButton()}})}),define("Modules/DynamicTabs/DynamicTabsView",["underscore","jquery","Backbone","Displayable","EventBus"],function(n,e,t,i,o){return i.extend({_customOnChange:null,_markupScheme:{"?buttons":".js-dynamic-tab-button",tabsContainers:".js-dynamic-tab-content"},initialize:function(e){i.prototype.initialize.call(this,e),this._customOnChange=e.data("on-change")},render:function(){var e,t=this;return i.prototype.render.call(this),this._dom.buttons.exists()&&(e={forceHideShow:!0},"redrawCharts"===this._customOnChange&&(e.customHandler=function(e){e=t._dom.tabsContainers.eq(e).f(".js-standalone-chart");n.e$(e,function(e){return o.trigger("redrawChartEv",e.data("chart-key"))})}),this.setupTabs(this._dom.buttons,this._dom.tabsContainers,e)),this.$el}})}),define("Modules/LazyLoadPagination/LazyLoadPaginationView",["underscore","jquery","Backbone","Displayable","TemplateManager","Router","Http","EventBus"],function(n,i,e,o,r,t,s,a){var l={debounceMS:16,getDataOffset:1500,appendOffset:1250},u=i(window),c=i(document.head);return o.extend({_settings:null,_requestURL:null,_page:null,_requestedPages:null,_cachedData:null,_nextDataFetchingPoint:null,_containerTotalHeight:null,_retryIfNeeded:null,_initialPage:null,_disableAddingPages:null,_lastPage:null,_viewedPage:null,_$next:null,_$prev:null,_markupScheme:{pages:".js-lazy-load-page",showMore:".js-show-more-button",showMoreWrapper:".js-show-more-button-wrapper"},events:{"click .js-show-more-button":"_addPage"},initialize:function(e,t){o.prototype.initialize.call(this,e),this._settings=n.extend({},l,t),this._requestURL=e.data("req-url"),this._lastPage=e.data("max-page"),this._requestedPages=[],this._cachedData={}},render:function(){return o.prototype.render.call(this),this._page=this._dom.pages.last().data("page"),this._initialPage=this._page,this._viewedPage=this._page,this._page++,this._nextDataFetchingPoint=this._dom.pages.last().offset().top+this._settings.getDataOffset,this._initialPage<this._lastPage&&this._bindScrollBehaviour(),this._createPrevNextTags(),this._updatePrevNextTags(),this.$el},destroy:function(){u.off("scroll.lazyLoader"),this._$prev.remove(),this._$next.remove()},_createPrevNextTags:function(){this._$prev=this._findOrCreateSEOTag("prev"),this._$next=this._findOrCreateSEOTag("next")},_findOrCreateSEOTag:function(e){var t;return c.f('link[rel="'.concat(e,'"]')).exists()?t=c.f('link[rel="'.concat(e,'"]')):(t=i('<link rel="'.concat(e,'">')),c.append(t)),t},_updatePrevNextTags:function(){1===this._viewedPage?this._$prev.detach():this._$prev.isInDOM()||c.append(this._$prev),this._viewedPage===this._lastPage?this._$next.detach():this._$next.isInDOM()||c.append(this._$next),this._$prev.attr("href",window.location.origin+this._getNewPageUrl(this._viewedPage-1)),this._$next.attr("href",window.location.origin+this._getNewPageUrl(this._viewedPage+1))},_scrollHandler:function(){var t=this,e=n.filter$(this._dom.pages,function(e){return e.mostlyVisible()}).data("page");this._viewedPage=e||this._viewedPage,this._disableAddingPages||(this._containerTotalHeight=this.$el[0].scrollHeight,!this._requestedPages[this._page]&&u.scrollTop()>=this._nextDataFetchingPoint?(this._requestedPages[this._page]=!0,this._requestPage(this._page).then(function(e){t._cachedData[t._page]=e,t._retryIfNeeded&&t._scrollHandler.call(t)})):u.scrollTop()>=this._containerTotalHeight+this.$el.offset().top-this._settings.appendOffset&&(this._retryIfNeeded=!0,this._cachedData[this._page]&&(this._retryIfNeeded=!1,r.render({newPage:this._cachedData[this._page]}).then(function(e){e=e.newPage,e=i(e);a.trigger("initShareSaveEv",e),t._dom.showMoreWrapper.before(e),t.addToDOM("pages",t.$el.f(".js-lazy-load-page")),t._nextDataFetchingPoint=t._dom.pages.last().offset().top+t._settings.getDataOffset}),++this._page>=this._lastPage?this._disableAddingPages=!0:(this._page-this._initialPage)%3==0&&(this._disableAddingPages=!0,this._dom.showMore.showEl())))),this._updateUrl(),this._updatePrevNextTags()},_requestPage:function(e){return s.getService(this._requestURL,{"page-id":e},{targetUrl:this._getNewPageUrl(e)})},_updateUrl:function(){t.updateLocation(this._getNewPageUrl(this._viewedPage))},_bindScrollBehaviour:function(){u.on("scroll.lazyLoader",n.debounce(this._scrollHandler.bind(this),this._settings.debounceMS))},_addPage:function(){this._dom.showMore.hideEl(),this._disableAddingPages=!1,this._retryIfNeeded=!0,this._scrollHandler()},_getNewPageUrl:function(e){var t=window.location.pathname.replace(/^(.*)(\/\d+)$/,"$1");return"".concat(t).concat(1===e?"":"/".concat(e))+window.location.search}})}),define("Modules/ForexRatesBox/ForexRatesBoxView",["underscore","jquery","Backbone","Displayable"],function(e,t,n,i){return i.extend({_markupScheme:{rangeBar:".js-forex-box-range-bar"},initialize:function(e){i.prototype.initialize.call(this,e)},render:function(){return i.prototype.render.call(this),this.$el},_updateRangeBar:function(e){var t=e.high,n=e.last,e=e.low,n=Math.min((n-e)/(t-e)*100,100);this._dom.rangeBar.css({width:"".concat(n.toFixed(3),"%")})}})}),define("Modules/ForexRatesBox/ForexRatesBox",["underscore","jquery","Backbone","Socket","./ForexRatesBoxView"],function(e,t,n,i,o){return n.EModel.extend({_view:null,_pId:null,initialize:function(e){this._view=new o(e),this._view.render(e),this._pId=e.data("pid")},render:function(){var t=this;i.subscribePair(this._pId,function(e){return t._view._updateRangeBar(e)})}})}),define("Modules/ReplaceableSchemeTabs/ReplaceableSchemeTabsView",["underscore","jquery","Backbone","Displayable","DataChest","TemplateManager","Modules/Table/Table"],function(e,t,n,i,o,r,s){return i.extend({_onChange:null,_table:null,_markupScheme:{buttons:".js-replaceable-scheme-buttons"},initialize:function(e){i.prototype.initialize.call(this,e),this._onChange=this[this.$el.data("on-change")]||"_.noop"},render:function(){return i.prototype.render.call(this),this._initDynamicContentButtons(),this.$el},_initDynamicContentButtons:function(){var t=this;e.e$(this._dom.buttons.mF("li"),function(e){e.on("click",function(){t._fetchAndReplaceContent(e.data("key"))})})},_replaceTabsContent:function(e){this.$el.empty().html(t(e.html)),this.render()},_fetchAndReplaceContent:function(e){var t=this,n=this.$el.data("clientdata-key");r.render({html:o.get(n)[e]}).then(function(e){t._replaceTabsContent(e),t._onChange()})},_initTable:function(){var e=this.$el.mF(".js-table-wrapper");this._table=new s({$tableWrapper:e,tableTitle:e.f(".js-table-title-wrapper").textT()})}})}),define("Modules/ShowMore/ShowMoreView",["underscore","jquery","Backbone","Displayable","Http","TemplateManager","EventBus"],function(t,n,e,i,o,r,s){var a={table:{container:".js-table > tbody",itemSelector:"tr"},comments:{container:".js-discussion-comments-list",itemSelector:".js-comment-item",getParamsType:"comment"},contentPages:{container:".js-content-list",itemSelector:".js-article-item",onAppendHandler:"_bindNewsEvents"}};return i.extend({_componentType:null,_rowsPerClick:null,_newItemsFrom:null,_totalPages:null,_nextPage:null,_newItems:null,_selfSettings:null,_$container:null,_markupScheme:{"?showMoreDataButton":".js-show-more-data-button"},events:{"?click .js-show-more-data-button":"_addMoreData"},initialize:function(e){i.prototype.initialize.call(this,e),this._initSettings(),this._nextPage=2,this._selfSettings={actions:{appendMoreItems:("server"===this._newItemsFrom?this._appendMoreItemsByServer:this._appendMoreItemsByClient).bind(this),onAppend:this[a[this._componentType].onAppendHandler]},conf:{containerSelector:a[this._componentType].container,itemSelector:a[this._componentType].itemSelector,getParamsType:a[this._componentType].getParamsType||"def"}}},render:function(){return i.prototype.render.call(this),this.$el},_initSettings:function(){var e=this.$el.data(),t=e.type,n=e.rowsPerClick,e=e.newItemsFrom;this._componentType=t,this._rowsPerClick=n,this._newItemsFrom=e},_addMoreData:function(){"server"!==this._newItemsFrom&&this._newItems?this._selfSettings.actions.appendMoreItems():this._fetchMoreItemsData()},_fetchMoreItemsData:function(){var t=this,e=this.$el.data();o.getService(e.serviceUrl,this._getParams()).then(function(e){return t._totalPages=e.vars.lastPage,e}).then(function(e){return r.render({element:e})}).then(function(e){e=e.element;t._newItems=n(e).mF(t._selfSettings.conf.itemSelector),t._selfSettings.actions.appendMoreItems()})},_getParams:function(){return{comment:{"page-num":this._nextPage},def:{}}[this._selfSettings.conf.getParamsType]},_popMoreItems:function(){return t.trimFromStart(this._newItems,this._rowsPerClick)},_appendMoreItemsByClient:function(){var e;this._$container||(this._$container=this.$el.mF(this._selfSettings.conf.containerSelector),this._popMoreItems()),e=this._popMoreItems(),this._$container.append(e),t.tryRun(this._selfSettings.actions.onAppend,e),this._newItems.exists()||this._hideButton()},_appendMoreItemsByServer:function(){this._$container||(this._$container=this.$el.mF(this._selfSettings.conf.containerSelector)),this._$container.append(this._newItems),t.tryRun(this._selfSettings.actions.onAppend,this._newItems),this._nextPage++,this._nextPage>this._totalPages&&this._hideButton()},_bindNewsEvents:function(e){s.trigger("initShareSaveEv",n(e))},_hideButton:function(){this._dom.showMoreDataButton.hide()}})}),define("Modules/TvChart/TvChartView",["underscore","jquery","Backbone","Displayable","DataChest","EventBus","AlertActions"],function(n,e,t,i,o,r,s){var a=e(window),l={fullscreen:"_toggleFullScreen",create_alert:"_createAlert",addcurrentpairid:"_switchInstrument",saveloadlayout:"_openLoginPopup"};return i.extend({_pId:null,_receiveMessageFunc:null,_markupScheme:{},events:{},initialize:function(e){var t=this;i.prototype.initialize.call(this,e),this._pId=o.get("instrumentData").instrumentId,this._receiveMessageFunc=this._receiveMessage.bind(this),window.addEventListener("message",this._receiveMessageFunc,!1),a.on("keydown.tvChartShortCuts",function(e){66===e.keyCode&&e.ctrlKey&&t._toggleFullScreen(),65===e.keyCode&&e.altKey&&t._createAlert({pair_ID:t._pId})}),window.globalAccessUtilities={maximize:this._toggleFullScreen.bind(this),minimize:this._toggleFullScreen.bind(this)}},render:function(){return i.prototype.render.call(this),this.$el},destroy:function(){window.removeEventListener("message",this._receiveMessageFunc,!1),a.off("keydown.tvChartShortCuts"),window.globalAccessUtilities=null},_createAlert:function(e){var t=this,n=e.pair_ID;this.loginOrImmediate(function(){s.openSinglePairPopup(n,"Instrument"),t.GTM("InstrumentPageAddAlert",n,!0)})},_toggleFullScreen:function(){this.$el.tCl("is-fullscreen"),r.trigger("toggleFullscreenModeEv")},_switchInstrument:function(e){this._pId=e},_openLoginPopup:function(){this.popLoginSystemAlert()},_receiveMessage:function(e){var e=e.data,t=n.keys(e)[0];this[l[t]]&&this[l[t]](e[t])}})}),define("Modules/PushToInstall/PushToInstall",["underscore","jquery","Backbone","Router","Displayable","Toolset","EventBus"],function(e,n,t,i,o,r,s){var a="pti_test_option",l="pti_test_option_version",u="_pageViewFrequency";return o.extend({_optionLabel:null,_rolledOption:null,_$chosenPopup:null,_pushToInstallURL:null,_pageViewFrequency:null,_persistentTravelCount:null,_markupScheme:{allPopups:".js-push-to-install-popup",closePopupButton:".js-push-to-install-close",downloadButton:".js-push-to-install-download"},initialize:function(e){o.prototype.initialize.call(this,e),this.loadPersistentProps(["_persistentTravelCount","_pageViewFrequency"]),this._initABTestOption(),this._buildPushToInstallURL(),this._initPageViewFrequency()},render:function(){return o.prototype.render.call(this),this._bindPopupEvents(),this._initializePopup(),this.$el},_initABTestOption:function(){var e,t=this.storage.get(a);2!=+this.storage.get(l)?(this._rolledOption=r.Math.rand(1),this.storage.set((_defineProperty(e={},l,2),_defineProperty(e,a,this._rolledOption),e))):this._rolledOption=+t,this._optionLabel="Variant ".concat(["A","B","C","D"][this._rolledOption])},_initPageViewFrequency:function(){var e=this;this._pageViewFrequency||this.persistentPropSet(u,2),s.on("clientNavigationEndEv",function(){return e._firePopupIfNeeded()})},_initializePopup:function(){var e=_slicedToArray(n.isIOs?["ios","android"]:["android","ios"],2),t=e[0],e=e[1];this._$chosenPopup=this._dom.allPopups.eq(this._rolledOption).addRemoveClass(t,e),this._firePopupIfNeeded()},_firePopupIfNeeded:function(){var e=this,t=new URLSearchParams(window.location.search),n=Number(window.localStorage.getItem("page_view_count")||0);n++,window.localStorage.setItem("page_view_count",n),(2==n&&!this._isContentPage()||1==n&&"FBM"==t.get("utm_source"))&&this._$chosenPopup._show().fadeIn(500,function(){return e._$chosenPopup.clearStyle().opacity1()})},_bindPopupEvents:function(){var t=this;this._dom.downloadButton.on("click",function(){t._trackAnalytics("download"),t.outerNavigate(t._pushToInstallURL)}),this._dom.closePopupButton.on("click",function(){var e;t.persistentPropSet((_defineProperty(e={},"_persistentTravelCount",0),_defineProperty(e,u,3),e)),t._trackAnalytics("skip"),t._$chosenPopup.fadeOut(500)})},_trackAnalytics:function(e){},_buildPushToInstallURL:function(){var e=n.edition,t="https://app.appsflyer.com/",t={iOS:[t+"id909998122",t+"id1390978161"],android:[t+"com.fusionmedia.investing","https://android.myapp.com/myapp/detail.htm?apkName=com.fusionmedia.investingCN"]}[n.isIOs?"iOS":"android"][+("cn"===e)],e="?pid=direct_inv&c=mobile_web&af_channel=".concat(window.location.href+window.location.search,"&af_adset=").concat(e,"&af_ad=install_popup");this._pushToInstallURL=t+e},_isContentPage:function(){var e=window.location.href;return e.includes("news/")||e.includes("analysis/")}})}),define("Modules/Tab/MoreTabsView",["underscore","jquery","Backbone","Displayable"],function(t,o,e,n){var i=o(window);return n.extend({_reversedInstrumentTabs:null,_tabsMapByIndex:null,_tabIndexToMoreTab:null,_lastVisibleTab:null,_markupScheme:{Tabs:".js-header-tab",MoreTabsWrapper:".js-more-tabs-popup-wrapper",MoreTabsButton:".js-more-tabs-button",MoreTabs:".js-more-tabs",MoreTabLinkClone:".js-more-tabs-link-clone",MoreTabNonLinkClone:".js-more-tabs-non-link-clone","?SubTabsScroller":".js-sub-tabs-scroller","?SubTabs":".js-sub-tab-link"},initialize:function(e){n.prototype.initialize.call(this,e)},render:function(){return n.prototype.render.call(this),this._initMoreTabs(),this.$el},_initMoreTabs:function(){var e=this;i.on("resize",t.throttle(function(){return e._updateTabsInMoreTabsPopup()},100)),this._reversedInstrumentTabs=o(t.getReversed(this._dom.Tabs)),this.setupPopup(this.$el,".js-more-tabs-button",".js-page-tabs-more-popup",["openLeftwards","WithLinks"]),this._dom.MoreTabLinkClone.remove(),this._dom.MoreTabNonLinkClone.remove(),this._initTabsState(),this._updateTabsInMoreTabsPopup()},_initTabsState:function(){var i=this;this._tabsMapByIndex={},this._tabIndexToMoreTab={},this._lastVisibleTab=0,t.e$(this._reversedInstrumentTabs,function(e,t){var n=e.f(".js-tab-li-link");n&&!n.isSelected()||(i._selectedTabIndex=t),i._tabsMapByIndex[t]={tabHeader:e.f(".js-tab-li-text").html(),tabUrl:n.attr("href")}})},_updateTabsInMoreTabsPopup:function(){var n=this,i=this._reversedInstrumentTabs.last().offset().top;t.e$(this._reversedInstrumentTabs,function(e,t){o.isMobile()&&t===n._selectedTabIndex&&n.$el.scrollElementIntoView(e,!0),i<e.offset().top?(n._lastVisibleTab=t,n._moveTabIntoMoreTabs(t)):n._removeTabFromMoreTabs(t),o.isMobile()&&n._dom.SubTabsScroller.scrollElementIntoView(n._dom.SubTabs.filterWithSelected(),!0),n._dom.MoreTabsWrapper.tCl("u-visibility-hidden",n._isAllTabsVisible()),n._dom.MoreTabsButton.toggleSelected(n._lastVisibleTab>=n._selectedTabIndex)})},_isAllTabsVisible:function(){return this._reversedInstrumentTabs.first().offset().top===this._reversedInstrumentTabs.last().offset().top},_moveTabIntoMoreTabs:function(e){var t,n=this._tabsMapByIndex[e];this._lastVisibleTab<=e&&!this._tabIndexToMoreTab[e]&&((t=this._dom[n.tabUrl?"MoreTabLinkClone":"MoreTabNonLinkClone"].clone()).mF(".js-more-tab-li-text").html(n.tabHeader),n.tabUrl?t.mF(".js-more-tab-li-link").href(n.tabUrl):t.setSelected(),this._dom.MoreTabs.append(t),this._lastVisibleTab=e+1,this._tabIndexToMoreTab[e]=t)},_removeTabFromMoreTabs:function(e){this._tabIndexToMoreTab[e]&&(this._tabIndexToMoreTab[e].remove(),delete this._tabIndexToMoreTab[e])}})}),define("Modules/DynamicPage/DynamicPage",["underscore","jquery","Backbone","Displayable","Toolset","Server","EventBus","DataChest","./More","./GeneralInits","Modules/News/News","Modules/Table/Table","Modules/TableControls/TableControls","Modules/BulkActions/BulkActions","Modules/Discussion/Discussion","Modules/Sentiments/Sentiments","Modules/Charts/StandaloneChart","Modules/InvMoney/InvMoneyView","Modules/MajorFilters/MajorFiltersView","Modules/FiltersGroup/FiltersGroupView","Modules/DynamicTabs/DynamicTabsView","Modules/LazyLoadPagination/LazyLoadPaginationView","Modules/ForexRatesBox/ForexRatesBox","Modules/SearchableList/SearchableListView","Modules/ReplaceableSchemeTabs/ReplaceableSchemeTabsView","Modules/ShowMore/ShowMoreView","Modules/TvChart/TvChartView","Modules/PushToInstall/PushToInstall","Modules/Tab/MoreTabsView","ActionQueue"],function(s,a,i,o,r,l,u,c,d,h,p,f,e,t,m,_,g,v,b,y,w,S,T,C,k,x,M,n,P,A){var L=l.cdnPath,E=(lcl,"lastClientVersion"),D=!!window.isProduction,I=lcl.makeCustom("DynamicPage"),j=(lcl.makeCustom("GTM"),+c.get("lastClientMap")),F=!0,O=!1;return o.extend({_tables:null,_promises:null,_clientMap:null,_initialLoad:!0,_bulkActions:null,_customViews:null,_tableControls:null,_loadedModulesKeys:null,_instrumentDetails:null,_loadedModulesNames:null,_instrumentPageHeader:null,_destructionCallbacks:null,_leftPanelIsInitialized:!1,_mainHeaderSimpleCountryDD:!1,_isCompletePage:null,_markupScheme:{"?SectionContent":".js-section-content","?LeftPanel":".js-left-panel","?RightsidePanel":".js-rightside-panel","?Tables":".js-main-content-container .js-table-wrapper","?TableControls":".js-table-controls","?BulkActions":".js-main-content-container .js-bulk-panel","?CustomViewsWrapper":".js-custom-views-wrapper","?CustomViews":".js-table-views-tabs-more","?StandAlonePopups":".js-standalone-popup-wrapper","?MajorFilters":".js-major-filters","?FiltersGroup":".js-filters-group","?InstrumentPageHeader":".js-instrument-page-header","?ForecastBox":".js-forecast-box","?OverviewChart":".js-overview-chart-wrapper","?EventPageHeader":".js-event-header","?MiniCharts":".js-mini-chart-wrapper","?OptionsTable":".js-options-table","?Discussion":".js-section-content .js-discussion-content","?Sentiments":".js-sentiments-wrapper","?ShareWrapper":".js-main-share-wrapper","?SearchResults":".js-search-results-wrapper","?StandaloneChart":".js-standalone-chart","?DynamicTabs":".js-dynamic-tabs-main-wrapper","?ForexRatesBoxes":".js-forex-rates-box","?LazyLoadPagination":".js-lazy-load-main-container","?News":".js-news-wrapper","?WelcomePopup":".js-welcome-popup","?TvChartWrapper":".js-tv-chart-wrapper","?InvMoneyWrapper":".js-investing-money","?ReplaceableSchemeTabsWrappers":".js-replaceable-scheme-wrapper","?ShowMoreDataWrappers":".js-show-more-data-wrapper","?HeaderTabsWrapper":".js-header-tabs-wrapper","?notices":".js-notice-wrapper","?EconomicCalendar":".js-economic-calendar"},_modulesToInitialize:{CustomViews:"_initCustomViews",OptionsTable:"_initOptionsTable",MiniCharts:"_initializeMiniCharts",InstrumentPageHeader:"_initInstrumentPageHeader",OverviewChart:"_initializeOverviewChart",EventPageHeader:"_initEventPageHeader",SearchResults:"_initGenericModule",EconomicCalendar:"_initEconomicCalendar"},_persistentModulesToInitialize:{LeftPanel:"_initLeftPanel",RightsidePanel:"_initGenericModule"},reinitialize:function(){return this.destroy().render(!0),Promise.all(this._promises)},initialize:function(e,t,n){o.prototype.initialize.call(this,e),this._isCompletePage=t,this._$globalElements=n,u.on("initShareSaveEv",this._initSaveShareButtons.bind(this))},render:function(e,t){var n=this;return o.prototype.render.call(this),this._promises=[],this._loadedModulesKeys=[],this._loadedModulesNames=[],this._destructionCallbacks=[],this._instrumentId=t||a(".js-instrument-page-header").data("instrument-id"),this._generalInits(),this._loadMap().then(e?function(){return n._initNonPersistent()}:function(){return n._initAll()}).catch(lcl),this._initialLoad=!1,this.$el},destroy:function(){var t=this;return s.e(this._loadedModulesKeys,function(e){t[e].destroy(),delete t[e]}),s.e(this._destructionCallbacks,function(e){return e()}),this._destructionCallbacks=[],this._loadedModulesKeys=[],this},_initAll:function(){this._initModules(s.extend({},this._persistentModulesToInitialize,this._modulesToInitialize)),this._initializeAdditionalPersistent()},_initNonPersistent:function(){this._initModules(this._modulesToInitialize)},_initModules:function(e){var t=this;s.mapObject(e,this._initIfExists.bind(this)),Promise.all(this._promises).then(function(){A.executeActions("afterDynamicPage"),F&&window.markTime("Client Initialization Done"),F=!1,I("Detected and loaded the following bundles: ".concat(t._loadedModulesNames.join(", ")))})},_loadMap:function(){var i=this;return new Promise(function(n){(r.ClientStorage.cache(E)||0)!==j?(I("Newer Client Version Exists"),l.Maps.Client(j,D).then(function(e){var t={};s.e(e,function(e){return t[e.name]=e}),i._clientMap=t,r.ClientStorage.setObj("_c_m_",t),r.ClientStorage.cache(E,j),n()}).catch(function(e){return lcl(e)})):(i._clientMap=r.ClientStorage.getObj("_c_m_"),n())})},_markForDestruction:function(e,t){this._loadedModulesKeys.push(e),t&&this._destructionCallbacks.push(t)},_getBundleCdnPath:function(e){var e=this._clientMap[e],t=e.r_name,e=e.v;return"".concat(L+t+e,".js")},_getModulePath:function(e){e=this._clientMap[e].path;return(D?"app/modules/":"Modules/").concat(e)},_fetchAndFireInitialization:function(t,n){var i=this;this._promises.push(require.promise([this._getModulePath(t)]).then(function(e){e=_toArray(e).slice(0);return i[n].apply(i,_toConsumableArray(e).concat([i._dom[t]]))}))},_initIfExists:function(e,t){var n=this;this._dom[t].exists()&&(this._loadedModulesNames.push(t),D?require.promise([this._getBundleCdnPath(t)]).then(function(){return n._fetchAndFireInitialization(t,e)}):this._fetchAndFireInitialization(t,e))},_initTables:function(e){var t=this,n=i.ECollection.extend({model:f});this._tables=new n,s.e$(e,function(e){return e.contains("table.js-table")&&t._tables.create({$tableWrapper:e,tableTitle:e.f(".js-table-title-wrapper").textT()})}),this._dom.BulkActions.exists()&&this._initBulkActions(),this._dom.TableControls.exists()&&this._initTableControls(),this._markForDestruction("_tables")},_initBulkActions:function(){this._bulkActions=new t(this._tables,this._dom.SectionContent),this._bulkActions.render(this._dom.BulkActions),this._markForDestruction("_bulkActions")},_initTableControls:function(){new e(this._tables,this._bulkActions,this._dom.SectionContent,this.$el,this._dom.TableControls).render()},_initInstrumentPageHeader:function(e,t){this._instrumentPageHeader=new e(t,this._instrumentId),this._instrumentPageHeader.render(),this._leftPanelIsInitialized?u.trigger.apply(u,["addToRecentListEv"].concat(_toConsumableArray(this._instrumentPageHeader.getInstrumentDetails()))):this._isCompletePage&&(this._instrumentDetails=this._instrumentPageHeader.getInstrumentDetails()),this._markForDestruction("_instrumentPageHeader")},_initLeftPanel:function(e,t){new e(t).render(this._instrumentDetails),this._leftPanelIsInitialized=!0},_initOptionsTable:function(e,t){new e(t,this._instrumentId).render()},_initCustomViews:function(e){this._customViews=new e(this._dom.CustomViewsWrapper),this._markForDestruction("_customViews")},_initGenericModule:function(e,t){new e(t).render()},_initializeOverviewChart:function(e,t){(new e).render(t)},_initEventPageHeader:function(e,t){new e(t).render()},_initEconomicCalendar:function(e,t){new e(t).render()},_initializeMiniCharts:function(t,e){s.e$(e,function(e){(new t).render(e)})},_initializeAdditionalPersistent:function(){var e=this._$globalElements.f(".js-push-to-install-wrapper");a.isMobile()&&e.exists()&&new n(e).render()},_initSEOTags:function(){var t=a(document.head);t.f('script[type="application/ld+json"]').remove(),s.e(c.get("SEOData"),function(e){return t.append(a("<script>").attr("type","application/ld+json").html(JSON.stringify(e)))})},_generalInits:function(){var e,t,n=this,i=(new h(this.$el).render(),this.setupPopup(this.$el.f(".js-info-popup-opener"),this.$el.f(".js-info-popup")),this.setupPopup(this.$el.f(".js-country-selection-dropdown"),this.$el.f(".js-country-selection-dropdown-popup"),["Searchable","WithLinks"]),this.$el.f(".js-simple-country-selection")),o=(i.exists()&&(e=this.$el.f(".js-simple-country-selection-popup"),(t=new C(e)).render(),t.loadListFromDOM(),this.setupPopup(i,e,["WithLinks"]),this._mainHeaderSimpleCountryDD=t,this._markForDestruction("_mainHeaderSimpleCountryDD",function(){return n.unsetupPopup(i)})),this._dom.Tables.exists()&&this._initTables(this._dom.Tables),this._dom.InvMoneyWrapper.exists()&&new v(this._dom.InvMoneyWrapper).render(),this._dom.ForecastBox.exists()&&this.setupForecastBox(this._dom.ForecastBox,this._instrumentId),this._dom.Discussion.exists()&&new m("Instrument").render(this._dom.Discussion),this._dom.Sentiments.exists()&&new _(this._dom.Sentiments,"Instrument").render(this._dom.Sentiments),this._dom.FiltersGroup.exists()&&new y(this._dom.FiltersGroup).render(),this._dom.MajorFilters.exists()&&new b(this._dom.MajorFilters).render(),this._dom.StandaloneChart.exists()&&s.e$(this._dom.StandaloneChart,function(e){(new g).render(e)}),this._dom.ReplaceableSchemeTabsWrappers.exists()&&s.e$(this._dom.ReplaceableSchemeTabsWrappers,function(e){new k(e).render()}),this._dom.DynamicTabs.exists()&&s.e$(this._dom.DynamicTabs,function(e){new w(e).render()}),this._dom.ForexRatesBoxes.exists()&&s.e$(this._dom.ForexRatesBoxes,function(e){new T(e).render()}),this._dom.LazyLoadPagination.exists()&&(this._lazyLoader=new S(this._dom.LazyLoadPagination),this._lazyLoader.render(),this._markForDestruction("_lazyLoader")),this._dom.News.exists()&&s.e$(this._dom.News,function(e){new p(e).render()}),this._dom.TvChartWrapper.exists()&&(this._tvChart=new M(this._dom.TvChartWrapper),this._tvChart.render(),this._markForDestruction("_tvChart")),this._dom.ShowMoreDataWrappers.exists()&&s.e$(this._dom.ShowMoreDataWrappers,function(e){new x(e).render()}),this._dom.HeaderTabsWrapper.exists()&&new P(this._dom.HeaderTabsWrapper).render(),this._dom.StandAlonePopups.exists()&&s.e$(this._dom.StandAlonePopups,function(e){return n.setupPopup(e,".js-standalone-popup-opener",".js-standalone-popup")}),this.$el.f(".js-create-custom-view").on("click",this.loginOr(function(){return u.trigger("createCustomViewEv")})),this.$el.f(".js-embedded-google-map").on("click",function(e){var e=e.currentTarget,e=a(e),t=e.data("key"),t=c.get(t),n=e.height(),i=e.width(),i=a('<iframe width="'.concat(i,'" height="').concat(n,'" frameborder="0" scrolling="no" marginheight="0" marginwidth="0"\n\t\t\t\t\t\tsrc="https://maps.google.com/maps?q=').concat(encodeURI(t),'&t=&z=13&ie=UTF8&iwloc=&output=embed">'));e.before(i).remove()}),s.e$(this.$el.f(".js-expand-content-wrapper"),function(e){var t=e.mF(".js-expand-content-button"),n=t.mF("span"),i=n.textT(),o=t.data("show-less");t.on("click",function(){e.toggleOpen(),n.text(e.isOpen()?o:i)})}),s.e$(this.$el.f(".js-toggled-wrapper"),function(e){var t=e.mF(".js-toggled-content");e.mF(".js-toggled-opener").on("click",function(){return t.toggleIsOpen()})}),this.GTM.bind(this)),r=(this.$el.f(".js-main-navigation-link").on("click",function(){o("QuotesTableMainNav",a(this).textT())}),this.$el.f(".js-navigation-link").on("click",function(){o("QuotesTableViewNav",a(this).textT())}),this.$el.f(".js-disclaimer"));r.exists()&&this.$el.f(".js-disclaimer-button").on("click",function(){return a.scrollToElement(r)}),this._initialLoad||this._initSEOTags(),this._isCompletePage&&(this._more=new d(this.$el),this._more.render(),this._markForDestruction("_more")),this.$el.f(".js-outbrain-wrapper").exists()&&(O?window.OBR&&window.OBR.extern&&s.tryRun(window.OBR.extern.reloadWidget):a.getScript("https://widgets.outbrain.com/outbrain.js",function(e,t,n){200===n.status&&"success"===t&&(O=!0)})),this._dom.notices.exists()&&s.e$(this._dom.notices,function(e){e.mF(".js-notice-close").on("click",function(){return e.hide()})}),this._initSaveShareButtons(this.$el)},_initSaveShareButtons:function(e){var t=this,n={};s.e$(e.f(".js-article-save-button"),function(e){e.on("click",function(){t.loginOrImmediate(function(){l.SavedItems.Add(e.data("id"),e.data("type")).then(function(){return e.tCl("is-saved",!0)})})}),n[e.data("id")]=e}),s.e$(e.f(".js-article-share-button"),function(i){i.on("click",function(){var e=i.data(),t=e.url,n=e.title,e=e.desc;u.trigger("FireShareEv",t,n,e)})}),u.on("unsaveArticleEv",function(e){return n[e]&&n[e].rCl("is-saved")})}})}),define("Modules/UserActions/UserActionsView",["underscore","jquery","Backbone","Displayable"],function(e,t,n,i){return i.extend({events:{"?click .js-sign-out":"_signOutInView"},initialize:function(e){i.prototype.initialize.call(this,e)},render:function(){return i.prototype.render.call(this),this.$el},_signOutInView:function(){this.trigger("signOutEv")}})}),define("UserActions",["underscore","jquery","Backbone","Server","Modules/UserActions/UserActionsView"],function(t,e,n,i,o){return n.EModel.extend({initialize:function(){this.redirectOnLogoutMap=[{regex:/^(.*?(custom-view)[^$]*)$/,calculateUrl:function(){return t.trimFromTargetString(window.location.pathname,"/custom-view")}}]},render:function(e){return this._view=new o(e),this._view.render(),this._view.onMultiple({signOutEv:this._signOutAndReload.bind(this)}),this},_signOutAndReload:function(){var e=this;i.User.SingOut().then(function(){var n;t.e(e.redirectOnLogoutMap,function(e){var t=e.calculateUrl,e=e.regex;window.location.pathname.match(e)&&(n=t())}),n?e.outerNavigate(n):window.location.reload()})}})}),define("Modules/Share/ShareView",["underscore","jquery","Backbone","Displayable","EventBus"],function(t,e,n,i,o){return i.extend({_encodedUrl:null,_initialPreview:null,_markupScheme:{mainTabsButtons:".js-main-share-tabs-button",mainTabsSections:".js-main-share-tabs-section",secondaryTabsButtons:".js-main-share-secondary-tab",previewUrl:".js-main-share-preview-url",previewTitle:".js-main-share-preview-title",previewDesc:".js-main-share-preview-description",embedCodePlaceholder:".js-main-share-embed-placeholder",embedCopyButton:".js-main-share-embed-copy-button",copyLinkButton:".js-main-share-copy-button",copyUrl:".js-main-share-copy-url"},events:{"?click .js-main-share-twitter":"_openTwitterPopup","?click .js-main-share-facebook":"_openFacebookPopup","?click .js-main-share-whatsapp":"_openWhatsappPopup","?click .js-main-share-vk":"_openVkPopup"},initialize:function(e){i.prototype.initialize.call(this,e)},render:function(){return i.prototype.render.call(this),this._bindCopyToClipboardClicks(),this._initializeTabs(),this._initialPreview={title:this._dom.previewTitle.text(),desc:this._dom.previewDesc.text()},this.$el},openShare:function(e,t,n){e=e||location.href;this._dom.previewUrl.text(e).href(e),this._dom.copyUrl.text(e),this._dom.previewTitle.text(t||this._initialPreview.title),this._dom.previewDesc.text(n||this._initialPreview.desc),this._encodedUrl=encodeURIComponent(e),this.firePopup(this.$el,["modal","global"])},_bindCopyToClipboardClicks:function(){var e=this;this._dom.copyLinkButton.on("click",this._copyLink.bind(this,this._dom.copyUrl)),this._dom.copyUrl.on("click",function(){return e._dom.copyUrl.selectText()})},_copyLink:function(e){t.copyToClipboard(e.textT(),e[0]),e.selectText()},_initializeTabs:function(){this.setupTabs(this._dom.mainTabsButtons,this._dom.mainTabsSections)},_openFacebookPopup:function(){t.openSocialPopup("facebook",this._encodedUrl)},_openTwitterPopup:function(){t.openSocialPopup("twitter",this._encodedUrl,400)},_openWhatsappPopup:function(){t.openSocialPopup("whatsapp",this._encodedUrl)},_openVkPopup:function(){t.openSocialPopup("whatsapp",this.vk)}})}),define("Modules/MainFrame/MainFrameView",["underscore","jquery","Backbone","Displayable","EventBus"],function(a,l,e,t,r){var n=a.oneHour,i=l(window),o=l(document),s=l(document.body),u=l(document.head);return t.extend({_lastExcess:null,_lastIdleToken:null,_tabsReorderMemo:null,_lastScrollPosition:null,_partialsRenderSubscribers:null,_markupScheme:{header:".js-section-header",content:".js-section-content",mainHeader:".js-main-header",mainMenu:".js-menu-wrapper",mainContentContainer:".js-main-content-container","?rightsidePanelContent":".js-rightside-panel-content","?leftsideMainContainer":".js-left-panel-main-container"},initialize:function(){var e=this;t.prototype.initialize.call(this,"#js-main-container"),this._copyGlobalViewLogicToEModel(),r.onMultiple({tableViewsTabsReorderEv:this._memorizeReorder.bind(this),toggleFullscreenModeEv:function(){return e.$el.tCl("is-no-sticky-panels")}})},render:function(){var e=this;return t.prototype.render.call(this),this._initEditionPopup(),this._initMegaMenu(),this._initToOldSite(),this._initPartialsSubscription(),this._bindNavigationActions(),this._scrollHandler(),this._resetIdle(),o.on("mousemove click keydown",function(){return e._resetIdle()}),i.on("scroll resize",a.throttle(function(){return e._scrollHandler()},128)),i.on("scroll",function(){e._dom.mainHeader.tCl("is-scrolled",!!o.scrollTop()),e._partialsRenderSubscribers.main_header[0].tCl("is-sticky",o.scrollTop()<e._lastScrollPosition),e._lastScrollPosition=o.scrollTop()}),r.answer("mainContentContainerQ",function(){return e._dom.mainContentContainer}),r.on("reloadClientEv",function(){return setTimeout(function(){return window.location.reload()},a.rand(a.halfAMinute))}),this.$el},setHeaders:function(e){o.attr("title",e.title),u.mF("meta").remove(),a.e(e.meta,function(e){return u.prepend("<meta ".concat(a.map(e,function(e,t){return"".concat(t,'="').concat(e,'"')}).join(" ")," />"))})},setMainContent:function(e){var t=l(e.content),n=l(e.header);r.trigger("newMainContentInjection",t),this._tabsReorderMemo&&this._modifyNewContentsTabOrder(n),this._dom.content.html(t),this._dom.header.html(n),this._setPartialsContent(e)},_resetIdle:a.debounce(function(){var e=this;clearTimeout(this._lastIdleToken),this._lastIdleToken=setTimeout(function(){r.trigger("userIsIdleEv"),e._resetIdle()},n)},1e3),_setPartialsContent:function(o){var r=this;a.e(this._partialsRenderSubscribers,function(e,t){var e=_slicedToArray(e,2),n=e[0],e=e[1],i=l(o[t]).seek(e,!0);n.hCl("is-sticky")&&i.aCl("is-sticky"),n.replaceWith(i),r._partialsRenderSubscribers[t]=[i,e]})},_initPartialsSubscription:function(){var i=this;this._partialsRenderSubscribers={main_header:[this.$el.f(".js-grey-menu-wrapper"),".js-grey-menu-wrapper"],main_header_revenues:[this.$el.mF(".js-main-header-revenue-wrapper"),".js-main-header-revenue-wrapper"],body_revenues:[this.$el.mF(".js-body-revenues-wrapper"),".js-body-revenues-wrapper"]},r.on("subscribeForPartialRenderEv",function(e,t,n){return i._partialsRenderSubscribers[e]=[t,n]})},_initToOldSite:function(){var e=s.f(".js-go-back-to-old-site-wrapper");s.f(".js-go-back-to-old-site").on("click",function(){var e,t,n,i,o;e="red_utm",t="",n=0,o=new Date,i=i||"/",o.setTime(o.getTime()+n*a.oneDay),n="expires="+o.toUTCString(),document.cookie=e+"="+t+";"+n+";path="+i,document.location.reload()}),s.f(".js-go-back-to-old-site-close").on("click",function(){e.hideEl(),document.cookie="hideBackToOld=1;domain=".concat(window.location.hostname,";path=/; expires=").concat(new Date(Date.now()+a.halfAnHour).toUTCString())})},_bindNavigationActions:function(){var e=this,t=s.mF(".js-navigation-indication");r.on("clientNavigationStartEv",function(){return r.trigger("indicateLoadingEv")}),r.on("clientNavigationEndEv",function(){r.trigger("indicateLoadingOffEv"),e.scanDOMForSocket(e._dom.mainContentContainer),e._updateMainLoginButtonsLink()}),r.on("indicateLoadingEv",function(){return t._show()}),r.on("indicateLoadingOffEv",function(){return t._hide()})},_updateMainLoginButtonsLink:function(){this._dom.mainHeader.add(this._dom.leftsideMainContainer).f(".js-login-link").href(l.getLoginURL())},_scrollHandler:function(){var e,t,n;l.isntMobile()&&(e=(t=this._dom.rightsidePanelContent.height()<this._dom.mainContentContainer.height())?this._dom.rightsidePanelContent:this._dom.mainContentContainer,t=t?this._dom.mainContentContainer:this._dom.rightsidePanelContent,(n=Math.max(e.height()-i.height(),0))!==this._lastExcess&&(e.css({position:"sticky",top:-n}),t.removeAttr("style"),this._lastExcess=n)),this._resetIdle()},_copyGlobalViewLogicToEModel:function(){e.EModel.prototype.loginOr=t.prototype.loginOr,e.EModel.prototype.popSystemAlert=t.prototype.popSystemAlert,e.EModel.prototype.popLoginSystemAlert=t.prototype.popLoginSystemAlert},_initMegaMenu:function(){var e,n,t,i,o,r=this,s=this._dom.mainMenu.f(".js-accordion");s.exists()&&(e=this._dom.mainMenu.f(".js-menu-sub-category"),t=this._dom.mainMenu.mF(".js-menu"),i=this._dom.mainMenu.mF(".js-major-menu-opener"),this._dom.mainMenu.f("a[href]").on("click",function(){t.hideElDesktop(),l.toggleMobileNoScroll(!1),l.isMobile()&&r._dom.mainMenu.add(s).rCl("open"),setTimeout(function(){return t.showElDesktop()},100)}),this.$el.mF(".js-menu-opener").on("click",function(){l.toggleMobileNoScroll(!0),r._dom.mainMenu.aCl("open"),l.isMobile()&&s.first().aCl("open")}),this.$el.mF(".js-menu-closer").on("click",function(){l.toggleMobileNoScroll(!1),r._dom.mainMenu.add(s).rCl("open")}),this.setupAccordion(s),a.e$(e,function(e){var t=e.mF(".js-accordion");e.mF(".js-accordion-closer").on("click",function(){return t.rCl("open")})}),a.e$(t,function(e){var t=e.mF(".js-menu-sub-category");t.hover(function(e){return n=setTimeout(function(){return t.unselect()&&l(e.currentTarget).setSelected()},200)},function(){return clearTimeout(n)})}),a.e$(i,function(e){e.hover(function(){return o=setTimeout(function(){return e.aCl("is-hover")},300)},function(){return e.rCl("is-hover")&&clearTimeout(o)})}))},_initEditionPopup:function(){var t=this;a.e$(this.$el.mF(".js-header-edition-wrapper"),function(e){return t.setupPopup(e,".js-header-edition-opener",".js-header-edition-popup")})},_memorizeReorder:function(e){this._tabsReorderMemo=e},_modifyNewContentsTabOrder:function(e){var t=_slicedToArray(this._tabsReorderMemo,2),n=t[0],t=t[1],e=e.mF(".js-custom-views-wrapper"),i=e.mF(".js-table-views-outcast-tab"),e=e.mF(".js-table-views-tab"),o=i.eq(n);i.eq(t).swapWith(o),e.eq(t).mF(".js-navigation-link").changeTagType("button").setSelected().text(o.textT()),r.trigger("customViewReorderEv",{oldI:n,newI:t},!0),this._tabsReorderMemo=null}})}),define("Modules/MainFrame/MainFrame",["underscore","jquery","Backbone","EventBus","Http","Server","TemplateManager","Toolset","DataChest","MainSearch","Modules/DynamicPage/DynamicPage","AlertActions","PortfolioActions","UserActions","Modules/Share/ShareView","./MainFrameView"],function(u,i,e,c,d,t,l,n,h,o,r,s,a,p,f,m){var _,g=8*u.oneHour,v=i(document.body),b=lcl.makeCustom("MainFrame");return e.EModel.extend({_dynamicPage:null,_modulesMap:null,_$globalElements:null,initialize:function(){var n=this;this._view=new m,_=this._view.render(),this._$globalElements=v.mF(">.js-main-wrapper>.js-global-elements"),this.config.isProduction||this._setupDevFunctions(),c.on("renderDynamicPageEv",function(e){var t=1<arguments.length&&void 0!==arguments[1]?arguments[1]:null;(!e?(n._dynamicPage.destroy(),c.trigger("resetBulkActionsEv"),n._dynamicPage=new r(e||_,!0),n._dynamicPage):new r(e||_,!1)).render(!0,t)}),this._initClientNewVersionPolling()},render:function(){this._initAlertAndPortfolioActions(),this._initShare(),this._initMainSearch(),this._initUserActions()},navigateLocal:function(){for(var n=this,e=arguments.length,t=new Array(e),i=0;i<e;i++)t[i]=arguments[i];var o=t.pop(),r=u.clean(t),s=u.size(r),a=u.isOne(s)?"/":"",l=Date.now();b("Starting Local Navigation, Fetching Scheme"),this._updateDataChest(r),d.getPageScheme("".concat(s?"/".concat(r.join("/")):"").concat(a).concat(o?"?".concat(o):"")).then(function(e){var t=Date.now();b("Scheme arrived, call took ".concat(t-l,"ms")),n._loadScheme(e).then(function(e){n._view.setMainContent(e),n._dynamicPage.reinitialize().then(function(){return c.trigger("clientNavigationEndEv",t)})})})},initializePage:function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];this._updateDataChest(t),b("Initializing Page"),this._dynamicPage=new r(_,!0,this._$globalElements),this._dynamicPage.render()},_initClientNewVersionPolling:function(){setInterval(t.Portfolio.Fetch,g)},_setupDevFunctions:function(){var n=this;window.fetchSchemeAndRender=function(e,t){return d.getService(e).then(function(e){return window.renderScheme(e,t)})},window.renderScheme=function(e,t){l.render({scheme:e}).then(function(e){return t?i(t).html(i(e.scheme)):n._view.firePopup(i(e.scheme),["modal"])})},d.on(500,function(e){return!n.config.isProduction&&n.popSystemAlert(i("<span/>").text("Backend Error - ").append(i("<button>").text("Copy Details").on("click",function(){return u.copyToClipboard(JSON.stringify(u.extend(e,{location:window.location.toString()})))})),u.oneMinute)})},_initMainSearch:function(){(new o).render(_.mF(".js-main-search"))},_initAlertAndPortfolioActions:function(){s.render(this._$globalElements.mF(".js-alerts-popup")),a.render(this._$globalElements.mF(".js-portfolio-popup"))},_initShare:function(){var e=new f(this._$globalElements.mF(".js-main-share-wrapper"));e.render(),c.on("FireShareEv",e.openShare.bind(e))},_initUserActions:function(){(new p).render(_.mF(".js-main-login-buttons"))},_updateDataChest:function(e){h.setClientData("TablePageRootURL",e?"/".concat(e[0],"/").concat(e[1],"/"):"/")},_loadScheme:function(e){var t=e.head,n=e.body,e=e.clientData,i=n.header,o=n.content,r=n.right_side,s=n.main_header,a=n.main_header_revenues,n=n.body_revenues;return h.setData(e),this._view.setHeaders(t),l.refetchMap().render({header:i,content:o,right_side:r,main_header:s,main_header_revenues:a,body_revenues:n}).catch(function(e){return lcl("@@@@",e)})}})}),define("Modules/PopupsManager/PopupView",["underscore","jquery","Backbone","Displayable","EventBus","Modules/SearchableList/SearchableListView"],function(i,o,e,r,t,n){return r.extend({isOpen:null,isModal:null,isSticky:null,isGlobal:null,isSuperModal:null,_openLeftwards:null,_overrideAlwaysTop:null,_isOpenWithinContent:null,_beforeOpenBlocking:null,_beforeOpen:null,_afterOpen:null,_onClose:null,initialize:function(e){var t=1<arguments.length&&void 0!==arguments[1]?arguments[1]:{},n=i.isIn(t,"WithLinks");r.prototype.initialize.call(this,e),this.isModal=i.isIn(t,"modal"),this.isSticky=i.isIn(t,"sticky"),this.isGlobal=i.isIn(t,"global"),this.isSuperModal=i.isIn(t,"superModal"),this._isOpenWithinContent=i.isIn(t,"openWithinContent"),this._overrideAlwaysTop=i.isIn(t,"overrideAlwaysTop"),this._beforeOpenBlocking=t.beforeOpenBlocking,this._beforeOpen=t.beforeOpen,this._openLeftwards=t.openLeftwards,this._afterOpen=t.afterOpen,this._onClose=t.onClose,this._detachIfGlobal(),i.isIn(t,"Searchable")&&this._initSearchableList(),this.$el.on("click",function(e){o(e.target)[n?"isOrInALocalNavigationLink":"isLocalNavigationLink"]()||e.stopPropagation()})},render:function(){},destroy:function(){this.$el.remove()},showPopup:function(){i.tryRun(this._beforeOpen),this._beforeOpenBlocking?this._beforeOpenBlocking().then(this._showPopupElementAndTrigger.bind(this)):this._showPopupElementAndTrigger(),i.tryRun(this._afterOpen)},hidePopup:function(){this.$el._hide(),this.isOpen=!1,this._detachIfGlobal(),i.tryRun(this._onClose),this.trigger("close")},alignDirection:function(){this._overrideAlwaysTop||this.$el.rCl("is-top").tCl("is-top",!this.$el.isInView()&&this.$el.offsetFromVPTop()>this.$el.height())},_alignHorizontalDirection:function(){this.$el.rCl("is-end"),(this._openLeftwards||this._isOpenWithinContent&&!this.$el.isWithinBoundsOf(t.ask("mainContentContainerQ"),!0))&&this.$el.aCl("is-end")},_detachIfGlobal:function(){this.isGlobal&&this.$el.detach()},_initSearchableList:function(){this._sList=new n(this.$el),this._sList.render(),this._sList.loadListFromDOM(!0)},_showPopupElementAndTrigger:function(){this.$el._show(),this._alignHorizontalDirection(),this.alignDirection(),this.isOpen=!0,this.trigger("open")}})}),define("PopupsManager",["underscore","jquery","Backbone","Modules/PopupsManager/PopupView","Toolset"],function(o,r,e,s,a){var n="is-content-side-hide";return e.EModel.extend({_dom:null,_openCount:0,_popups:new Map,_openedPopups:[],_lastModalPopup:null,_lastSuperModalPopup:null,_overlayIsShown:null,_isAboutToOpenPopup:null,_documentIsBound:null,_skipDocumentCloseAll:null,_lastScrollPosition:null,initialize:function(){var t=this;e.EModel.prototype.initialize.call(this),this._initDOMRefs(),a.Keyboard.on("esc",this._closeModal.bind(this)),this._dom.$modalWrapper.onUnpropagatedEvent("mousedown",function(e){return 1===e.which&&t._closeModal()})},render:function(){},setup:function(e,t,n){var i=this;if(e.exists())return e.on("click.popupSetup",function(e){r(e.target).isLocalNavigationLink()||(i.fire(t,n),e.stopPropagation())}),a.EarlyListener.wasElementClicked(e)&&(lcl("Firing from Early Listener"),this.fire(t,n)),o.isntIn(n,"skipCloseBind")&&t.f("button.close-button").on("click",function(){return i.closePopupFromElement(t)}),{close:function(){return i.closePopupFromElement(t)},open:function(){return i.fire(t,n)}}},unsetup:function(e){e.off("click.popupSetup")},toggleClassOnModalWrapper:function(e,t){this._dom.$modalContent.tCl(e,t)},setupOnFocus:function(e,t,n){var i=this;return e.on("focus",function(){i._skipDocumentCloseAll=!0,i.fire(t,n)}),e.on("blur.closePopup",function(){return i.closePopupFromElement(t)}),e.on("click",function(){return i._skipDocumentCloseAll=!0}),{debug:function(){return e.off("blur.closePopup"),i.fire(t,n)}}},instantiatePopup:function(e,t){var n=this,i=new s(e,t);return i.on("close",function(){return n._markAsClosed(i)|n._cleanOpen()}),i.$el.on("click",".js-close-modal",this._closeModal.bind(this)),this._popups.set(e[0],i),i},fire:function(e){var t=1<arguments.length&&void 0!==arguments[1]?arguments[1]:{},n=this._popups.get(e[0]);return this._isAboutToOpenPopup=!0,this._skipDocumentCloseAll=!!o.isIn(t,"skipDocumentCloseAll")||this._skipDocumentCloseAll,n&&n.isOpen?n.hidePopup():(this.closeAll(),n=n||this.instantiatePopup(e,t),this._openPopup(n)),this._isAboutToOpenPopup=!1,n},fireRelocate:function(e,t){var n=2<arguments.length&&void 0!==arguments[2]?arguments[2]:{},i=!1,o=this._popups.get(e[0]),r=o&&o.isOpen;return e.isChildOf(t)&&r?(o.hidePopup(),i=!0):(t.append(e),r?(o.alignDirection(),this._skipDocumentCloseAll=!0):this.fire(e,n)),i},closePopupFromElement:function(e){this._popups.get(e[0]).hidePopup(),this.closeAll()},closeAll:function(t){o.e(this._openedPopups,function(e){return!e.isSticky&&!e.isSuperModal&&(!e.isModal||t)&&e.hidePopup()}),this._cleanOpen()},_initDOMRefs:function(){var e=r(document),t=r(document.body),n=t.mF(">.js-main-wrapper>.js-global-elements>.js-modal-wrapper");this._dom={$document:e,$body:t,$modalWrapper:n,$modalContent:n.mF(".js-modal-content"),$mainWrapper:t.mF(".js-main-wrapper"),$mainContentContainer:t.mF(".js-main-content-container")}},_bindDocumentClicksToCloseAll:function(e){var t=this;this._documentIsBound^e&&(e?this._dom.$document.on("click.closeAllPopups",function(e){r(e.target).isLocalNavigationLink()||t._skipDocumentCloseAll||(t._closeModal(),t.closeAll()),t._skipDocumentCloseAll=!1}):this._dom.$document.off("click.closeAllPopups"),this._documentIsBound=e)},_cleanOpen:function(){o.isntE(this._openedPopups)&&(this._openedPopups=o.clean(this._openedPopups))},_markAsClosed:function(e){e.isSticky||this._openCount--,e.isModal&&this._toggleOverlay(!1),this._toggleBodyOverflow(!1,e),this._isAboutToOpenPopup||this._bindDocumentClicksToCloseAll(!!this._openCount),this._openedPopups[this._openedPopups.indexOf(e)]=null},_openPopup:function(e){e.isSticky||this._openCount++,e.isModal&&this._setupAndOpenModal(e),e.isSuperModal&&this._setupAndOpenSuperModal(e),this._toggleBodyOverflow(!0,e),e.showPopup(),this._openedPopups.push(e),this._bindDocumentClicksToCloseAll(!e.isSticky)},_setupAndOpenModal:function(e){this._toggleOverlay(!0),this._lastModalPopup&&this._lastModalPopup.$el.detach(),this._lastModalPopup=e,this._skipDocumentCloseAll=!0,this._dom.$modalContent.html(e.$el)},_setupAndOpenSuperModal:function(e){this._lastSuperModalPopup=e,this._lastScrollPosition=this._dom.$document.scrollTop(),this._dom.$mainWrapper.aCl(n),this._dom.$mainContentContainer.after(e.$el),this._dom.$document.scrollToTop()},_toggleBodyOverflow:function(e,t){t=t.isSuperModal;r.isMobile()&&!t&&r.bodyOverflow(e)},_toggleOverlay:function(e){this._overlayIsShown^e&&(this._dom.$modalWrapper._toggleShow(e),r.bodyOverflow(e),this._overlayIsShown=e)},_closeModal:function(){var t=this;o.e(this._openedPopups,function(e){e.isModal?(t._toggleOverlay(!1),e.hidePopup()):e.isSuperModal&&(t._dom.$mainWrapper.rCl(n),t._lastSuperModalPopup.destroy(),e.hidePopup(),t._dom.$document.scrollTop(t._lastScrollPosition),t._lastScrollPosition=null)}),this.closeAll()}})}),define("Modules/Mutators/GTMPresets",["underscore","jquery","Backbone","DataChest"],function(t,e,n,i){function o(e){return!e||t.isAr(e)&&!t.isntE(e)?a:e}function r(e){return o(i.getInstrumentsData(e,"name"))}function s(e){return o(i.getInstrumentsData(e,"type"))}var a="NA",l="GTM event to GA";return{leftPanelTogglePanel:function(e){return{event:l,GA_event_category:"Left Panel Clicks",GA_event_action:"Left Panel",GA_event_label:e,GA_event_label_value:a,GA_event_location:"Left Panel",instrument_name:a,instrument_type:a}},leftPanelToggleNotification:function(e){return{event:l,GA_event_category:"Left Panel Clicks",GA_event_action:"Notification Panel",GA_event_label:"Notification Panel ".concat(e),GA_event_label_value:a,GA_event_location:"Left Panel",instrument_name:a,instrument_type:a}},DiscussionPanelOpened:function(e,t,n){return{event:l,GA_event_category:"Community Actions",GA_event_action:"Social Panel",GA_event_label:e,GA_event_label_value:a,GA_event_location:t,instrument_name:r(n),instrument_type:s(n)}},DiscussionPanelWatchButton:function(e){return{event:l,GA_event_category:"Left Panel Clicks",GA_event_action:"Watch Button",GA_event_label:"Watch Button Clicked",GA_event_label_value:a,GA_event_location:"Left Panel",instrument_name:r(e),instrument_type:s(e)}},DiscussionPanelAddAlert:function(e){return{event:l,GA_event_category:"Left Panel Clicks",GA_event_action:"Add Alert Button",GA_event_label:"Add Alert Button Clicked",GA_event_label_value:a,GA_event_location:"Left Panel",instrument_name:r(e),instrument_type:s(e)}},InstrumentAddedToPortfolio:function(e){return{event:l,GA_event_category:"Watchlist",GA_event_action:"Watchlist Menu Actions",GA_event_label:"Watchlist - Instrument Added",GA_event_label_value:e.eventValue,GA_event_location:e.triggerSource,instrument_name:r(e.pairIds),instrument_type:s(e.pairIds)}},NewPortfolioButtonClicked:function(e){return{event:l,GA_event_category:"Watchlist",GA_event_action:"Watchlist Menu Actions",GA_event_label:"Create Watchlist Clicked",GA_event_label_value:a,GA_event_location:e.triggerSource,instrument_name:r(e.pairIds),instrument_type:s(e.pairIds)}},NewPortfolioCreated:function(e){return{event:l,GA_event_category:"Watchlist",GA_event_action:"Watchlist Menu Actions",GA_event_label:"Watchlist - Watchlist Created",GA_event_label_value:a,GA_event_location:e.triggerSource,instrument_name:r(e.pairIds),instrument_type:s(e.pairIds)}},InstrumentPageWatchButton:function(e){return{event:l,GA_event_category:"Instrument Page Clicks",GA_event_action:"Watch Button",GA_event_label:"Watch Button Clicked",GA_event_label_value:a,GA_event_location:"Instrument",instrument_name:r(e),instrument_type:s(e)}},InstrumentClickedFromLeftPanel:function(e){return{event:l,GA_event_category:"Left Panel Clicks",GA_event_action:"Left Panel",GA_event_label:"Instrument Clicked",GA_event_label_value:a,GA_event_location:"Left Panel",instrument_name:r(e),instrument_type:s(e)}},InstrumentClickedFromQuotesTable:function(e,t){return{event:l,GA_event_category:"Markets"===t?"Markets Page Clicks":"Quotes Table Page Clicks",GA_event_action:"Quotes Table",GA_event_label:"Economic"===t?"Economic Event Clicks":"Instrument Clicked",GA_event_label_value:a,GA_event_location:"Quotes Table",instrument_name:r(e),instrument_type:s(e)}},InstrumentClickedFromRightside:function(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:"Markets",t=1<arguments.length?arguments[1]:void 0;return{event:l,GA_event_category:"Right Panel Clicks",GA_event_action:"Right Panel ".concat(e),GA_event_label:"Instrument Clicked",GA_event_label_value:a,GA_event_location:"Right Panel",instrument_name:r(t),instrument_type:s(t)}},PortfolioAddSymbolClicked:function(){return{event:l,GA_event_category:"Right Panel Clicks",GA_event_action:"Right Panel Portfolio",GA_event_label:"Add Symbol Button Clicked",GA_event_label_value:a,GA_event_location:"Right Panel",instrument_name:a,instrument_type:a}},InstrumentPageAddAlert:function(e){return{event:l,GA_event_category:"Instrument Page Clicks",GA_event_action:"Add Alert ".concat(1<arguments.length&&void 0!==arguments[1]&&arguments[1]?"From Chart":"Button"),GA_event_label:"Add Alert Button Clicked",GA_event_label_value:a,GA_event_location:"Instrument",instrument_name:r(e),instrument_type:s(e)}},InstrumentTabClicked:function(e,t,n){return{event:l,GA_event_category:"Instrument Page Clicks",GA_event_action:"Navigation Tabs",GA_event_label:"Tab Clicked",GA_event_label_value:t,GA_event_location:e,instrument_name:r(n),instrument_type:s(n)}},InstrumentSubTabClicked:function(e,t,n){return{event:l,GA_event_category:"Instrument Page Clicks",GA_event_action:"Navigation Tabs",GA_event_label:"Sub Tab Clicked",GA_event_label_value:t,GA_event_location:e,instrument_name:r(n),instrument_type:s(n)}},RightsideMainTab:function(e){return{event:l,GA_event_category:"Right Panel Clicks",GA_event_action:"Right Panel Tabs",GA_event_label:"Main Tab Clicked",GA_event_label_value:e,GA_event_location:"Right Panel",instrument_name:a,instrument_type:a}},RightsideMarketsSubTab:function(e,t){return{event:l,GA_event_category:"Right Panel Clicks",GA_event_action:"Right Panel Markets",GA_event_label:t?"Sub Tab Level 2 Clicked":"Sub Tab Clicked",GA_event_label_value:e,GA_event_location:"Right Panel",instrument_name:a,instrument_type:a}},BulkActionsWatchButton:function(e,t){return{event:l,GA_event_category:"Markets"===t?"Markets Page Clicks":"Quotes Table Page Clicks",GA_event_action:"Bulk Watch Button",GA_event_label:"Watch Button Clicked",GA_event_label_value:a,GA_event_location:"Quotes Table",instrument_name:r(e),instrument_type:s(e)}},BulkActionsAddAlert:function(e,t){return{event:l,GA_event_category:"Markets"===t?"Markets Page Clicks":"Quotes Table Page Clicks",GA_event_action:"Bulk Add Alert Button",GA_event_label:"Add Alert Button Clicked",GA_event_label_value:a,GA_event_location:"Quotes Table",instrument_name:r(e),instrument_type:s(e)}},QuotesTableMainNav:function(e){return{event:l,GA_event_category:"Quotes Table Page Clicks",GA_event_action:"Navigation Tabs",GA_event_label:"Tab Clicked",GA_event_label_value:e,GA_event_location:"Quotes Table",instrument_name:a,instrument_type:a}},QuotesTableViewNav:function(e){return{event:l,GA_event_category:"Quotes Table Page Clicks",GA_event_action:"Table Views Tabs",GA_event_label:"Tab Clicked",GA_event_label_value:e,GA_event_location:"Quotes Table",instrument_name:a,instrument_type:a}},CreateCustomView:function(){return{event:l,GA_event_category:"Custom View",GA_event_action:"Custom View Popup",GA_event_label:"Custom View Created",GA_event_label_value:a,GA_event_location:"Quotes Table",instrument_name:a,instrument_type:a}},CreateCustomViewPopup:function(){return{event:l,GA_event_category:"Custom View",GA_event_action:"Custom View Popup",GA_event_label:"Custom View Popup Presented",GA_event_label_value:a,GA_event_location:"Quotes Table",instrument_name:a,instrument_type:a}},CreateNewAlert:function(e){return{event:l,GA_event_category:"Alerts",GA_event_action:"Alerts Popup",GA_event_label:"Create New Alert Click",GA_event_label_value:"Price Alert",GA_event_location:e.triggerSource,instrument_name:r(e.pairIds),instrument_type:s(e.pairIds)}},CountryDropdownCheckboxSelected:function(e){var t=1<arguments.length&&void 0!==arguments[1]?arguments[1]:a;return{event:l,GA_event_category:"Quotes Table Page Clicks",GA_event_action:"Country Selection Popup",GA_event_label:"".concat(e," Country"),GA_event_label_value:t,GA_event_location:"Quotes Table",instrument_name:a,instrument_type:a}},ShowMoreTableEquities:function(){return{event:l,GA_event_category:"Markets Page Clicks",GA_event_action:"Quotes Table",GA_event_label:"Show More Button Clicked",GA_event_label_value:a,GA_event_location:"Quotes Table",instrument_name:a,instrument_type:a}},exportToCalendar:function(e){return{event:l,GA_event_category:"calendar page clicks",GA_event_action:"export to calendar",GA_event_label:"export chosen",GA_event_label_value:e.eventValue,GA_event_location:e.triggerSource,instrument_name:a,instrument_type:a}}}}),define("Modules/Mutators/LateMutator",["underscore","jquery","Backbone","DataChest","Router","PopupsManager","./Mutator","./GTMPresets"],function(s,n,i,e,a,l,u,c){_defineProperty(t={firePopup:function(e,t){},setupPopup:function(e,t,n){},unsetupPopup:function(e){}},"setupPopup",function(e,t,n,i){}),_defineProperty(t,"setupPopupOnFocus",function(e,t,n){}),_defineProperty(t,"setupPopupOnFocus",function(e,t,n,i){}),_defineProperty(t,"instantiatePopup",function(e,t){}),_defineProperty(t,"closeAllPopups",function(e){}),_defineProperty(t,"closePopupFromElement",function(e){}),_defineProperty(t,"outerNavigate",function(e,t){});var t,d=e.isLogged();return i.EModel.extend({initialize:function(){function e(o){return function(e,t,n,i){return s.isSt(t)&&s.isSt(n)?r[o](e.mF(t),e.mF(n),i):r[o](e,t,n)}}function o(e){return n.dispatchGTM(e)}var r=new l,t=[["firePopup",r.fire.bind(r)],["fireRelocate",r.fireRelocate.bind(r)],["setupPopup",e("setup")],["unsetupPopup",function(e){return r.unsetup(e)}],["setupPopupOnFocus",e("setupOnFocus")],["instantiatePopup",r.instantiatePopup.bind(r)],["closeAllPopups",r.closeAll.bind(r)],["toggleClassOnModalWrapper",r.toggleClassOnModalWrapper.bind(r)],["closePopupFromElement",r.closePopupFromElement.bind(r)],["GTM",function(e){for(var t=arguments.length,n=new Array(1<t?t-1:0),i=1;i<t;i++)n[i-1]=arguments[i];o(c[e].apply(c,n))}],["GTMObj",o],["isLoggedIn",function(){return d}],["navigate",a.navigateLocally.bind(a)],["outerNavigate",function(e,t){t?window.open(e,"_blank"):window.location=e}]];u.mutate(i.EModel.prototype,t),u.mutate(i.EView.prototype,t)}})}),define("Modules/Ads/BillboardView",["underscore","jquery","Backbone","Displayable"],function(e,p,t,i){return new(i.extend({initialize:function(){var n=this;i.prototype.initialize.call(this,document.body),window.hfuhfurjshdkud=function(e,t){return n.initializeDFPs(t)}},render:function(){return i.prototype.render.call(this),this.$el},initializeDFPs:function(e){var i=this.$el.f("#theBigX"),r=window.fijoerfryhskjdy||{},e=_slicedToArray(e,7),o=e[0],s=e[1],a=e[2],l=e[3],u=e[4],c=e[5],d=e[6];function t(){var e,t,n=function(e){for(var t=e+"=",n=document.cookie.split(";"),i=0;i<n.length;i++){for(var o=n[i];" "==o.charAt(0);)o=o.substring(1);if(0==o.indexOf(t))return o.substring(t.length,o.length)}return""}("billboardCounter_"+c)||0;1680<=window.outerWidth?(d&&0==n?(p("#"+o).show(),p("#"+s).hide(),i.show(),h(l,[[970,250],[970,90],[728,90]],o,a)):h(u,[[970,250],[970,90],[728,90]],s,a),n="billboardCounter_"+c,e=1,document.cookie=n+"="+e+";;path="+(t||"/")):h(u,[[970,250],[970,90],[728,90]],s,a)}function h(e,t,n,i){var o=window.googletag;r[n]?o.pubads().refresh([r[n]]):o.cmd.push(function(){r[n]=o.defineSlot(e,t,n).setTargeting("ad_group",i).addService(o.pubads()),o.enableServices(),o.cmd.push(function(){o.display(n)}),window.fijoerfryhskjdy=r})}i.on("click",function(){i.fadeOut("fast"),h(u,[[970,250],[970,90],[728,90]],s,a),p("#"+o).hide(),window.googletag.destroySlots([window.fijoerfryhskjdy[o]]),delete window.fijoerfryhskjdy[o],p("#"+s).show(),i.hide()}),window.googletag=window.googletag||{},window.googletag.cmd=window.googletag.cmd||[],"complete"!==document.readyState?window.onload=t:t()}}))}),define("Modules/Dropdown/DateDropdownView",["underscore","jquery","Backbone","Displayable","Moment","DataChest","./DropdownView"],function(l,u,e,t,c,n,i){return i.extend({_today:null,_selectedValue:null,_currentStep:null,_currentStepTwoValues:null,_$currentDayPaddings:null,_$currentMonthItems:null,_$currentDayItems:null,_$currentYearItems:null,_currentlySelected:null,_currentlyPicked:null,_currentFirstYear:null,_currentlySelectingFrom:null,_markupScheme:{display:".js-dropdown-display",step1:".js-date-step-1",step2:".js-date-step-2",from:".js-date-from",to:".js-date-to",fromButton:".js-date-from-button",toButton:".js-date-to-button",fromLabel:".js-date-from-label",toLabel:".js-date-to-label",dateLabel:".js-date-date-label",yearsWrapper:".js-date-years",yearItem:".js-date-year-item",monthsWrapper:".js-date-months",monthItem:".js-date-month-item",daysWrapper:".js-date-days",dayItem:".js-date-day-item",popup:".js-dropdown-popup",mainApplyButton:".js-apply-button",prevYearButton:".js-date-prev-year",nextYearButton:".js-date-next-year",yearRangeFrom:".js-date-year-range-from",yearRangeTo:".js-date-year-range-to",predefinedOptionsList:".js-date-predefined-wrapper"},events:{"@click .js-date-predefined":"_selectPredefined","@click .js-apply-button":"_applyAnyStep","@click .js-clear-button":"_resetDate","@input .js-date-from,.js-date-to":"_applyTyping"},initialize:function(e){var t=1<arguments.length&&void 0!==arguments[1]?arguments[1]:{};i.prototype.initialize.call(this,e,t),this._today=c(),this.loadSettings(t)},render:function(){return t.prototype.render.call(this),this.setupPopup(this._dom.display,this._dom.popup,{onClose:this._resetDate.bind(this)}),this._currentStep=0,this._initSelectedValue(),this._bindButtonEvents(),this._dom.yearItem.remove(),this._populateMonths(),this._populateDays(),this.$el},getValues:function(){return{from:this._currentlySelected.from_timestamp,to:this._currentlySelected.to_timestamp,timeFrame:this._currentlySelected.time_frame}},setValue:function(e,t,n){this._updateDisplayText(e,t),n||this.trigger("dateChangeEv")},setPredefined:function(e,t,n){var i=c.timestampToClientTimezone(e,this._settings.skipOffset),o=c.timestampToClientTimezone(t,this._settings.skipOffset);this._setCurrentlyPicked(i,o,e,t,n),this._currentStep=0,this._dom.from.val(i).data("value",c.formattedToUnixSeconds(i)),this._dom.to.val(o).data("value",c.formattedToUnixSeconds(o)),this._markSelectedPredefined()},_markSelectedPredefined:function(){var t=this._dom.from.data("value"),n=this._dom.to.data("value");l.e$(this._dom.predefinedOptionsList,function(e){e.unselect(),c.compareTimesRoundedByTimeframe(e.f(".js-date-predefined").data("from-date"),t,"86400")&&c.compareTimesRoundedByTimeframe(e.f(".js-date-predefined").data("to-date"),n,"86400")&&e.setSelected()})},_updateDisplayText:function(e,t){this.isSettingOn("displayDateOnButton")&&this._dom.display.textT("".concat(e," - ").concat(t))},_setCurrentlyPicked:function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];this._setCurrentDates.apply(this,[!0].concat(t))},_setCurrentlySelected:function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];this._setCurrentDates.apply(this,[!1].concat(t))},_setCurrentDates:function(e,t,n,i,o,r){this[e?"_currentlyPicked":"_currentlySelected"]={from_formatted:t,to_formatted:n,from_timestamp:i,to_timestamp:o,time_frame:r}},_setCurrentFromDataValue:function(e){this._setCurrentDates(e,c.unix(this._dom.from.data("value")).format("MM/DD/YYYY"),c.unix(this._dom.to.data("value")).format("MM/DD/YYYY"),this._dom.from.data("value"),this._dom.to.data("value"))},_initSelectedValue:function(){this._dom.from.val(c.timestampToClientTimezone(this._dom.from.data("value"),this._settings.skipOffset)),this._dom.to.val(c.timestampToClientTimezone(this._dom.to.data("value"),this._settings.skipOffset)),this._updateDisplayText(this._dom.from.val(),this._dom.to.val()),this._setCurrentFromDataValue(!1),this._setCurrentlyPicked(this._currentlySelected.from_formatted,this._currentlySelected.to_formatted,this._currentlySelected.from_timestamp,this._currentlySelected.to_timestamp),this._markSelectedPredefined()},_applyTyping:function(e){var t=this._dom.from.val(),n=this._dom.to.val(),t=c.formattedToMoment(t),n=c.formattedToMoment(n);t.isValid()&&n.isValid()&&t<=n?(this._dom.from.data("value",t.unix()),this._dom.to.data("value",n.unix()),this._setCurrentFromDataValue(!0),this._dom.mainApplyButton.enable(),this._markSelectedPredefined()):(this._dom.mainApplyButton.disable(),this._dom.predefinedOptionsList.unselect())},_bindButtonEvents:function(){this._dom.fromButton.on("click",this._startSelectionMode.bind(this,!0)),this._dom.toButton.on("click",this._startSelectionMode.bind(this,!1)),this._dom.prevYearButton.on("click",this._browseYears.bind(this,!1)),this._dom.nextYearButton.on("click",this._browseYears.bind(this,!0))},_applyAnyStep:function(){var e;this._currentStep?(e=this._getCurrentlyPickedDate(),this._currentStep=0,this._dom.step1.showEl(),this._dom.step2.hideEl(),(this._currentlySelectingFrom?(this._setCurrentlyPicked(e,this._currentlyPicked.to_formatted,c.formattedToUnixSeconds(e),this._currentlyPicked.to_timestamp),this._dom.from):(this._setCurrentlyPicked(this._currentlyPicked.from_formatted,e,this._currentlyPicked.from_timestamp,c.formattedToUnixSeconds(e)),this._dom.to)).val(e).data("value",c.formattedToUnixSeconds(e)),this._markSelectedPredefined()):(this._setCurrentlySelected(this._currentlyPicked.from_formatted,this._currentlyPicked.to_formatted,this._currentlyPicked.from_timestamp,this._currentlyPicked.to_timestamp,this._currentlyPicked.time_frame),this.closePopupFromElement(this._dom.popup),this.setValue(this._currentlySelected.from_formatted,this._currentlySelected.to_formatted))},_browseYears:function(e){e=e?this._currentFirstYear+8:this._currentFirstYear-1;this._populateYears(e),this._updateStepTwoLabel(),this._updateDays()},_getCurrentlyPickedDate_m:function(){return c().year(this._currentStepTwoValues.year).month(this._currentStepTwoValues.month).date(this._currentStepTwoValues.day)},_getCurrentlyPickedDate:function(){return this._getCurrentlyPickedDate_m().toLocal()},_updateStepTwoLabel:function(){var e=this._getCurrentlyPickedDate_m();this._dom.dateLabel.textT(e.toLocal()).attr("datetime",e.format("YYYY-MM-DD"))},_setMinMaxDates:function(e){e?(this._maxDate=c.unix(this._dom.to.data("value")),this._minDate=null):(this._minDate=c.unix(this._dom.from.data("value")),this._maxDate=null)},_startSelectionMode:function(e){var t=(e?this._dom.from:this._dom.to).data("value"),t=c.unix(t);this._currentStepTwoValues={year:t.year(),month:t.month(),day:t.date()},this._currentStep=1,this._currentlySelectingFrom=e,this._dom.fromLabel.toggleEl(e),this._dom.toLabel.toggleEl(!e),this._setMinMaxDates(e),this._populateYears(this._currentStepTwoValues.year),this._selectMonth(this._currentStepTwoValues.month),this._selectDay(this._currentStepTwoValues.day,e),this._updateStepTwoLabel(),this._dom.step1.hideEl(),this._dom.step2.showEl()},_selectPredefined:function(e){e=e.currentTarget,e=u(e);this.setPredefined(e.data("from-date"),e.data("to-date"),e.data("time-frame"))},_populateDays:function(){var n=this,i=u();l.repeat(31,function(e){var e=""+(e+1),t=n._dom.dayItem.clone();t.mF(".js-date-day-item-label").textT(e).attr("datetime",e),t.mF(".js-date-day-item-button").data("value",e).on("click",n._selectDateComponent.bind(n,0,e)),i.addToThis(t)}),this._$currentDayItems=i,this._dom.daysWrapper.html(i)},_populateMonths:function(){var i=this,o=u();l.repeat(12,function(e){var t=c().month(e).format("MMM"),n=i._dom.monthItem.clone();n.mF(".js-date-month-item-label").textT(t).attr("datetime",t),n.mF(".js-date-month-item-button").data("value",""+e).on("click",i._selectDateComponent.bind(i,1,e)),o.addToThis(n)}),this._$currentMonthItems=o,this._dom.monthsWrapper.html(o)},_populateYears:function(n){var i=this,e=this._today.year(),o=!!this._maxDate,r=(this._maxDate||this._minDate).year(),e=e+8*Math.ceil((n-e)/8),s=e-7,a=u();this._dom.yearRangeFrom.textT(s),this._dom.yearRangeTo.textT(e),this._currentFirstYear=s,l.repeat(8,function(e){var e=""+(s+e),t=i._dom.yearItem.clone();t.mF(".js-date-year-item-label").textT(e).attr("datetime",e),t.mF(".js-date-year-item-button").data("value",e).on("click",i._selectDateComponent.bind(i,2,+e)).tCl("selected",e.is(n)).disable(o?r<+e:+e<r),a.addToThis(t)}),this._dom.prevYearButton.disable(!o&&s<=r),this._dom.nextYearButton.disable(o&&r<=e),this._$currentYearItems=a,this._currentStepTwoValues.year=n,this._dom.yearsWrapper.html(a),this._updateMonths()},_selectDateComponent:function(e,t){[this._selectDay,this._selectMonth,this._selectYear][e].call(this,t),this._updateStepTwoLabel()},_selectDay:function(t){this._currentStepTwoValues.day=+t,l.e$(this._$currentDayItems,function(e){e=e.mF(".js-date-day-item-button");e.toggleSelected(e.data("value").is(t))})},_selectMonth:function(t){this._currentStepTwoValues.month=t,l.e$(this._$currentMonthItems,function(e){e=e.mF(".js-date-month-item-button");e.toggleSelected(e.data("value").is(t))}),this._updateDays(this._currentlySelectingFrom)},_selectYear:function(t){this._currentStepTwoValues.year=t,l.e$(this._$currentYearItems,function(e){e=e.mF(".js-date-year-item-button");e.toggleSelected(e.data("value").is(t))}),this._updateMonths(this._currentlySelectingFrom),this._updateDays(this._currentlySelectingFrom)},_updateMonths:function(e){var t=c.getYearNumber(),n=c.getMonthNumber();this._$currentMonthItems.mF(".js-date-month-item-button").enable(),e||this._currentStepTwoValues.year!==t||(this._currentStepTwoValues.month>n&&this._selectMonth(n),this.isSettingOff("showFutureDate")&&this._$currentMonthItems.slice(n+1).f(".js-date-month-item-button").disable()),this._currentStepTwoValues.year===(this._maxDate||this._minDate).year()&&(this._maxDate?(this._$currentMonthItems.slice(this._maxDate.month()+1).f(".js-date-month-item-button").disable(),this._currentStepTwoValues.month>this._maxDate.month()&&this._selectMonth(this._maxDate.month())):(this._$currentMonthItems.slice(0,this._minDate.month()).f(".js-date-month-item-button").disable(),this._currentStepTwoValues.month<this._minDate.month()&&this._selectMonth(this._minDate.month())))},_updateDays:function(e){var t=this,n=c().date(1).year(this._currentStepTwoValues.year).month(this._currentStepTwoValues.month),i=n.day(),n=n.daysInMonth(),o=u(),r=c.getDayNumber(),s=c.getMonthNumber(),a=c.getYearNumber();l.repeat(i,function(){return o.addToThis(t._dom.dayItem.clone())}),this._$currentDayPaddings&&this._$currentDayPaddings.remove(),this._$currentDayPaddings=o.empty(),this._dom.daysWrapper.prepend(o),this._$currentDayItems.showEl().slice(n).hideEl(),this._$currentDayItems.mF(".js-date-day-item-button").enable(),e||this._currentStepTwoValues.year!==a||this._currentStepTwoValues.month!==s||(this._currentStepTwoValues.day>r&&this._selectDay(r),this.isSettingOff("showFutureDate")&&this._$currentDayItems.slice(r).f(".js-date-day-item-button").disable()),this._currentStepTwoValues.year===(this._maxDate||this._minDate).year()&&this._currentStepTwoValues.month===(this._maxDate||this._minDate).month()&&(this._maxDate?(this._$currentDayItems.slice(this._maxDate.date()).f(".js-date-day-item-button").disable(),this._currentStepTwoValues.day>this._maxDate.date()&&this._selectDay(this._maxDate.date())):(this._$currentDayItems.slice(0,this._minDate.date()-1).f(".js-date-day-item-button").disable(),this._currentStepTwoValues.day<this._minDate.date()&&this._selectDay(this._minDate.date())))},_resetDate:function(){this._dom.step1.showEl(),this._dom.step2.hideEl(),this._dom.mainApplyButton.enable(),this._dom.from.val(this._currentlySelected.from_formatted).data("value",this._currentlySelected.from_timestamp),this._dom.to.val(this._currentlySelected.to_formatted).data("value",this._currentlySelected.to_timestamp),this._markSelectedPredefined()}})}),define("Modules/ForecastBox/ForecastBoxView",["underscore","jquery","Backbone","Displayable"],function(o,n,e,i){var r=[-78,-44,0,44,78],s="forecast-is-selected";n(document.body);return i.extend({_labelTranslations:null,_boxData:null,_currentTab:null,_closeSettingsPopup:null,_currentNeedleDegreeIndex:null,_markupScheme:{mainTabs:".js-forecast-box-tab",needle:".js-forecast-box-needle",weightRanges:".js-forecast-box-settings-range",weightLabels:".js-forecast-box-settings-range-label",mainLabel:".js-forecast-box-label",labels:".js-forecast-box-minor-label",exploreLink:".js-forecast-box-explore",settingsPopup:".js-forecast-box-settings-popup"},events:{"@click .js-forecast-box-settings-apply":"_modifyWeights","@click .js-forecast-box-settings-clear":"_resetWeights"},initialize:function(e,t,n){i.prototype.initialize.call(this,e),this._boxData=t,this._labelTranslations=n},render:function(){var t=this;return i.prototype.render.call(this),this._closeSettingsPopup=this.setupPopup(this.$el,".js-forecast-box-settings",".js-forecast-box-settings-popup",{openLeftwards:!0}).close,this.setupTabs(this._dom.mainTabs,null,{customHandlerE:function(e){e=e.currentTarget;return t._loadBoxTab(n(e).data("tab-name"))}}),this._loadBoxTab(o.findKey(this._boxData,function(e){return e.selected})),this._bindRanges(),this.$el},_loadBoxTab:function(e){var t=this._boxData[e].exploreLink;this._currentTab=e,this._dom.exploreLink.toggleVis(t).mF("a").href(t),this._updateNeedle()},_updateNeedle:function(){this._moveNeedleToConclusion(this._currentTab.is("summary")?this._calculateSummaryConclusion():this._boxData[this._currentTab].conclusion)},_calculateSummaryConclusion:function(){var e=o.reduce(o.omit(this._boxData,"summary"),function(e,t){return e+t.conclusion*t.weight},0);return e<=-3?-2:e<-1?-1:e<=1?0:e<3?1:2},_moveNeedleToConclusion:function(t){var e=r[t+2];this._dom.mainLabel.text(this._labelTranslations.conclusions[t]),this._dom.labels.rCl(s),o.filter$(this._dom.labels,function(e){return e.data("value")===t}).aCl(s),this._currentNeedleDegreeIndex===e?this._wiggleNeedle():(this._currentNeedleDegreeIndex=e,this._moveNeedleToDegree(e))},_wiggleNeedle:function(){var n=this,e=this._currentNeedleDegreeIndex,t=e-20,i=e+20;o.e([t,i,t,i,e],function(e,t){return setTimeout(n._moveNeedleToDegree.bind(n,e),64*t)})},_moveNeedleToDegree:function(e){this._dom.needle.css("transform","translateY(-4px) rotate(".concat(e,"deg)"))},_bindRanges:function(){var t=this;this._weightLabels={},o.e$(this._dom.weightLabels,function(e){return t._weightLabels[e.data("tab")]=e}),this._dom.weightRanges.on("input",function(e){e=e.currentTarget;return t._setRangeToValue(e,+e.value)})},_setRangeToValue:function(e,t){e.style.setProperty("--val",t),this._weightLabels[n(e).data("tab")].textT(this._labelTranslations.weights[t])},_modifyWeights:function(){var t=this;o.e$(this._dom.weightRanges,function(e){return t._boxData[e.data("tab")].weight=e.numVal()}),this._closeSettingsPopup(),this._updateNeedle()},_resetWeights:function(){var t=this;o.e(this._dom.weightRanges.val(1),function(e){return t._setRangeToValue(e,1)})}})}),define("Modules/ForecastBox/ForecastBox",["underscore","jquery","Backbone","DataChest","./ForecastBoxView"],function(e,t,n,i,o){return n.EModel.extend({initialize:function(e){this._view=new o(e,i.get("forecastData"),i.get("forecastBoxLabels"))},render:function(){this._view.render()}})}),define("Modules/HTabs/HTabsView",["underscore","jquery","Backbone","Displayable"],function(t,d,e,n){return new(n.extend({initialize:function(){},setup:function(n,i){function o(e,t){e!==r&&(l||(n.eq(r).unselect(),n.eq(e).setSelected()),!a&&(s||u||c)||(i.eq(r)._hide(),i.eq(e)._show()),u&&u(e),c&&c(t),r=e)}var r,e=2<arguments.length&&void 0!==arguments[2]?arguments[2]:{},s=e.skipHideShow,a=e.forceHideShow,l=e.skipClasses,u=e.customHandler,c=e.customHandlerE;return t.e(n,function(e,t){e=d(e);e.isSelected()&&(r=t),e.on("click",function(e){return o(t,e)})}),{switchToTab:o,switchToTabSilent:function(e,t){n.eq(r).unselect(),(t||n.eq(e)).setSelected(),r=e},addTab:function(t){n.addToThis(t),t.on("click",function(e){return o(n.index(t),e)})}}}}))}),define("Modules/Mutators/DisplayableMutator",["underscore","jquery","Backbone","./Mutator","Displayable","Socket","EventBus","Http","Toolset","InstrumentChart","DataChest","Modules/Dropdown/DropdownView","Modules/Dropdown/DateDropdownView","Modules/GlobalSearch/GlobalSearch","Modules/ForecastBox/ForecastBox","Modules/HTabs/HTabsView"],function(i,o,e,t,n,r,s,a,l,u,c,d,h,p,f,m){function _(){g('<span class="text">'.concat(c.getTranslation("INST_ACTION_REQUIRES_LOGGIN"),'</span>\n\t\t\t<a class="common-button js-popup-login-link u-margin-start-auto" href=\'').concat(o.getLoginURL(),"'>").concat(c.getTranslation("INST_LOGIN"),"</a>"),5e3)}function g(e,t){function n(){return i.remove()}var i=S.clone(),o=i.mF(".js-system-alert-label");return o.html(e),i.mF(".js-system-alerts-close").on("click",n),w.append(i),setTimeout(n,t||3600),{closeAlert:n,$label:o}}var v=lcl.makeCustom("DispMu"),b=o(document.body),y=c.isLogged(),b=b.mF(">.js-main-wrapper>.js-global-elements"),w=b.mF(">.js-system-alerts"),S=w.mF(".js-system-alert-clone").remove(),T=new p(b.mF(">.js-global-instrument-search").remove().showEl());s.on("clientNavigationStartEv",function(){}),s.on("clientNavigationEndEv",function(e){v("Client Components Initialization done in ".concat(Date.now()-e,"ms"))}),w.showEl(),T.render(),t.mutate(n.prototype,[["subscribeTableToSocket",function(e,t){r.scanTables(e,t)}],["scanDOMForSocket",function(e){r.scanDOM(e)}],["setupInstrumentSearch",function(e,t,n){T.bindGlobalSearch(e,t,n)}],["setupForecastBox",function(e,t){e=new f(e,t);return e.render(),e}],["setupDropdown",function(e,t){e=new d(e,t);return e.render(),e}],["setupTabs",function(e,t,n){return m.setup(e,t,n)}],["setupDateInput",function(e,t){e=new h(e,t);return e.render(),e}],["setupAccordion",function(e,t){e.on("click",function(){o(this).toggleClass("open"),t&&t(o(this).hCl("open"))})}],["setupAccordions",function(t,n){t.on("click",function(){var e=o(this).hCl("open");t.rCl("open"),o(this).tCl("open",!e),i.tryRun(n)})}],["popSystemAlert",g],["setupChart",function(e,t){t=new u({jsonHash:t,period:2<arguments.length&&void 0!==arguments[2]?arguments[2]:"1day",renderImage:3<arguments.length?arguments[3]:void 0});return t.render(e),t}],["loginOr",function(e){return function(){return y?e.apply(void 0,arguments):(_(),!1)}}],["loginOrImmediate",function(e){this.loginOr(e)()}],["popLoginSystemAlert",function(){_()}],["abortCall",function(e){a.abortCall(e)}]])}),define("Modules/Mutators/MomentMutator",["underscore","jquery","Backbone","./Mutator","DataChest","Moment"],function(t,e,n,i,o,r){function s(e){return r(e,f,!0)}function a(e){return+e-60*e.utcOffset()}function l(e){return+e+60*e.utcOffset()}var u,c,d,h,p={60:function(e){return e.seconds(0).millisecond(0)},300:(h=function(e){return e.minutes(t.roundBy(e.minutes(),5)).seconds(0).millisecond(0)},b.toString=function(){return h.toString()},b),900:(d=function(e){return e.minutes(t.roundBy(e.minutes(),15)).seconds(0).millisecond(0)},v.toString=function(){return d.toString()},v),1800:(c=function(e){return e.minutes(t.roundBy(e.minutes(),30)).seconds(0).millisecond(0)},g.toString=function(){return c.toString()},g),3600:function(e){return e.minutes(0).seconds(0).millisecond(0)},18e3:(u=function(e){return e.hours(t.roundBy(e.hours(),5)).minutes(0).seconds(0).millisecond(0)},_.toString=function(){return u.toString()},_),86400:function(e){return e.hours(0).minutes(0).seconds(0).millisecond(0)},week:function(e){return e.startOf("week")},month:function(e){return e.startOf("month")}},o=o.get("editionTimeSettings"),f=o.dateFormat||"MM/DD/YYYY",m=o.timezoneOffset;function _(e){return u.apply(this,arguments)}function g(e){return c.apply(this,arguments)}function v(e){return d.apply(this,arguments)}function b(e){return h.apply(this,arguments)}i.mutate(r,[["formattedToMoment",s],["localMomentToUTCUnix",a],["localFormattedToUTCUnix",function(e){return a(s(e))}],["timestampToClientTimezone",function(e,t){return r.unix(t?e:e-m).format(f)}],["formattedToUnixSeconds",function(e){return r.formattedToMoment(e).unix()}],["utcMomentToLocalUnix",l],["utcUnixToLocalFormatted",function(e){return r(l(r(e))).format(f)}],["utcToLocal",function(e){return r(1e3*(e+m)).utc()}],["isValidDate",function(e){return r(e,f,!0).isValid()}],["floorUnixToNearestTimeframe",function(e,t){return+p[t](r(e))}],["compareTimesRoundedByTimeframe",function(e,t,n){return r.floorUnixToNearestTimeframe(1e3*e,n)===r.floorUnixToNearestTimeframe(1e3*t,n)}],["getDayNumber",function(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:new Date;return r(e).date()}],["getMonthNumber",function(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:new Date;return r(e).month()}],["getYearNumber",function(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:new Date;return r(e).year()}],["isInNextHour",function(e){return e-r.now()<36e5}]],"Moment"),i.mutate(r.prototype,[["isToday",function(e){return r(e).isSame(r(),"day")}],["toLocal",function(){return this.format(f)}],["toUTCUnix",function(){return+this-60*this.utcOffset()}],["toLocalUnix",function(){return+this+60*this.utcOffset()}],["hourOrDateFormat",function(){return this.format(this.isToday()?"HH:mm:ss":"DD/MM")}]],"Moment's Prototype")}),define("Modules/PageState/PageState",["underscore","jquery","Backbone"],function(e,t,n){return new(n.EModel.extend({isPageInFocus:null,initialize:function(e,t){this.window=e,this.document=t,this._analyse()},_analyse:function(){var e=this;this._setPageInFocus(!0),t(window).blur(function(){return e._setPageInFocus(!1)}),t(window).focus(function(){return e._setPageInFocus(!0)})},_setPageInFocus:function(e){this.isPageInFocus=e}}))}),function(e){"function"==typeof define&&define.amd?define("External/Sortable",e):"undefined"!=typeof module&&void 0!==module.exports?module.exports=e():window.Sortable=e()}(function(){var k,x,M,h,P,A,m,E,J,ee,D,i,te,I,j,F,s,ne,a,l,c,d,f,O,ie,L,oe,B,re,se,ae,N,r,R,V,$,p,z,t,n,_,U,g,v,b,y,w,le,S,W,T,C,ue,G,ce,de,he,pe,fe,me,_e,ge,e,ve;return"undefined"!=typeof window&&window.document?(ne=s=F=!(j=[]),re=B=!(a=[]),r=/\s+/g,R="Sortable"+(new Date).getTime(),V=window,$=V.document,p=V.parseInt,z=V.setTimeout,t=V.jQuery||V.Zepto,n=V.Polymer,_={capture:!1,passive:!1},U=!!navigator.userAgent.match(/(?:Trident.*rv[ :]?11\.|msie|iemobile)/i),g=!!navigator.userAgent.match(/Edge/i),v=!(!navigator.userAgent.match(/safari/i)||navigator.userAgent.match(/chrome/i)||navigator.userAgent.match(/android/i)),b=g||U?"cssFloat":"float",y="draggable"in $.createElement("div"),w=!U&&((e=$.createElement("x")).style.cssText="pointer-events:auto","auto"===e.style.pointerEvents),S=le=!1,W=Math.abs,T=Math.min,C=[],ue=function(e,t){var n,i=Q(e),o=p(i.width)-p(i.paddingLeft)-p(i.paddingRight)-p(i.borderLeftWidth)-p(i.borderRightWidth),r=Ce(e,0,t),e=Ce(e,1,t),t=r&&Q(r),s=e&&Q(e),a=t&&p(t.marginLeft)+p(t.marginRight)+Z(r).width,l=s&&p(s.marginLeft)+p(s.marginRight)+Z(e).width;return"flex"===i.display?"column"===i.flexDirection||"column-reverse"===i.flexDirection?"vertical":"horizontal":"grid"===i.display?i.gridTemplateColumns.split(" ").length<=1?"vertical":"horizontal":r&&"none"!==t.float?(n="left"===t.float?"left":"right",!e||"both"!==s.clear&&s.clear!==n?"horizontal":"vertical"):r&&("block"===t.display||"flex"===t.display||"table"===t.display||"grid"===t.display||o<=a&&"none"===i[b]||e&&"none"===i[b]&&o<a+l)?"vertical":"horizontal"},G=function(e,t){if(e&&e.getBoundingClientRect){var n=e,i=!1;do{if(n.clientWidth<n.scrollWidth||n.clientHeight<n.scrollHeight){var o=Q(n);if(n.clientWidth<n.scrollWidth&&("auto"==o.overflowX||"scroll"==o.overflowX)||n.clientHeight<n.scrollHeight&&("auto"==o.overflowY||"scroll"==o.overflowY)){if(!n||!n.getBoundingClientRect||n===$.body)return V;if(i||t)return n;i=!0}}}while(n=n.parentNode)}return V},ce=Me(function(n,e,t,i){if(e.scroll){var o=t?t[R]:window,r=e.scrollSensitivity,s=e.scrollSpeed,a=n.clientX,l=n.clientY,u=(window.innerWidth,window.innerHeight,!1),c=(J!==t&&(de(),E=e.scroll,ee=e.scrollFn,!0===E&&(E=G(t,!0),J=E)),0),d=E;do{var h,p,f,m,_,g,v=d,b=Z(v),y=b.top,w=b.bottom,S=b.left,T=b.right,C=b.width,b=b.height,k=(v!==V?(h=v.scrollWidth,p=v.scrollHeight,f=Q(v),m=C<h&&("auto"===f.overflowX||"scroll"===f.overflowX),_=b<p&&("auto"===f.overflowY||"scroll"===f.overflowY),g=v.scrollLeft,v):(h=$.documentElement.scrollWidth,p=$.documentElement.scrollHeight,f=Q($.documentElement),m=C<h&&("auto"===f.overflowX||"scroll"===f.overflowX||"visible"===f.overflowX),_=b<p&&("auto"===f.overflowY||"scroll"===f.overflowY||"visible"===f.overflowY),g=$.documentElement.scrollLeft,$.documentElement)).scrollTop,T=m&&(W(T-a)<=r&&g+C<h)-(W(S-a)<=r&&!!g),C=_&&(W(w-l)<=r&&k+b<p)-(W(y-l)<=r&&!!k);if(!j[c])for(var x=0;x<=c;x++)j[x]||(j[x]={});j[c].vx==T&&j[c].vy==C&&j[c].el===v||(j[c].el=v,j[c].vx=T,j[c].vy=C,clearInterval(j[c].pid),!v||0==T&&0==C||(u=!0,j[c].pid=setInterval(function(){i&&0===this.layer&&Y.active._emulateDragOver(!0);var e=j[this.layer].vy?j[this.layer].vy*s:0,t=j[this.layer].vx?j[this.layer].vx*s:0;"function"==typeof ee&&"continue"!==ee.call(o,t,e,n,O,j[this.layer].el)||(j[this.layer].el===V?V.scrollTo(V.pageXOffset+t,V.pageYOffset+e):(j[this.layer].el.scrollTop+=e,j[this.layer].el.scrollLeft+=t))}.bind({layer:c}),24))),c++}while(e.bubbleScroll&&d!==V&&(d=G(d,!1)));F=u}},30),de=function(){j.forEach(function(e){clearInterval(e.pid)}),j=[]},he=function(e){function a(r,s){return function(e,t,n,i){var o=e.options.group.name&&t.options.group.name&&e.options.group.name===t.options.group.name;return!(null!=r||!s&&!o)||null!=r&&!1!==r&&(s&&"clone"===r?r:"function"==typeof r?a(r(e,t,n,i),s)(e,t,n,i):(o=(s?e:t).options.group.name,!0===r||"string"==typeof r&&r===o||r.join&&-1<r.indexOf(o)))}}var t={},n=e.group;n&&"object"==_typeof(n)||(n={name:n}),t.name=n.name,t.checkPull=a(n.pull,!0),t.checkPut=a(n.put),t.revertClone=n.revertClone,e.group=t},pe=function(e){k&&k.parentNode&&k.parentNode[R]&&k.parentNode[R]._computeIsAligned(e)},fe=function(e,t){for(var n=t;!n[R];)n=n.parentNode;return e===n},me=function(e,t,n){for(var i=e.parentNode;i&&!i[R];)i=i.parentNode;i&&i[R][n](Pe(t,{artificialBubble:!0}))},_e=function(){!w&&M&&Q(M,"display","none")},ge=function(){!w&&M&&Q(M,"display","")},$.addEventListener("click",function(e){if(ne)return e.preventDefault(),e.stopPropagation&&e.stopPropagation(),e.stopImmediatePropagation&&e.stopImmediatePropagation(),ne=!1},!0),u($,"dragover",e=function(e){var t;e=e.touches?e.touches[0]:e,k&&(t=function(e,t){for(var n=0;n<a.length;n++)if(!a[n].children.length){var i=Z(a[n]),o=a[n][R].options.emptyInsertThreshold,r=e>=i.left-o&&e<=i.right+o,i=t>=i.top-o&&t<=i.bottom+o;if(r&&i)return a[n]}}(e.clientX,e.clientY))&&t[R]._onDragOver({clientX:e.clientX,clientY:e.clientY,target:t,rootEl:t})}),u($,"mousemove",e),u($,"touchmove",e),Y.prototype={constructor:Y,_computeIsAligned:function(e){var t;if(M&&!w?(_e(),t=$.elementFromPoint(e.clientX,e.clientY),ge()):t=e.target,t=H(t,this.options.draggable,this.el,!1),!S&&k&&k.parentNode===this.el){for(var n,i,o,r,s,a=this.el.children,l=0;l<a.length;l++)H(a[l],this.options.draggable,this.el,!1)&&a[l]!==t&&(a[l].sortableMouseAligned=(n=e.clientX,i=e.clientY,o=a[l],r=this._getDirection(e,null),this.options,s=void 0,o=Z(o),s="vertical"===r?o.left:o.top,o="vertical"===r?o.right:o.bottom,s<(r="vertical"===r?n:i)&&r<o));H(t,this.options.draggable,this.el,!0)||(L=null),S=!0,z(function(){S=!1},30)}},_getDirection:function(e,t){return"function"==typeof this.options.direction?this.options.direction.call(this,e,t,k):this.options.direction},_onTapStart:function(e){if(e.cancelable){for(var t,n=this,i=this.el,o=this.options,r=o.preventOnFilter,s=e.type,a=e.touches&&e.touches[0],l=(a||e).target,u=e.target.shadowRoot&&(e.path&&e.path[0]||e.composedPath&&e.composedPath()[0])||l,c=o.filter,d=i,h=(C.length=0,d.getElementsByTagName("input")),p=h.length;p--;){var f=h[p];f.checked&&C.push(f)}if((!U||e.artificialBubble||fe(i,l))&&!k&&!(/mousedown|pointerdown/.test(s)&&0!==e.button||o.disabled||u.isContentEditable))if(l=H(l,o.draggable,i,!1)){if(m!==l){if(t=K(l,o.draggable),"function"==typeof c){if(c.call(this,e,l,this))return X(n,u,"filter",l,i,i,t),void(r&&e.cancelable&&e.preventDefault())}else if(c=c&&c.split(",").some(function(e){if(e=H(u,e.trim(),i,!1))return X(n,e,"filter",l,i,i,t),!0}))return void(r&&e.cancelable&&e.preventDefault());o.handle&&!H(u,o.handle,i,!1)||this._prepareDragStart(e,a,l,t)}}else U&&me(i,e,"_onTapStart")}},_handleAutoScroll:function(t,n){var i,o,e,r,s;k&&this.options.scroll&&(i=t.clientX,o=t.clientY,e=$.elementFromPoint(i,o),r=this,n||g||U||v?(ce(t,r.options,e,n),s=G(e,!0),!F||l&&i===c&&o===d||(l&&clearInterval(l),l=setInterval(function(){var e;!k||(e=G($.elementFromPoint(i,o),!0))!==s&&(s=e,de(),ce(t,r.options,s,n))},10),c=i,d=o)):r.options.bubbleScroll&&G(e,!0)!==window?ce(t,r.options,G(e,!1),!1):de())},_prepareDragStart:function(e,t,n,i){var o=this,r=o.el,s=o.options,a=r.ownerDocument;n&&!k&&n.parentNode===r&&(P=r,x=(k=n).parentNode,A=k.nextSibling,m=n,te=s.group,D=i,f={target:k,clientX:(t||e).clientX,clientY:(t||e).clientY},this._lastX=(t||e).clientX,this._lastY=(t||e).clientY,k.style["will-change"]="all",k.style.transition="",k.style.transform="",r=function(){o._disableDelayedDrag(),k.draggable=o.nativeDraggable,o._triggerDragStart(e,t),X(o,P,"choose",k,P,P,D),q(k,s.chosenClass,!0)},s.ignore.split(",").forEach(function(e){ye(k,e.trim(),Se)}),s.supportPointer?u(a,"pointerup",o._onDrop):(u(a,"mouseup",o._onDrop),u(a,"touchend",o._onDrop),u(a,"touchcancel",o._onDrop)),s.delay?(u(a,"mouseup",o._disableDelayedDrag),u(a,"touchend",o._disableDelayedDrag),u(a,"touchcancel",o._disableDelayedDrag),u(a,"mousemove",o._delayedDragTouchMoveHandler),u(a,"touchmove",o._delayedDragTouchMoveHandler),s.supportPointer&&u(a,"pointermove",o._delayedDragTouchMoveHandler),o._dragStartTimer=z(r,s.delay)):r())},_delayedDragTouchMoveHandler:function(e){e=e.touches?e.touches[0]:e;T(W(e.clientX-this._lastX),W(e.clientY-this._lastY))>=this.options.touchStartThreshold&&this._disableDelayedDrag()},_disableDelayedDrag:function(){var e=this.el.ownerDocument;clearTimeout(this._dragStartTimer),o(e,"mouseup",this._disableDelayedDrag),o(e,"touchend",this._disableDelayedDrag),o(e,"touchcancel",this._disableDelayedDrag),o(e,"mousemove",this._delayedDragTouchMoveHandler),o(e,"touchmove",this._delayedDragTouchMoveHandler),o(e,"pointermove",this._delayedDragTouchMoveHandler)},_triggerDragStart:function(e,t){t=t||("touch"==e.pointerType?e:null),!this.nativeDraggable||t?this.options.supportPointer?u($,"pointermove",this._onTouchMove):u($,t?"touchmove":"mousemove",this._onTouchMove):(u(k,"dragend",this),u(P,"dragstart",this._onDragStart));try{$.selection?Ee(function(){$.selection.empty()}):window.getSelection().removeAllRanges()}catch(e){}},_dragStarted:function(e){var t;s=!1,P&&k?(this.nativeDraggable&&(u($,"dragover",this._handleAutoScroll),u($,"dragover",pe)),t=this.options,e||q(k,t.dragClass,!1),q(k,t.ghostClass,!0),Q(k,"transform",""),Y.active=this,e&&this._appendGhost(),X(this,P,"start",k,P,P,D)):this._nulling()},_emulateDragOver:function(e){if(O&&(this._lastX!==O.clientX||this._lastY!==O.clientY||e)){this._lastX=O.clientX,this._lastY=O.clientY,_e();for(var t=$.elementFromPoint(O.clientX,O.clientY),n=t;t&&t.shadowRoot;)n=t=t.shadowRoot.elementFromPoint(O.clientX,O.clientY);if(n)do{if(n[R])if(n[R]._onDragOver({clientX:O.clientX,clientY:O.clientY,target:t,rootEl:n})&&!this.options.dragoverBubble)break}while(n=(t=n).parentNode);k.parentNode[R]._computeIsAligned(O),ge()}},_onTouchMove:function(e){if(f){var t=this.options,n=t.fallbackTolerance,t=t.fallbackOffset,i=e.touches?e.touches[0]:e,o=M&&be(M),r=M&&o&&o.a,o=M&&o&&o.d,r=(i.clientX-f.clientX+t.x)/(r||1),t=(i.clientY-f.clientY+t.y)/(o||1),o=e.touches?"translate3d("+r+"px,"+t+"px,0)":"translate("+r+"px,"+t+"px)";if(!Y.active&&!s){if(n&&T(W(i.clientX-this._lastX),W(i.clientY-this._lastY))<n)return;this._onDragStart(e,!0)}this._handleAutoScroll(i,!0),ie=!0,O=i,Q(M,"webkitTransform",o),Q(M,"mozTransform",o),Q(M,"msTransform",o),Q(M,"transform",o),e.cancelable&&e.preventDefault()}},_appendGhost:function(){var e,t;M||(e=Z(k,this.options.fallbackOnBody?$.body:P,!0),Q(k),t=this.options,q(M=k.cloneNode(!0),t.ghostClass,!1),q(M,t.fallbackClass,!0),q(M,t.dragClass,!0),Q(M,"box-sizing","border-box"),Q(M,"margin",0),Q(M,"top",e.top),Q(M,"left",e.left),Q(M,"width",e.width),Q(M,"height",e.height),Q(M,"opacity","0.8"),Q(M,"position","fixed"),Q(M,"zIndex","100000"),Q(M,"pointerEvents","none"),t.fallbackOnBody&&$.body.appendChild(M)||P.appendChild(M))},_onDragStart:function(e,t){var n=this,e=e.dataTransfer,i=n.options;(h=Ae(k)).draggable=!1,h.style["will-change"]="",this._hideClone(),q(h,n.options.chosenClass,!1),n._cloneId=Ee(function(){n.options.removeCloneOnHide||P.insertBefore(h,k),X(n,P,"clone",k)}),t||q(k,i.dragClass,!0),t?(ne=!0,n._loopId=setInterval(n._emulateDragOver,50)):(o($,"mouseup",n._onDrop),o($,"touchend",n._onDrop),o($,"touchcancel",n._onDrop),e&&(e.effectAllowed="move",i.setData&&i.setData.call(n,e,k)),u($,"drop",n),Q(k,"transform","translateZ(0)")),s=!0,n._dragStartId=Ee(n._dragStarted.bind(n,t)),u($,"selectstart",n)},_onDragOver:function(e){var t,n,i,o,r,s=this.el,a=e.target,l=this.options,u=l.group,c=Y.active,d=te===u,h=l.sort,p=this;if(!le&&(!U||e.rootEl||e.artificialBubble||fe(s,a))){if(void 0!==e.preventDefault&&e.cancelable&&e.preventDefault(),ie=!0,a=H(a,l.draggable,s,!0),H(e.target,null,k,!0)||a.animated)return T();if(a!==k&&(ne=!1),c&&!l.disabled&&(d?h||(o=!P.contains(k)):I===this||(this.lastPutMode=te.checkPull(this,c,k,e))&&u.checkPut(this,c,k,e))){h=this._getDirection(e,a),u=Z(k);if(o)return this._hideClone(),x=P,A?P.insertBefore(k,A):P.appendChild(k),T();if(0===s.children.length||s.children[0]===M||(o=e,m=h,r=Z(ke(r=s)),g="vertical"===m?o.clientY:o.clientX,o="vertical"===m?o.clientX:o.clientY,v="vertical"===m?r.bottom:r.right,_="vertical"===m?r.left:r.top,r="vertical"===m?r.right:r.bottom,("vertical"===m?r+10<o||o<=r&&v<g&&_<=o:v<g&&_<o||g<=v&&r+10<o)&&!k.animated)){if((a=0!==s.children.length&&s.children[0]!==M&&s===e.target?ke(s):a)&&(b=Z(a)),d?c._hideClone():c._showClone(this),!1!==we(P,s,k,u,a,b,e,!!a))return s.appendChild(k),x=s,N=null,C(),this._animate(u,k),a&&this._animate(b,a),T()}else if(a&&a!==k&&a.parentNode===s){var f,m=0,_=a.sortableMouseAligned,g=k.parentNode!==s,v=function(e,t){var n=G(n,!0),i=Z(e)[t];for(;n;){var o=Z(n)[t];if(!("top"===t||"left"===t?o<=i:i<=o))return!0;if(n===V)break;n=G(n,!1)}return!1}(a,"vertical"===h?"top":"left");if(L!==a&&(se=null,f=Z(a)["vertical"===h?"top":"left"],B=!1),r=a,t=h,w=(w=k)===k&&N||Z(w),r=r===k&&N||Z(r),y="vertical"===t?w.left:w.top,n="vertical"===t?w.right:w.bottom,w="vertical"===t?w.width:w.height,S="vertical"===t?r.left:r.top,i="vertical"===t?r.right:r.bottom,t="vertical"===t?r.width:r.height,se=(y===S||n===i||y+w/2===S+t/2)&&_||g||v||l.invertSwap||"insert"===se||"swap"===se?("swap"!==se&&(re=l.invertSwap||g||F||v),m=function(e,t,n,i,o,r,s){var t=Z(t),e="vertical"===n?e.clientY:e.clientX,a="vertical"===n?t.height:t.width,l="vertical"===n?t.top:t.left,t="vertical"===n?t.bottom:t.right,u=Z(k),c=!1;if(!r)if(s&&ae<a*i)if(B=!B&&(1===oe?l+a*o/2<e:e<t-a*o/2)?!0:B)c=!0;else{"vertical"===n?u.top:u.left,"vertical"===n?u.bottom:u.right;if(1===oe?e<l+ae:t-ae<e)return-1*oe}else if(l+a*(1-i)/2<e&&e<t-a*(1-i)/2)return l+a/2<e?-1:1;if((c=c||r)&&(e<l+a*o/2||t-a*o/2<e))return l+a/2<e?1:-1;return 0}(e,a,h,l.swapThreshold,null==l.invertedSwapThreshold?l.swapThreshold:l.invertedSwapThreshold,re,L===a),"swap"):(r=a,i=K(k,(n=l).draggable),r=K(r,n.draggable),m=i<r?1:-1,"insert"),0===m)return T();N=null,oe=m;var b=Z(L=a),y=a.nextElementSibling,w=!1,S=we(P,s,k,u,a,b,e,w=1===m);if(!1!==S)return 1!==S&&-1!==S||(w=1===S),le=!0,z(Te,30),d?c._hideClone():c._showClone(this),w&&!y?s.appendChild(k):a.parentNode.insertBefore(k,w?y:a),x=k.parentNode,void 0===f||re||(ae=W(f-Z(a)["vertical"===h?"top":"left"])),C(),g||this._animate(b,a),this._animate(u,k),T()}if(s.contains(k))return T()}return U&&!e.rootEl&&me(s,e,"_onDragOver"),!1}function T(){return c&&(q(k,(I||c).options.ghostClass,!1),q(k,l.ghostClass,!0)),I!==p&&p!==Y.active?I=p:p===Y.active&&(I=null),(a===k&&!k.animated||a===s&&!a.animated)&&(L=null),l.dragoverBubble||e.rootEl||a===$||(p._handleAutoScroll(e),k.parentNode[R]._computeIsAligned(e)),!l.dragoverBubble&&e.stopPropagation&&e.stopPropagation(),!0}function C(){X(p,P,"change",a,s,P,D,K(k,l.draggable),e)}},_animate:function(e,t){var n,i,o,r=this.options.animation;r&&(n=Z(t),t===k&&(N=n),(e=1===e.nodeType?Z(e):e).left+e.width/2===n.left+n.width/2&&e.top+e.height/2===n.top+n.height/2||(i=(o=be(this.el))&&o.a,o=o&&o.d,Q(t,"transition","none"),Q(t,"transform","translate3d("+(e.left-n.left)/(i||1)+"px,"+(e.top-n.top)/(o||1)+"px,0)"),t.offsetWidth,Q(t,"transition","transform "+r+"ms"+(this.options.easing?" "+this.options.easing:"")),Q(t,"transform","translate3d(0,0,0)")),"number"==typeof t.animated&&clearTimeout(t.animated),t.animated=z(function(){Q(t,"transition",""),Q(t,"transform",""),t.animated=!1},r))},_offUpEvents:function(){var e=this.el.ownerDocument;o($,"touchmove",this._onTouchMove),o($,"pointermove",this._onTouchMove),o(e,"mouseup",this._onDrop),o(e,"touchend",this._onDrop),o(e,"pointerup",this._onDrop),o(e,"touchcancel",this._onDrop),o($,"selectstart",this)},_onDrop:function(e){var t=this.el,n=this.options;B=re=F=s=!1,clearInterval(this._loopId),clearInterval(l),de(),clearTimeout(ve),ve=void 0,clearTimeout(this._dragStartTimer),De(this._cloneId),De(this._dragStartId),o($,"mousemove",this._onTouchMove),this.nativeDraggable&&(o($,"drop",this),o(t,"dragstart",this._onDragStart),o($,"dragover",this._handleAutoScroll),o($,"dragover",pe)),this._offUpEvents(),e&&(ie&&(e.cancelable&&e.preventDefault(),n.dropBubble||e.stopPropagation()),M&&M.parentNode&&M.parentNode.removeChild(M),(P===x||I&&"clone"!==I.lastPutMode)&&h&&h.parentNode&&h.parentNode.removeChild(h),k&&(this.nativeDraggable&&o(k,"dragend",this),Se(k),k.style["will-change"]="",q(k,(I||this).options.ghostClass,!1),q(k,this.options.chosenClass,!1),X(this,P,"unchoose",k,x,P,D,null,e),P!==x?(0<=(i=K(k,n.draggable))&&(X(null,x,"add",k,x,P,D,i,e),X(this,P,"remove",k,x,P,D,i,e),X(null,x,"sort",k,x,P,D,i,e),X(this,P,"sort",k,x,P,D,i,e)),I&&I.save()):k.nextSibling!==A&&0<=(i=K(k,n.draggable))&&(X(this,P,"update",k,x,P,D,i,e),X(this,P,"sort",k,x,P,D,i,e)),Y.active&&(X(this,P,"end",k,x,P,D,i=null!=i&&-1!==i?i:D,e),this.save()))),this._nulling()},_nulling:function(){P=k=x=M=A=h=m=E=J=j.length=l=c=d=f=O=ie=i=D=L=oe=N=I=te=Y.active=null,C.forEach(function(e){e.checked=!0}),C.length=0},handleEvent:function(e){switch(e.type){case"drop":case"dragend":this._onDrop(e);break;case"dragenter":case"dragover":var t;k&&(this._onDragOver(e),(t=e).dataTransfer&&(t.dataTransfer.dropEffect="move"),t.cancelable&&t.preventDefault());break;case"selectstart":e.preventDefault()}},toArray:function(){for(var e,t=[],n=this.el.children,i=0,o=n.length,r=this.options;i<o;i++)H(e=n[i],r.draggable,this.el,!1)&&t.push(e.getAttribute(r.dataIdAttr)||function(e){var t=e.tagName+e.className+e.src+e.href+e.textContent,n=t.length,i=0;for(;n--;)i+=t.charCodeAt(n);return i.toString(36)}(e));return t},sort:function(e){var n={},i=this.el;this.toArray().forEach(function(e,t){t=i.children[t];H(t,this.options.draggable,i,!1)&&(n[e]=t)},this),e.forEach(function(e){n[e]&&(i.removeChild(n[e]),i.appendChild(n[e]))})},save:function(){var e=this.options.store;e&&e.set&&e.set(this)},closest:function(e,t){return H(e,t||this.options.draggable,this.el,!1)},option:function(e,t){var n=this.options;if(void 0===t)return n[e];n[e]=t,"group"===e&&he(n)},destroy:function(){var e=this.el;e[R]=null,o(e,"mousedown",this._onTapStart),o(e,"touchstart",this._onTapStart),o(e,"pointerdown",this._onTapStart),this.nativeDraggable&&(o(e,"dragover",this),o(e,"dragenter",this)),Array.prototype.forEach.call(e.querySelectorAll("[draggable]"),function(e){e.removeAttribute("draggable")}),this._onDrop(),a.splice(a.indexOf(this.el),1),this.el=e=null},_hideClone:function(){h.cloneHidden||(Q(h,"display","none"),h.cloneHidden=!0,h.parentNode&&this.options.removeCloneOnHide&&h.parentNode.removeChild(h))},_showClone:function(e){"clone"!==e.lastPutMode?this._hideClone():h.cloneHidden&&(P.contains(k)&&!this.options.group.revertClone?P.insertBefore(h,k):A?P.insertBefore(h,A):P.appendChild(h),this.options.group.revertClone&&this._animate(k,h),Q(h,"display",""),h.cloneHidden=!1)}},u($,"touchmove",function(e){(Y.active||s)&&e.cancelable&&e.preventDefault()}),Y.utils={on:u,off:o,css:Q,find:ye,is:function(e,t){return!!H(e,t,e,!1)},extend:Pe,throttle:Me,closest:H,toggleClass:q,clone:Ae,index:K,nextTick:Ee,cancelNextTick:De,detectDirection:ue,getChild:Ce},Y.create=function(e,t){return new Y(e,t)},Y.version="1.8.3",Y):function(){throw new Error("Sortable.js requires a window with a document")};function Y(e,t){if(!e||!e.nodeType||1!==e.nodeType)throw"Sortable: `el` must be HTMLElement, not "+{}.toString.call(e);this.el=e,this.options=t=Pe({},t),e[R]=this;var n,i,o={group:null,sort:!0,disabled:!1,store:null,handle:null,scroll:!0,scrollSensitivity:30,scrollSpeed:10,bubbleScroll:!0,draggable:/[uo]l/i.test(e.nodeName)?">li":">*",swapThreshold:1,invertSwap:!1,invertedSwapThreshold:null,removeCloneOnHide:!0,direction:function(){return ue(e,this.options)},ghostClass:"sortable-ghost",chosenClass:"sortable-chosen",dragClass:"sortable-drag",ignore:"a, img",filter:null,preventOnFilter:!0,animation:0,easing:null,setData:function(e,t){e.setData("Text",t.textContent)},dropBubble:!1,dragoverBubble:!1,dataIdAttr:"data-id",delay:0,touchStartThreshold:p(window.devicePixelRatio,10)||1,forceFallback:!1,fallbackClass:"sortable-fallback",fallbackOnBody:!1,fallbackTolerance:0,fallbackOffset:{x:0,y:0},supportPointer:!1!==Y.supportPointer&&("PointerEvent"in window||window.navigator&&"msPointerEnabled"in window.navigator),emptyInsertThreshold:5};for(n in o)n in t||(t[n]=o[n]);for(i in he(t),this)"_"===i.charAt(0)&&"function"==typeof this[i]&&(this[i]=this[i].bind(this));this.nativeDraggable=!t.forceFallback&&y,t.supportPointer?u(e,"pointerdown",this._onTapStart):(u(e,"mousedown",this._onTapStart),u(e,"touchstart",this._onTapStart)),this.nativeDraggable&&(u(e,"dragover",this),u(e,"dragenter",this)),a.push(this.el),t.store&&t.store.get&&this.sort(t.store.get(this)||[])}function H(e,t,n,i){if(e){n=n||$;do{if(null!=t&&(">"===t[0]&&e.parentNode===n&&xe(e,t.substring(1))||xe(e,t))||i&&e===n)return e}while(e!==n&&(e=(o=e).host&&o!==$&&o.host.nodeType?o.host:o.parentNode))}var o;return null}function u(e,t,n){e.addEventListener(t,n,_)}function o(e,t,n){e.removeEventListener(t,n,_)}function q(e,t,n){var i;e&&t&&(e.classList?e.classList[n?"add":"remove"](t):(i=(" "+e.className+" ").replace(r," ").replace(" "+t+" "," "),e.className=(i+(n?" "+t:"")).replace(r," ")))}function Q(e,t,n){var i=e&&e.style;if(i){if(void 0===n)return $.defaultView&&$.defaultView.getComputedStyle?n=$.defaultView.getComputedStyle(e,""):e.currentStyle&&(n=e.currentStyle),void 0===t?n:n[t];i[t=t in i||-1!==t.indexOf("webkit")?t:"-webkit-"+t]=n+("string"==typeof n?"":"px")}}function be(e){var t="";do{var n=Q(e,"transform")}while(n&&"none"!==n&&(t=n+" "+t),e=e.parentNode);return window.DOMMatrix?new DOMMatrix(t):window.WebKitCSSMatrix?new WebKitCSSMatrix(t):window.CSSMatrix?new CSSMatrix(t):void 0}function ye(e,t,n){if(e){var i=e.getElementsByTagName(t),o=0,r=i.length;if(n)for(;o<r;o++)n(i[o],o);return i}return[]}function X(e,t,n,i,o,r,s,a,l){var u,c=(e=e||t[R]).options,d="on"+n.charAt(0).toUpperCase()+n.substr(1);!window.CustomEvent||U||g?(u=$.createEvent("Event")).initEvent(n,!0,!0):u=new CustomEvent(n,{bubbles:!0,cancelable:!0}),u.to=o||t,u.from=r||t,u.item=i||t,u.clone=h,u.oldIndex=s,u.newIndex=a,u.originalEvent=l,t&&t.dispatchEvent(u),c[d]&&c[d].call(e,u)}function we(e,t,n,i,o,r,s,a){var l,u,c=e[R],d=c.options.onMove;return!window.CustomEvent||U||g?(l=$.createEvent("Event")).initEvent("move",!0,!0):l=new CustomEvent("move",{bubbles:!0,cancelable:!0}),l.to=t,l.from=e,l.dragged=n,l.draggedRect=i,l.related=o||t,l.relatedRect=r||Z(t),l.willInsertAfter=a,l.originalEvent=s,e.dispatchEvent(l),u=d?d.call(c,l,s):u}function Se(e){e.draggable=!1}function Te(){le=!1}function Ce(e,t,n){for(var i=0,o=0,r=e.children;o<r.length;){if("none"!==r[o].style.display&&r[o]!==M&&r[o]!==k&&H(r[o],n.draggable,e,!1)){if(i===t)return r[o];i++}o++}return null}function ke(e){for(var t=e.lastElementChild;(t===M||"none"===t.style.display)&&(t=t.previousElementSibling););return t||null}function K(e,t){var n=0;if(!e||!e.parentNode)return-1;for(;e=e&&e.previousElementSibling;)"TEMPLATE"!==e.nodeName.toUpperCase()&&e!==h&&n++;return n}function xe(e,t){if(e)try{if(e.matches)return e.matches(t);if(e.msMatchesSelector)return e.msMatchesSelector(t);if(e.webkitMatchesSelector)return e.webkitMatchesSelector(t)}catch(e){return}}function Me(n,i){return function(){var e,t;ve||(e=arguments,t=this,ve=z(function(){1===e.length?n.call(t,e[0]):n.apply(t,e),ve=void 0},i))}}function Pe(e,t){if(e&&t)for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n]);return e}function Ae(e){return n&&n.dom?n.dom(e).cloneNode(!0):t?t(e).clone(!0)[0]:e.cloneNode(!0)}function Ee(e){return z(e,0)}function De(e){return clearTimeout(e)}function Z(e,t,n){if(e.getBoundingClientRect||e===V){var i,o,r,s,a,l,u=e!==V?(o=(i=e.getBoundingClientRect()).top,r=i.left,s=i.bottom,a=i.right,l=i.height,i.width):(r=o=0,s=window.innerHeight,a=window.innerWidth,l=window.innerHeight,window.innerWidth);if(n&&e!==V){if(t=t||e.parentNode,!U)do{if(t&&t.getBoundingClientRect&&"none"!==Q(t,"transform")){var c=t.getBoundingClientRect();o-=c.top+p(Q(t,"border-top-width")),r-=c.left+p(Q(t,"border-left-width")),s=o+i.height,a=r+i.width;break}}while(t=t.parentNode);var n=be(e),e=n&&n.a,d=n&&n.d;n&&(s=(o/=d)+(l/=d),a=(r/=e)+(u/=e))}return{top:o,left:r,bottom:s,right:a,width:u,height:l}}}}),define("Modules/SortableList/SortableList",["underscore","jquery","Backbone","External/Sortable"],function(r,e,t,s){return t.EModel.extend({initialize:function(e){var t=1<arguments.length&&void 0!==arguments[1]?arguments[1]:{},i=-1,o=-1,n=(r.valueOr(t.itemIndexBoundary,-1),e.f("li"));new s(e[0],r.extend({onMove:function(e,t){var n=Date.now();if(t.clientX===i&&t.clientY===o)return!1;i=t.clientX,o=t.clientY,0},onStart:function(){t.hoverStyleHack&&n.rCl("free")},onEnd:function(e){t.hoverStyleHack&&n.aCl("free"),r.tryRun(t.onEndHandler,e)},animation:200,draggable:"li:not(.dontdrag)",touchStartThreshold:4,handle:".common-list-item-drag",hoverStyleHack:!0},t))}})}),window.InvestingApp={},define("app/Investing",["underscore","jquery","Backbone","Modules/ControlPanel/ControlPanelView","Modules/MainFrame/MainFrame","Router","Modules/Mutators/LateMutator","Modules/Ads/BillboardView","Modules/Mutators/DisplayableMutator","Modules/Mutators/MomentMutator","Modules/PageState/PageState","Socket","Modules/SortableList/SortableList","InstrumentChart"],function(e,t,i,n,o,r,s,a){return window.InvestingApp.Router={},window.InvestingApp.root="/",new(i.EModel.extend({_mainFrame:null,init:function(){var e=this;this._initializeConfig(),this.initIfWhenDOMReady("jf879hwe34",function(){return e._initializeComponents()}),this.initIfWhenDOMReady("dw8dkas9efy9",function(e){return a.initializeDFPs(e)})},_initializeConfig:function(){this.config("isProduction",window.isProduction)},_initializeComponents:function(){new s,this._mainFrame=new o,this._mainFrame.render(),this._controlPanelView=new n,this._controlPanelView.render(),this._initializeRouter()},_initializeRouter:function(){var t=this,n=!0;r.on("clientNavigationEv",function(){var e;n?(e=t._mainFrame).initializePage.apply(e,arguments):(e=t._mainFrame).navigateLocal.apply(e,arguments)}),i.history.start({pushState:!0,root:window.InvestingApp.root}),n=!1}}))});